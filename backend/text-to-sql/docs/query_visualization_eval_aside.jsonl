{"id": "aside_qv_001", "source": "aside.txt", "source_line": 31, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "1", "user_query": "연도별 전체 입원 환자 수", "sql": "SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS admit_year, COUNT(DISTINCT a.HADM_ID) AS n_admissions FROM SSO.ADMISSIONS a GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_002", "source": "aside.txt", "source_line": 44, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "2", "user_query": "연도별 ICU 입실 환자 수", "sql": "SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS admit_year, COUNT(DISTINCT i.HADM_ID) AS n_icu_admissions FROM SSO.ADMISSIONS a JOIN SSO.ICUSTAYS i ON a.HADM_ID = i.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_003", "source": "aside.txt", "source_line": 59, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "3", "user_query": "연도별 병원 사망률", "sql": "SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS admit_year, COUNT(*) AS n_admissions, SUM(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM SSO.ADMISSIONS a GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_004", "source": "aside.txt", "source_line": 75, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "4", "user_query": "연도별 ICU 사망률", "sql": "SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS admit_year, COUNT(DISTINCT i.HADM_ID) AS n_icu_admissions, SUM( CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 AND a.DEATHTIME IS NOT NULL AND i.OUTTIME <= a.DEATHTIME THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 AND a.DEATHTIME IS NOT NULL AND i.OUTTIME <= a.DEATHTIME THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT i.HADM_ID), 0) AS icu_mortality_rate_pct FROM SSO.ADMISSIONS a JOIN SSO.ICUSTAYS i ON a.HADM_ID = i.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_005", "source": "aside.txt", "source_line": 106, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "5", "user_query": "전체 입원 환자 LOS 분포 (히스토그램용)", "sql": "SELECT a.HADM_ID, (a.DISCHTIME - a.ADMITTIME) AS los_days FROM sso.ADMISSIONS a;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_006", "source": "aside.txt", "source_line": 117, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "6", "user_query": "수술계 진료과 입원 환자의 LOS 분포", "sql": "SELECT a.HADM_ID, (a.DISCHTIME - a.ADMITTIME) AS los_days FROM sso.ADMISSIONS a JOIN sso.SERVICES s ON a.HADM_ID = s.HADM_ID WHERE s.CURR_SERVICE IN ('SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG');", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_007", "source": "aside.txt", "source_line": 131, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "7", "user_query": "수술계 vs 비수술계 평균 LOS 비교", "sql": "WITH base AS ( SELECT a.hadm_id, CASE WHEN s.curr_service IN ('SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG') THEN 'SURGICAL' ELSE 'NON_SURGICAL' END AS service_group, ( EXTRACT(DAY FROM (a.dischtime - a.admittime)) + EXTRACT(HOUR FROM (a.dischtime - a.admittime)) / 24 + EXTRACT(MINUTE FROM (a.dischtime - a.admittime)) / 24 / 60 + EXTRACT(SECOND FROM (a.dischtime - a.admittime)) / 24 / 60 / 60 ) AS los_days FROM sso.admissions a LEFT JOIN sso.services s ON a.hadm_id = s.hadm_id ) SELECT service_group, COUNT(*) AS n_admissions, AVG(los_days) AS avg_los_days FROM base GROUP BY service_group;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_008", "source": "aside.txt", "source_line": 162, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "8", "user_query": "65세 이상 vs 65세 미만 병원 사망률", "sql": "WITH base AS ( SELECT a.HADM_ID, CASE WHEN p.ANCHOR_AGE >= 65 THEN '>=65' ELSE '<65' END AS age_group, a.HOSPITAL_EXPIRE_FLAG FROM sso.ADMISSIONS a JOIN sso.PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID ) SELECT age_group, COUNT(*) AS n_admissions, SUM(CASE WHEN HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM base GROUP BY age_group;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_009", "source": "aside.txt", "source_line": 189, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "9", "user_query": "남성 vs 여성 ICU 사망률", "sql": "WITH base AS ( SELECT DISTINCT i.STAY_ID, p.GENDER, a.HOSPITAL_EXPIRE_FLAG, a.DEATHTIME, i.OUTTIME FROM sso.ICUSTAYS i JOIN sso.ADMISSIONS a ON i.HADM_ID = a.HADM_ID JOIN sso.PATIENTS p ON i.SUBJECT_ID = p.SUBJECT_ID ) SELECT GENDER, COUNT(*) AS n_icu_stays, SUM( CASE WHEN HOSPITAL_EXPIRE_FLAG = 1 AND DEATHTIME IS NOT NULL AND OUTTIME <= DEATHTIME THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN HOSPITAL_EXPIRE_FLAG = 1 AND DEATHTIME IS NOT NULL AND OUTTIME <= DEATHTIME THEN 1 ELSE 0 END ) / NULLIF(COUNT(*), 0) AS icu_mortality_rate_pct FROM base GROUP BY GENDER;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_010", "source": "aside.txt", "source_line": 230, "level": "L1", "section": "A", "section_title": "인구학/LOS/사망률 (10개, 전부 L1)", "question_no": "10", "user_query": "ER→ICU vs 병동→ICU 병원 LOS 비교", "sql": "WITH first_icu AS ( SELECT i.subject_id, i.hadm_id, MIN(i.intime) AS first_icu_intime FROM sso.icustays i GROUP BY i.subject_id, i.hadm_id ), route AS ( SELECT a.hadm_id, CASE WHEN a.admission_location LIKE '%EMERGENCY%' OR a.admission_location LIKE '%ED%' THEN 'ER_DIRECT' ELSE 'WARD_TO_ICU' END AS icu_route, ( EXTRACT(DAY FROM (a.dischtime - a.admittime)) + EXTRACT(HOUR FROM (a.dischtime - a.admittime)) / 24 + EXTRACT(MINUTE FROM (a.dischtime - a.admittime)) / 24 / 60 + EXTRACT(SECOND FROM (a.dischtime - a.admittime)) / 24 / 60 / 60 ) AS los_days FROM sso.admissions a JOIN first_icu f ON a.hadm_id = f.hadm_id ) SELECT icu_route, COUNT(*) AS n_admissions, AVG(los_days) AS avg_los_days FROM route GROUP BY icu_route;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_011", "source": "aside.txt", "source_line": 322, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "1", "user_query": "패혈증 진단을 받은 입원 환자 수 (연도별)", "sql": "WITH cohort_sepsis AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 9 AND d.icd_code IN ('99591', '99592', '78552') ) OR ( d.icd_version = 10 AND (d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%') ) OR ( d.icd_version = 10 AND d.icd_code IN ('R6520', 'R6521') ) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_sepsis_admissions FROM sso.admissions a JOIN cohort_sepsis c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_012", "source": "aside.txt", "source_line": 352, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "2", "user_query": "패혈증 진단 환자의 ICU 사망률 (연도별)", "sql": "WITH cohort_sepsis AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND d.icd_code IN ('99591', '99592', '78552')) OR (d.icd_version = 10 AND (d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%')) OR (d.icd_version = 10 AND d.icd_code IN ('R6520', 'R6521')) ), sepsis_icu AS ( SELECT DISTINCT i.stay_id, i.hadm_id, i.outtime, a.hospital_expire_flag, a.deathtime, a.admittime FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cohort_sepsis c ON i.hadm_id = c.hadm_id ) SELECT EXTRACT(YEAR FROM s.admittime) AS admit_year, COUNT(DISTINCT s.stay_id) AS n_sepsis_icu_stays, SUM( CASE WHEN s.hospital_expire_flag = 1 AND s.deathtime IS NOT NULL AND s.outtime <= s.deathtime THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN s.hospital_expire_flag = 1 AND s.deathtime IS NOT NULL AND s.outtime <= s.deathtime THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT s.stay_id), 0) AS icu_mortality_rate_pct FROM sepsis_icu s GROUP BY EXTRACT(YEAR FROM s.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_013", "source": "aside.txt", "source_line": 413, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "3", "user_query": "심부전 진단 환자 수 (연도별)", "sql": "WITH cohort_hf AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_hf_admissions FROM sso.admissions a JOIN cohort_hf c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_014", "source": "aside.txt", "source_line": 440, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "4", "user_query": "심부전 진단 환자의 ICU 사망률 (연도별)", "sql": "WITH cohort_hf AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ), hf_icu AS ( SELECT DISTINCT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.hospital_expire_flag, a.deathtime FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cohort_hf c ON i.hadm_id = c.hadm_id ) SELECT EXTRACT(YEAR FROM h.admittime) AS admit_year, COUNT(DISTINCT h.stay_id) AS n_hf_icu_stays, SUM( CASE WHEN h.hospital_expire_flag = 1 AND h.deathtime IS NOT NULL AND h.outtime <= h.deathtime THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN h.hospital_expire_flag = 1 AND h.deathtime IS NOT NULL AND h.outtime <= h.deathtime THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT h.stay_id), 0) AS icu_mortality_rate_pct FROM hf_icu h GROUP BY EXTRACT(YEAR FROM h.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_015", "source": "aside.txt", "source_line": 495, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "5", "user_query": "COPD 진단을 받은 입원 환자 수 (연도별)", "sql": "WITH cohort_copd AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND (d.icd_code LIKE '491%' OR d.icd_code LIKE '492%' OR d.icd_code LIKE '496%')) OR (d.icd_version = 10 AND d.icd_code LIKE 'J44%') ), copd_icu AS ( SELECT DISTINCT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.hospital_expire_flag, a.deathtime FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cohort_copd c ON i.hadm_id = c.hadm_id ) SELECT EXTRACT(YEAR FROM c.admittime) AS admit_year, COUNT(DISTINCT c.stay_id) AS n_copd_icu_stays, SUM( CASE WHEN c.hospital_expire_flag = 1 AND c.deathtime IS NOT NULL AND c.outtime <= c.deathtime THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN c.hospital_expire_flag = 1 AND c.deathtime IS NOT NULL AND c.outtime <= c.deathtime THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT c.stay_id), 0) AS icu_mortality_rate_pct FROM copd_icu c GROUP BY EXTRACT(YEAR FROM c.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_016", "source": "aside.txt", "source_line": 562, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "6", "user_query": "COPD 진단 환자의 ICU 입실 비율 (연도별)", "sql": "WITH cohort_copd AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND (d.icd_code LIKE '491%' OR d.icd_code LIKE '492%' OR d.icd_code LIKE '496%')) OR (d.icd_version = 10 AND d.icd_code LIKE 'J44%') ), copd_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_copd c ON a.hadm_id = c.hadm_id ), copd_icu AS ( SELECT DISTINCT b.hadm_id FROM copd_base b JOIN sso.icustays i ON b.hadm_id = i.hadm_id ) SELECT b.admit_year, COUNT(DISTINCT b.hadm_id) AS n_copd_admissions, COUNT(DISTINCT c.hadm_id) AS n_copd_icu_admissions, 100 * COUNT(DISTINCT c.hadm_id) / NULLIF(COUNT(DISTINCT b.hadm_id), 0) AS icu_admission_rate_pct FROM copd_base b LEFT JOIN copd_icu c ON b.hadm_id = c.hadm_id GROUP BY b.admit_year ORDER BY b.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_017", "source": "aside.txt", "source_line": 607, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "7", "user_query": "COPD 진단 환자의 병원 사망률 (연도별)", "sql": "WITH cohort_copd AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND (d.icd_code LIKE '491%' OR d.icd_code LIKE '492%' OR d.icd_code LIKE '496%')) OR (d.icd_version = 10 AND d.icd_code LIKE 'J44%') ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_copd_admissions, SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT a.hadm_id), 0) AS hospital_mortality_rate_pct FROM sso.admissions a JOIN cohort_copd c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_018", "source": "aside.txt", "source_line": 639, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "8", "user_query": "AKI 진단 환자 수 (연도별)", "sql": "WITH cohort_aki AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND d.icd_code LIKE '584%') OR (d.icd_version = 10 AND d.icd_code LIKE 'N17%') ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_aki_admissions FROM sso.admissions a JOIN cohort_aki c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_019", "source": "aside.txt", "source_line": 674, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "9", "user_query": "AKI 진단 환자의 30일 재입원율 (연도별)", "sql": "WITH cohort_aki AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 9 AND d.icd_code LIKE '584%') OR (d.icd_version = 10 AND d.icd_code LIKE 'N17%') ), aki_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_aki c ON a.hadm_id = c.hadm_id ), readmit AS ( SELECT base.subject_id, base.hadm_id, base.admit_year, CASE WHEN EXISTS ( SELECT 1 FROM sso.admissions a2 WHERE a2.subject_id = base.subject_id AND a2.admittime > base.dischtime AND a2.admittime <= base.dischtime + INTERVAL '30' DAY ) THEN 1 ELSE 0 END AS readmit_30d FROM aki_adm base ) SELECT admit_year, COUNT(*) AS n_aki_admissions, SUM(readmit_30d) AS n_30d_readmit, 100 * SUM(readmit_30d) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM readmit GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_020", "source": "aside.txt", "source_line": 727, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "10", "user_query": "뇌졸중 진단 환자의 병원 사망률 (연도별)", "sql": "WITH cohort_stroke AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 9 AND ( d.icd_code LIKE '430%' OR d.icd_code LIKE '431%' OR d.icd_code LIKE '432%' OR d.icd_code LIKE '434%' OR d.icd_code LIKE '436%' )) OR ( d.icd_version = 10 AND ( d.icd_code LIKE 'I60%' OR d.icd_code LIKE 'I61%' OR d.icd_code LIKE 'I62%' OR d.icd_code LIKE 'I63%' OR d.icd_code LIKE 'I64%' )) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_stroke_admissions, SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT a.hadm_id), 0) AS hospital_mortality_rate_pct FROM sso.admissions a JOIN cohort_stroke c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_021", "source": "aside.txt", "source_line": 769, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "11", "user_query": "뇌졸중 진단 환자의 30일 재입원율 (연도별)", "sql": "WITH cohort_stroke AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 9 AND ( d.icd_code LIKE '430%' OR d.icd_code LIKE '431%' OR d.icd_code LIKE '432%' OR d.icd_code LIKE '434%' OR d.icd_code LIKE '436%' )) OR ( d.icd_version = 10 AND ( d.icd_code LIKE 'I60%' OR d.icd_code LIKE 'I61%' OR d.icd_code LIKE 'I62%' OR d.icd_code LIKE 'I63%' OR d.icd_code LIKE 'I64%' )) ), stroke_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_stroke c ON a.hadm_id = c.hadm_id ), readmit AS ( SELECT base.subject_id, base.hadm_id, base.admit_year, CASE WHEN EXISTS ( SELECT 1 FROM sso.admissions a2 WHERE a2.subject_id = base.subject_id AND a2.admittime > base.dischtime AND a2.admittime <= base.dischtime + INTERVAL '30' DAY ) THEN 1 ELSE 0 END AS readmit_30d FROM stroke_adm base ) SELECT admit_year, COUNT(*) AS n_stroke_admissions, SUM(readmit_30d) AS n_30d_readmit, 100 * SUM(readmit_30d) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM readmit GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_022", "source": "aside.txt", "source_line": 836, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "12", "user_query": "심근경색(STEMI/NSTEMI) 진단 환자 수 + 병원 사망률 (연도별)", "sql": "WITH cohort_mi AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 10 AND ( d.icd_code LIKE 'I210%' OR d.icd_code LIKE 'I211%' OR d.icd_code LIKE 'I212%' OR d.icd_code LIKE 'I213%' OR d.icd_code LIKE 'I214%' )) OR ( d.icd_version = 9 AND ( d.icd_code LIKE '4100%' OR d.icd_code LIKE '4101%' OR d.icd_code LIKE '4102%' OR d.icd_code LIKE '4103%' OR d.icd_code LIKE '4104%' OR d.icd_code LIKE '4105%' OR d.icd_code LIKE '4106%' OR d.icd_code LIKE '4108%' OR d.icd_code LIKE '4107%' OR d.icd_code LIKE '4109%' )) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_mi_admissions, SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT a.hadm_id), 0) AS hospital_mortality_rate_pct FROM sso.admissions a JOIN cohort_mi c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_023", "source": "aside.txt", "source_line": 883, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "13", "user_query": "심근경색 진단 환자의 ICU 입실 비율 (연도별)", "sql": "WITH cohort_mi AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 10 AND ( d.icd_code LIKE 'I210%' OR d.icd_code LIKE 'I211%' OR d.icd_code LIKE 'I212%' OR d.icd_code LIKE 'I213%' OR d.icd_code LIKE 'I214%' )) OR ( d.icd_version = 9 AND ( d.icd_code LIKE '4100%' OR d.icd_code LIKE '4101%' OR d.icd_code LIKE '4102%' OR d.icd_code LIKE '4103%' OR d.icd_code LIKE '4104%' OR d.icd_code LIKE '4105%' OR d.icd_code LIKE '4106%' OR d.icd_code LIKE '4108%' OR d.icd_code LIKE '4107%' OR d.icd_code LIKE '4109%' )) ), mi_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_mi c ON a.hadm_id = c.hadm_id ), mi_icu_adm AS ( SELECT DISTINCT b.hadm_id FROM mi_base b JOIN sso.icustays i ON b.hadm_id = i.hadm_id ) SELECT b.admit_year, COUNT(DISTINCT b.hadm_id) AS n_mi_admissions, COUNT(DISTINCT i.hadm_id) AS n_mi_icu_admissions, 100 * COUNT(DISTINCT i.hadm_id) / NULLIF(COUNT(DISTINCT b.hadm_id), 0) AS icu_admission_rate_pct FROM mi_base b LEFT JOIN mi_icu_adm i ON b.hadm_id = i.hadm_id GROUP BY b.admit_year ORDER BY b.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_024", "source": "aside.txt", "source_line": 939, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "14", "user_query": "암(악성 종양) 진단 환자의 병원 사망률 (연도별)", "sql": "WITH cohort_cancer AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'C%') OR (d.icd_version = 9 AND CASE WHEN REGEXP_LIKE(d.icd_code, '^[0-9]+$') AND TO_NUMBER(d.icd_code) BETWEEN 140 AND 209 THEN 1 ELSE 0 END = 1 ) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_cancer_admissions, SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100 * SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT a.hadm_id), 0) AS hospital_mortality_rate_pct FROM sso.admissions a JOIN cohort_cancer c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_025", "source": "aside.txt", "source_line": 973, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "15", "user_query": "암 + 패혈증 동반 환자 수 (연도별)", "sql": "WITH cohort_sepsis AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE ( d.icd_version = 9 AND d.icd_code IN ('99591', '99592', '78552') ) OR ( d.icd_version = 10 AND (d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%') ) OR ( d.icd_version = 10 AND d.icd_code IN ('R6520', 'R6521') ) ), cohort_cancer AS ( SELECT DISTINCT d.subject_id, d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'C%') OR (d.icd_version = 9 AND CASE WHEN REGEXP_LIKE(d.icd_code, '^[0-9]+$') AND TO_NUMBER(d.icd_code) BETWEEN 140 AND 209 THEN 1 ELSE 0 END = 1 ) ), cancer_sepsis AS ( SELECT DISTINCT c.subject_id, c.hadm_id FROM cohort_cancer c JOIN cohort_sepsis s ON c.hadm_id = s.hadm_id ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_cancer_sepsis_admissions FROM sso.admissions a JOIN cancer_sepsis cs ON a.hadm_id = cs.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_026", "source": "aside.txt", "source_line": 1026, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "16", "user_query": "ARDS 진단 환자의 ICU 사망률 (연도별)", "sql": "WITH cohort_ards AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'J80%') OR (d.icd_version = 9 AND d.icd_code LIKE '51882%') ), ards_icu AS ( SELECT DISTINCT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.hospital_expire_flag, a.deathtime FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cohort_ards c ON i.hadm_id = c.hadm_id ) SELECT EXTRACT(YEAR FROM ar.admittime) AS admit_year, COUNT(DISTINCT ar.stay_id) AS n_ards_icu_stays, SUM( CASE WHEN ar.hospital_expire_flag = 1 AND ar.deathtime IS NOT NULL AND ar.outtime <= ar.deathtime THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN ar.hospital_expire_flag = 1 AND ar.deathtime IS NOT NULL AND ar.outtime <= ar.deathtime THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT ar.stay_id), 0) AS icu_mortality_rate_pct FROM ards_icu ar GROUP BY EXTRACT(YEAR FROM ar.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_027", "source": "aside.txt", "source_line": 1086, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "17", "user_query": "CKD 진단 환자에서 AKI 합병 비율 (연도별)", "sql": "WITH cohort_ckd AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N18%') OR (d.icd_version = 9 AND d.icd_code LIKE '585%') ), cohort_aki AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ), ckd_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_ckd c ON a.hadm_id = c.hadm_id ), ckd_aki_flag AS ( SELECT b.hadm_id, b.admit_year, CASE WHEN k.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_aki FROM ckd_base b LEFT JOIN cohort_aki k ON b.hadm_id = k.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_ckd_admissions, SUM(has_aki) AS n_ckd_with_aki, 100 * SUM(has_aki) / NULLIF(COUNT(DISTINCT hadm_id), 0) AS aki_complication_rate_pct FROM ckd_aki_flag GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_028", "source": "aside.txt", "source_line": 1142, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "18", "user_query": "간경변 진단 환자의 ICU 입실 비율 (연도별)", "sql": "WITH cohort_cirrhosis AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND (d.icd_code LIKE 'K74%' OR d.icd_code LIKE 'K703%')) OR (d.icd_version = 9 AND (d.icd_code LIKE '5712%' OR d.icd_code LIKE '5715%' OR d.icd_code LIKE '5716%')) ), cirr_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_cirrhosis c ON a.hadm_id = c.hadm_id ), cirr_icu AS ( SELECT DISTINCT b.hadm_id FROM cirr_base b JOIN sso.icustays i ON b.hadm_id = i.hadm_id ) SELECT b.admit_year, COUNT(DISTINCT b.hadm_id) AS n_cirr_admissions, COUNT(DISTINCT c.hadm_id) AS n_cirr_icu_admissions, 100 * COUNT(DISTINCT c.hadm_id) / NULLIF(COUNT(DISTINCT b.hadm_id), 0) AS icu_admission_rate_pct FROM cirr_base b LEFT JOIN cirr_icu c ON b.hadm_id = c.hadm_id GROUP BY b.admit_year ORDER BY b.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_029", "source": "aside.txt", "source_line": 1185, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "19", "user_query": "당뇨병 진단 환자의 ICU 사망률 (연도별)", "sql": "WITH cohort_dm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND ( d.icd_code LIKE 'E10%' OR d.icd_code LIKE 'E11%' OR d.icd_code LIKE 'E13%' )) OR (d.icd_version = 9 AND d.icd_code LIKE '250%') ), dm_icu AS ( SELECT DISTINCT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.hospital_expire_flag, a.deathtime FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cohort_dm c ON i.hadm_id = c.hadm_id ) SELECT EXTRACT(YEAR FROM d.admittime) AS admit_year, COUNT(DISTINCT d.stay_id) AS n_dm_icu_stays, SUM( CASE WHEN d.hospital_expire_flag = 1 AND d.deathtime IS NOT NULL AND d.outtime <= d.deathtime THEN 1 ELSE 0 END ) AS n_icu_deaths, 100 * SUM( CASE WHEN d.hospital_expire_flag = 1 AND d.deathtime IS NOT NULL AND d.outtime <= d.deathtime THEN 1 ELSE 0 END ) / NULLIF(COUNT(DISTINCT d.stay_id), 0) AS icu_mortality_rate_pct FROM dm_icu d GROUP BY EXTRACT(YEAR FROM d.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_030", "source": "aside.txt", "source_line": 1242, "level": "L1", "section": "B", "section_title": "질환 코호트 규모·입실/사망 비율 (20개, L1)", "question_no": "20", "user_query": "고혈압 진단 vs 비고혈압 환자의 ICU 입실 비율 (연도별)", "sql": "WITH cohort_htn AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE (d.icd_version = 10 AND ( d.icd_code LIKE 'I10%' OR d.icd_code LIKE 'I11%' OR d.icd_code LIKE 'I12%' OR d.icd_code LIKE 'I13%' OR d.icd_code LIKE 'I15%' OR d.icd_code LIKE 'I16%' )) OR (d.icd_version = 9 AND ( d.icd_code LIKE '401%' OR d.icd_code LIKE '402%' OR d.icd_code LIKE '403%' OR d.icd_code LIKE '404%' OR d.icd_code LIKE '405%' )) ), all_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a ), htn_flag AS ( SELECT adm.hadm_id, adm.admit_year, CASE WHEN h.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_htn FROM all_adm adm LEFT JOIN cohort_htn h ON adm.hadm_id = h.hadm_id ), icu_flag AS ( SELECT DISTINCT i.hadm_id, 1 AS has_icu FROM sso.icustays i ) SELECT h.admit_year, CASE WHEN h.has_htn = 1 THEN 'HTN' ELSE 'NON_HTN' END AS htn_group, COUNT(DISTINCT h.hadm_id) AS n_admissions, SUM(NVL(i.has_icu, 0)) AS n_icu_admissions, 100 * SUM(NVL(i.has_icu, 0)) / NULLIF(COUNT(DISTINCT h.hadm_id), 0) AS icu_admission_rate_pct FROM htn_flag h LEFT JOIN icu_flag i ON h.hadm_id = i.hadm_id GROUP BY h.admit_year, CASE WHEN h.has_htn = 1 THEN 'HTN' ELSE 'NON_HTN' END ORDER BY h.admit_year, htn_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_031", "source": "aside.txt", "source_line": 1324, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "1", "user_query": "CABG 수술을 받은 환자 수 (연도별)", "sql": "WITH cohort_cabg AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE (p.icd_version = 9 AND ( p.icd_code LIKE '3610%' OR p.icd_code LIKE '3611%' OR p.icd_code LIKE '3612%' OR p.icd_code LIKE '3613%' OR p.icd_code LIKE '3614%' OR p.icd_code LIKE '3615%' OR p.icd_code LIKE '3616%' OR p.icd_code LIKE '3617%' OR p.icd_code LIKE '3619%' )) OR (p.icd_version = 10 AND p.icd_code LIKE '021%') ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT a.hadm_id) AS n_cabg_admissions FROM sso.admissions a JOIN cohort_cabg c ON a.hadm_id = c.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_032", "source": "aside.txt", "source_line": 1361, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "2", "user_query": "CABG 수술 환자의 ICU 재원 기간 분포", "sql": "WITH cohort_cabg AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE (p.icd_version = 9 AND ( p.icd_code LIKE '3610%' OR p.icd_code LIKE '3611%' OR p.icd_code LIKE '3612%' OR p.icd_code LIKE '3613%' OR p.icd_code LIKE '3614%' OR p.icd_code LIKE '3615%' OR p.icd_code LIKE '3616%' OR p.icd_code LIKE '3617%' OR p.icd_code LIKE '3619%' )) OR (p.icd_version = 10 AND p.icd_code LIKE '021%') ) SELECT i.stay_id, i.hadm_id, i.intime, i.outtime, i.los AS icu_los_days FROM sso.icustays i JOIN cohort_cabg c ON i.hadm_id = c.hadm_id WHERE i.los IS NOT NULL AND i.los >= 0;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_033", "source": "aside.txt", "source_line": 1391, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "3", "user_query": "CABG 수술 후 7일 이내 병원 사망률 (연도별)", "sql": "WITH cohort_cabg AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE (p.icd_version = 9 AND ( p.icd_code LIKE '3610%' OR p.icd_code LIKE '3611%' OR p.icd_code LIKE '3612%' OR p.icd_code LIKE '3613%' OR p.icd_code LIKE '3614%' OR p.icd_code LIKE '3615%' OR p.icd_code LIKE '3616%' OR p.icd_code LIKE '3617%' OR p.icd_code LIKE '3619%' )) OR (p.icd_version = 10 AND p.icd_code LIKE '021%') ), cabg_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, a.admittime, a.dischtime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_cabg c ON a.hadm_id = c.hadm_id ), cabg_death7d AS ( SELECT c.*, CASE WHEN c.hospital_expire_flag = 1 AND c.deathtime IS NOT NULL AND c.deathtime <= c.dischtime AND c.deathtime <= c.admittime + INTERVAL '7' DAY THEN 1 ELSE 0 END AS death_within_7d FROM cabg_adm c ) SELECT admit_year, COUNT(*) AS n_cabg_admissions, SUM(death_within_7d) AS n_deaths_7d, 100 * SUM(death_within_7d) / NULLIF(COUNT(*), 0) AS death_7d_rate_pct FROM cabg_death7d GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_034", "source": "aside.txt", "source_line": 1449, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "4", "user_query": "주요 복부 수술 후 30일 재입원율 (연도별)", "sql": "WITH cohort_major_abdominal AS ( SELECT DISTINCT p.subject_id, p.hadm_id FROM sso.procedures_icd p JOIN sso.d_icd_procedures dp ON p.icd_code = dp.icd_code AND p.icd_version = dp.icd_version WHERE UPPER(dp.long_title) LIKE '%COLECT%' OR UPPER(dp.long_title) LIKE '%PROCTECT%' OR UPPER(dp.long_title) LIKE '%RECTECT%' OR UPPER(dp.long_title) LIKE '%BOWEL%' OR UPPER(dp.long_title) LIKE '%INTESTIN%' OR UPPER(dp.long_title) LIKE '%ENTER%' OR UPPER(dp.long_title) LIKE '%ILEOSTOM%' OR UPPER(dp.long_title) LIKE '%COLOSTOM%' OR UPPER(dp.long_title) LIKE '%ANASTOMOS%' OR UPPER(dp.long_title) LIKE '%RESECTION%' OR UPPER(dp.long_title) LIKE '%EXCISION%' OR UPPER(dp.long_title) LIKE '%GASTRECT%' OR UPPER(dp.long_title) LIKE '%ESOPHAGECT%' OR UPPER(dp.long_title) LIKE '%WHIPPLE%' OR UPPER(dp.long_title) LIKE '%HEPATECT%' OR UPPER(dp.long_title) LIKE '%LIVER RESEC%' OR UPPER(dp.long_title) LIKE '%PANCREATECT%' OR UPPER(dp.long_title) LIKE '%CHOLECYSTECT%' OR UPPER(dp.long_title) LIKE '%BILIAR%' OR UPPER(dp.long_title) LIKE '%COMMON BILE DUCT%' OR UPPER(dp.long_title) LIKE '%SPLENECT%' OR UPPER(dp.long_title) LIKE '%APPENDECT%' OR UPPER(dp.long_title) LIKE '%HERNIA REPAIR%' OR UPPER(dp.long_title) LIKE '%VENTRAL HERNIA%' OR UPPER(dp.long_title) LIKE '%ABDOMINAL WALL%' ), ab_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_major_abdominal c ON a.hadm_id = c.hadm_id ), readmit AS ( SELECT base.subject_id, base.hadm_id, base.admit_year, CASE WHEN EXISTS ( SELECT 1 FROM sso.admissions a2 WHERE a2.subject_id = base.subject_id AND a2.admittime > base.dischtime AND a2.admittime <= base.dischtime + INTERVAL '30' DAY ) THEN 1 ELSE 0 END AS readmit_30d FROM ab_adm base ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_major_ab_admissions, SUM(readmit_30d) AS n_30d_readmit, ROUND( 100 * SUM(readmit_30d) / NULLIF(COUNT(DISTINCT hadm_id), 0) , 2) AS readmit_30d_rate_pct FROM readmit GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_035", "source": "aside.txt", "source_line": 1543, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "5", "user_query": "신경외과 수술 환자의 ICU 입실 비율 (연도별)", "sql": "WITH cohort_neurosurg_proc AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p JOIN sso.d_icd_procedures dp ON p.icd_code = dp.icd_code AND p.icd_version = dp.icd_version WHERE UPPER(dp.long_title) LIKE '%CRANIOTOM%' OR UPPER(dp.long_title) LIKE '%CRANIECTOM%' OR UPPER(dp.long_title) LIKE '%BURR HOLE%' OR UPPER(dp.long_title) LIKE '%TREPHIN%' OR UPPER(dp.long_title) LIKE '%VENTRICULOSTOM%' OR UPPER(dp.long_title) LIKE '%VENTRICULAR SHUNT%' OR UPPER(dp.long_title) LIKE '%VP SHUNT%' OR UPPER(dp.long_title) LIKE '%CSF SHUNT%' OR UPPER(dp.long_title) LIKE '%INTRACRANIAL%' OR UPPER(dp.long_title) LIKE '%DRAINAGE OF INTRACRANIAL%' OR UPPER(dp.long_title) LIKE '%EVACUATION OF HEMATOMA%' OR UPPER(dp.long_title) LIKE '%LAMINECTOM%' OR UPPER(dp.long_title) LIKE '%DISCECTOM%' OR UPPER(dp.long_title) LIKE '%SPINAL FUSION%' OR UPPER(dp.long_title) LIKE '%DECOMPRESS%' OR UPPER(dp.long_title) LIKE '%SPINAL CANAL%' ), ns_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN cohort_neurosurg_proc c ON a.hadm_id = c.hadm_id ), ns_icu AS ( SELECT DISTINCT b.hadm_id FROM ns_base b JOIN sso.icustays i ON b.hadm_id = i.hadm_id ) SELECT b.admit_year, COUNT(DISTINCT b.hadm_id) AS n_neurosurg_admissions, COUNT(DISTINCT i.hadm_id) AS n_neurosurg_icu_admissions, ROUND( 100 * COUNT(DISTINCT i.hadm_id) / NULLIF(COUNT(DISTINCT b.hadm_id), 0) , 2) AS icu_admission_rate_pct FROM ns_base b LEFT JOIN ns_icu i ON b.hadm_id = i.hadm_id GROUP BY b.admit_year ORDER BY b.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_036", "source": "aside.txt", "source_line": 1608, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "6", "user_query": "신경외과 수술 후 기계환기 기간(ventilator days) 분포", "sql": "WITH cohort_neurosurg_proc AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p JOIN sso.d_icd_procedures dp ON p.icd_code = dp.icd_code AND p.icd_version = dp.icd_version WHERE UPPER(dp.long_title) LIKE '%CRANIOTOM%' OR UPPER(dp.long_title) LIKE '%CRANIECTOM%' OR UPPER(dp.long_title) LIKE '%BURR HOLE%' OR UPPER(dp.long_title) LIKE '%TREPHIN%' OR UPPER(dp.long_title) LIKE '%VENTRICULOSTOM%' OR UPPER(dp.long_title) LIKE '%SHUNT%' OR UPPER(dp.long_title) LIKE '%LAMINECTOM%' OR UPPER(dp.long_title) LIKE '%DISCECTOM%' OR UPPER(dp.long_title) LIKE '%SPINAL FUSION%' OR UPPER(dp.long_title) LIKE '%DECOMPRESS%' ), neurosurg_stays AS ( SELECT DISTINCT i.stay_id, i.hadm_id FROM sso.icustays i JOIN cohort_neurosurg_proc c ON i.hadm_id = c.hadm_id ), vent_chart AS ( SELECT ns.stay_id, ns.hadm_id, ce.charttime FROM neurosurg_stays ns JOIN sso.chartevents ce ON ce.stay_id = ns.stay_id JOIN sso.d_items di ON di.itemid = ce.itemid WHERE ce.charttime IS NOT NULL AND ( UPPER(di.label) LIKE '%MECHANICALLY VENTILATED%' OR UPPER(di.label) LIKE '%VENTILATOR MODE%' OR UPPER(di.label) LIKE '%VENT MODE%' ) ), vent_seq AS ( SELECT stay_id, hadm_id, charttime, LAG(charttime) OVER (PARTITION BY stay_id ORDER BY charttime) AS prev_time, CASE WHEN LAG(charttime) OVER (PARTITION BY stay_id ORDER BY charttime) IS NULL THEN 1 WHEN (charttime - LAG(charttime) OVER (PARTITION BY stay_id ORDER BY charttime)) >= INTERVAL '14' HOUR THEN 1 ELSE 0 END AS is_new_episode FROM vent_chart ), vent_ep AS ( SELECT stay_id, hadm_id, charttime, SUM(is_new_episode) OVER (PARTITION BY stay_id ORDER BY charttime) AS ep_id FROM vent_seq ), vent_intervals AS ( SELECT stay_id, hadm_id, ep_id, MIN(charttime) AS starttime, MAX(charttime) AS endtime FROM vent_ep GROUP BY stay_id, hadm_id, ep_id HAVING MIN(charttime) < MAX(charttime) ), vent_days AS ( SELECT stay_id, hadm_id, SUM( EXTRACT(DAY FROM (endtime - starttime)) + EXTRACT(HOUR FROM (endtime - starttime)) / 24 + EXTRACT(MINUTE FROM (endtime - starttime)) / 24 / 60 + EXTRACT(SECOND FROM (endtime - starttime)) / 24 / 60 / 60 ) AS vent_days FROM vent_intervals GROUP BY stay_id, hadm_id ) SELECT stay_id, hadm_id, vent_days FROM vent_days ORDER BY vent_days DESC;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_037", "source": "aside.txt", "source_line": 1718, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "7", "user_query": "수술계 진료과 환자에서 재수술률 (동일 입원 중 2회 이상 수술, 연도별)", "sql": "WITH surg_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN sso.services s ON a.hadm_id = s.hadm_id WHERE s.curr_service IN ('SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG') ), surg_proc AS ( SELECT p.hadm_id, COUNT(*) AS n_surg_procedures FROM sso.procedures_icd p JOIN sso.d_icd_procedures dp ON p.icd_code = dp.icd_code AND p.icd_version = dp.icd_version WHERE UPPER(dp.long_title) LIKE '%RESECTION%' OR UPPER(dp.long_title) LIKE '%EXCISION%' OR UPPER(dp.long_title) LIKE '%REMOVAL%' OR UPPER(dp.long_title) LIKE '%REPAIR%' OR UPPER(dp.long_title) LIKE '%FUSION%' OR UPPER(dp.long_title) LIKE '%GRAFT%' OR UPPER(dp.long_title) LIKE '%BYPASS%' OR UPPER(dp.long_title) LIKE '%DRAINAGE%' OR UPPER(dp.long_title) LIKE '%CRANIOTOM%' OR UPPER(dp.long_title) LIKE '%LAPAROTOM%' OR UPPER(dp.long_title) LIKE '%ARTHROSCOP%' OR UPPER(dp.long_title) LIKE '%AMPUTATION%' GROUP BY p.hadm_id ), surg_with_proc AS ( SELECT sa.hadm_id, sa.admit_year, NVL(sp.n_surg_procedures, 0) AS n_surg_procedures FROM surg_adm sa LEFT JOIN surg_proc sp ON sa.hadm_id = sp.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_surg_admissions, SUM(CASE WHEN n_surg_procedures >= 2 THEN 1 ELSE 0 END) AS n_readop, ROUND( 100 * SUM(CASE WHEN n_surg_procedures >= 2 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT hadm_id), 0) , 2) AS readoperation_rate_pct FROM surg_with_proc GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_038", "source": "aside.txt", "source_line": 1782, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "8", "user_query": "procedureevents 기준 중심정맥관(CVC) 삽입 건수 (연도별)", "sql": "WITH cvc_insertion AS ( SELECT p.hadm_id, p.stay_id, p.starttime, p.itemid FROM sso.procedureevents p WHERE p.starttime IS NOT NULL AND p.itemid IN (224267, 225199) ), cvc_insertion_dedup AS ( SELECT DISTINCT hadm_id, stay_id, itemid, starttime FROM cvc_insertion ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(*) AS n_cvc_insertion_events FROM cvc_insertion_dedup e JOIN sso.admissions a ON e.hadm_id = a.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_039", "source": "aside.txt", "source_line": 1816, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "9", "user_query": "혈액투석 catheter 삽입 건수 (연도별)", "sql": "WITH hd_cath_events AS ( SELECT p.subject_id, p.hadm_id, p.stay_id, p.starttime, p.itemid, di.label FROM sso.procedureevents p JOIN sso.d_items di ON p.itemid = di.itemid WHERE p.starttime IS NOT NULL AND ( (UPPER(di.label) LIKE '%DIALYSIS%' AND UPPER(di.label) LIKE '%CATH%') OR (UPPER(di.label) LIKE '%HD%' AND UPPER(di.label) LIKE '%CATH%') OR UPPER(di.label) LIKE '%HEMODIALYSIS%' ) AND ( UPPER(di.label) LIKE '%INSERT%' OR UPPER(di.label) LIKE '%PLAC%' OR UPPER(di.label) LIKE '%INTRODUC%' OR UPPER(di.label) LIKE '%NEW%' OR UPPER(di.label) LIKE '%START%' OR UPPER(di.label) LIKE '%CATHETER%' ) AND UPPER(di.label) NOT LIKE '%PERITONEAL%' AND UPPER(di.label) NOT LIKE '%AV FISTULA%' AND UPPER(di.label) NOT LIKE '%GRAFT%' ), hd_cath_dedup AS ( SELECT DISTINCT subject_id, hadm_id, stay_id, itemid, starttime FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(*) AS n_hd_cath_insert_events FROM hd_cath_dedup e JOIN sso.admissions a ON e.hadm_id = a.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_040", "source": "aside.txt", "source_line": 1870, "level": "L1", "section": "C", "section_title": "수술/시술 후 예후·자원 이용 (10개, L1)", "question_no": "10", "user_query": "수술계 진료과 환자의 수혈 이벤트(inputevents 기준) 발생 비율 (연도별)", "sql": "WITH surg_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN sso.services s ON a.hadm_id = s.hadm_id WHERE s.curr_service IN ('SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG') ), transfusion_ie AS ( SELECT DISTINCT ie.hadm_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.hadm_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%PRBC%' OR UPPER(di.label) LIKE '%PACKED RED%' OR (UPPER(di.label) LIKE '%RBC%' AND UPPER(di.label) LIKE '%TRANSF%') OR UPPER(di.label) LIKE '%PLATELET%' OR UPPER(di.label) LIKE '%FFP%' OR UPPER(di.label) LIKE '%FRESH FROZEN PLASMA%' OR (UPPER(di.label) LIKE '%PLASMA%' AND UPPER(di.label) LIKE '%TRANSF%') OR UPPER(di.label) LIKE '%CRYO%' OR UPPER(di.label) LIKE '%WHOLE BLOOD%' ) AND UPPER(di.label) NOT LIKE '%ALBUMIN%' AND UPPER(di.label) NOT LIKE '%TPN%' ), surg_trans_flag AS ( SELECT sa.subject_id, sa.hadm_id, sa.admit_year, CASE WHEN t.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_transfusion FROM surg_adm sa LEFT JOIN transfusion_ie t ON sa.hadm_id = t.hadm_id ) SELECT admit_year, COUNT(*) AS n_surg_admissions, SUM(has_transfusion) AS n_with_transfusion, 100.0 * SUM(has_transfusion) / NULLIF(COUNT(*), 0) AS transfusion_rate_pct FROM surg_trans_flag GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_041", "source": "aside.txt", "source_line": 1968, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "1", "user_query": "ICU에서 vasopressin 사용 환자 수 (연도별)", "sql": "WITH vaso_vasopressin AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%VASOPRESSIN%' OR UPPER(di.label) LIKE '%PITRESSIN%' ) ), vaso_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, v.hadm_id FROM vaso_vasopressin v JOIN sso.admissions a ON v.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_icu_vasopressin_patients FROM vaso_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_042", "source": "aside.txt", "source_line": 2007, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "2", "user_query": "ICU에서 epinephrine 사용 환자 수 (연도별)", "sql": "WITH vaso_epi AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid IN (221289, 229617) ), epi_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, v.hadm_id FROM vaso_epi v JOIN sso.admissions a ON v.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_icu_epinephrine_patients FROM epi_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_043", "source": "aside.txt", "source_line": 2039, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "3", "user_query": "ICU에서 norepinephrine 사용 환자 수 (연도별)", "sql": "WITH vaso_norepi AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid IN (221906) ), norepi_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, v.hadm_id FROM vaso_norepi v JOIN sso.admissions a ON v.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_icu_norepi_patients FROM norepi_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_044", "source": "aside.txt", "source_line": 2072, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "4", "user_query": "vancomycin 사용 환자 수 (연도별)", "sql": "WITH abx_vanco AS ( SELECT DISTINCT p.subject_id, p.hadm_id FROM sso.prescriptions p WHERE p.hadm_id IS NOT NULL AND p.drug IS NOT NULL AND UPPER(p.drug) LIKE '%VANCOMYCIN%' ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT v.hadm_id) AS n_vanco_patients FROM sso.admissions_old a JOIN abx_vanco v ON a.hadm_id = v.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_045", "source": "aside.txt", "source_line": 2099, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "5", "user_query": "piperacillin/tazobactam 사용 환자 수 (연도별)", "sql": "WITH abx_piptazo AS ( SELECT DISTINCT p.subject_id, p.hadm_id FROM sso.prescriptions p WHERE p.hadm_id IS NOT NULL AND p.drug IS NOT NULL AND ( UPPER(p.drug) LIKE '%PIPERACILLIN%TAZOBACTAM%' OR UPPER(p.drug) LIKE '%PIPERACILLIN/TAZOBACTAM%' OR (UPPER(p.drug) LIKE '%PIPERACILLIN%' AND UPPER(p.drug) LIKE '%TAZOBACTAM%') OR UPPER(p.drug) LIKE '%ZOSYN%' OR UPPER(p.drug) LIKE '%TAZOCIN%' ) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT x.hadm_id) AS n_piptazo_patients FROM sso.admissions a JOIN abx_piptazo x ON a.hadm_id = x.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_046", "source": "aside.txt", "source_line": 2133, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "6", "user_query": "broad‑spectrum 항생제 사용 환자의 ICU 사망률 (연도별)", "sql": "WITH abx_broad AS ( SELECT DISTINCT p.subject_id, p.hadm_id FROM sso.prescriptions p WHERE p.hadm_id IS NOT NULL AND p.drug IS NOT NULL AND ( UPPER(p.drug) LIKE '%PIPERACILLIN%TAZOBACTAM%' OR UPPER(p.drug) LIKE '%PIPERACILLIN/TAZOBACTAM%' OR (UPPER(p.drug) LIKE '%PIPERACILLIN%' AND UPPER(p.drug) LIKE '%TAZOBACTAM%') OR UPPER(p.drug) LIKE '%ZOSYN%' OR UPPER(p.drug) LIKE '%TAZOCIN%' OR UPPER(p.drug) LIKE '%MEROPENEM%' OR UPPER(p.drug) LIKE '%IMIPENEM%' OR UPPER(p.drug) LIKE '%ERTAPENEM%' OR UPPER(p.drug) LIKE '%DORIPENEM%' ) ), broad_icu AS ( SELECT i.stay_id, i.hadm_id, i.intime, i.outtime FROM sso.icustays i JOIN abx_broad b ON i.hadm_id = b.hadm_id ), broad_icu_mort AS ( SELECT bi.stay_id, bi.hadm_id, bi.intime, bi.outtime, a.admittime, a.hospital_expire_flag, a.deathtime, CASE WHEN a.hospital_expire_flag = 1 AND a.deathtime IS NOT NULL AND bi.outtime IS NOT NULL AND a.deathtime <= bi.outtime THEN 1 ELSE 0 END AS died_in_icu FROM broad_icu bi JOIN sso.admissions a ON bi.hadm_id = a.hadm_id ) SELECT EXTRACT(YEAR FROM admittime) AS admit_year, COUNT(DISTINCT stay_id) AS n_broad_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM broad_icu_mort GROUP BY EXTRACT(YEAR FROM admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_047", "source": "aside.txt", "source_line": 2221, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "7", "user_query": "ICU에서 propofol 지속 주입 사용 환자 수 (연도별)", "sql": "qitWITH sed_propofol AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND UPPER(di.label) LIKE '%PROPOFOL%' ), prop_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, s.hadm_id FROM sed_propofol s JOIN sso.admissions a ON s.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_propofol_icu_patients FROM prop_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_048", "source": "aside.txt", "source_line": 2260, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "8", "user_query": "ICU에서 midazolam 지속 주입 사용 환자 수 (연도별)", "sql": "WITH sed_midazolam AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND UPPER(di.label) LIKE '%MIDAZOLAM%' AND ie.rate IS NOT NULL ), mid_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, s.hadm_id FROM sed_midazolam s JOIN sso.admissions a ON s.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_midazolam_icu_patients FROM mid_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_049", "source": "aside.txt", "source_line": 2296, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "9", "user_query": "ICU에서 dexmedetomidine 사용 환자 수 (연도별)", "sql": "WITH sed_dex AS ( SELECT DISTINCT ie.subject_id, ie.hadm_id, ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.hadm_id IS NOT NULL AND ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%DEXMEDETOMIDINE%' OR UPPER(di.label) LIKE '%PRECEDEX%' ) ), dex_by_year AS ( SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, s.hadm_id FROM sed_dex s JOIN sso.admissions a ON s.hadm_id = a.hadm_id ) SELECT admit_year, COUNT(DISTINCT hadm_id) AS n_dexmedetomidine_icu_patients FROM dex_by_year GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_050", "source": "aside.txt", "source_line": 2336, "level": "L1", "section": "D", "section_title": "약물 사용 규모·예후 (10개, L1)", "question_no": "10", "user_query": "loop diuretics(예: furosemide) 사용 환자 수 (연도별)", "sql": "WITH diuretic_loop AS ( SELECT DISTINCT p.subject_id, p.hadm_id FROM sso.prescriptions p WHERE p.hadm_id IS NOT NULL AND p.drug IS NOT NULL AND ( UPPER(p.drug) LIKE '%FUROSEMIDE%' OR UPPER(p.drug) LIKE '%LASIX%' OR UPPER(p.drug) LIKE '%BUMETANIDE%' OR UPPER(p.drug) LIKE '%BUMEX%' OR UPPER(p.drug) LIKE '%TORSEMIDE%' OR UPPER(p.drug) LIKE '%DEMADEX%' ) ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(DISTINCT d.hadm_id) AS n_loop_diuretic_patients FROM sso.admissions a JOIN diuretic_loop d ON a.hadm_id = d.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_051", "source": "aside.txt", "source_line": 2411, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "1-1", "user_query": "당뇨 vs 비당뇨 병원 사망률 (연도별)", "sql": "WITH dm_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '250%') OR (d.icd_version = 10 AND ( d.icd_code LIKE 'E10%' OR d.icd_code LIKE 'E11%' OR d.icd_code LIKE 'E13%' )) ) ), adm_dm_flag AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN dm.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_dm, a.hospital_expire_flag FROM sso.admissions a LEFT JOIN dm_hadm dm ON a.hadm_id = dm.hadm_id ) SELECT admit_year, CASE WHEN has_dm = 1 THEN 'DM' ELSE 'NON_DM' END AS dm_group, COUNT(*) AS n_admissions, SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM adm_dm_flag GROUP BY admit_year, CASE WHEN has_dm = 1 THEN 'DM' ELSE 'NON_DM' END ORDER BY admit_year, dm_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_052", "source": "aside.txt", "source_line": 2456, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "1-2", "user_query": "당뇨 vs 비당뇨 ICU 사망률 (연도별)", "sql": "WITH dm_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '250%') OR (d.icd_version = 10 AND ( d.icd_code LIKE 'E10%' OR d.icd_code LIKE 'E11%' OR d.icd_code LIKE 'E13%' )) ) ), dm_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN dm.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_dm FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id LEFT JOIN dm_hadm dm ON i.hadm_id = dm.hadm_id ), dm_icu_flag AS ( SELECT admit_year, has_dm, stay_id, CASE WHEN hospital_expire_flag = 1 AND deathtime IS NOT NULL AND outtime IS NOT NULL AND deathtime <= outtime THEN 1 ELSE 0 END AS died_in_icu FROM dm_icu ) SELECT admit_year, CASE WHEN has_dm = 1 THEN 'DM' ELSE 'NON_DM' END AS dm_group, COUNT(DISTINCT stay_id) AS n_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM dm_icu_flag GROUP BY admit_year, CASE WHEN has_dm = 1 THEN 'DM' ELSE 'NON_DM' END ORDER BY admit_year, dm_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_053", "source": "aside.txt", "source_line": 2519, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "1-3", "user_query": "고혈압 vs 비고혈압 ICU 사망률 (연도별)", "sql": "WITH htn_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( SUBSTR(d.icd_code, 1, 3) BETWEEN '401' AND '405' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'I10%' OR d.icd_code LIKE 'I11%' OR d.icd_code LIKE 'I12%' OR d.icd_code LIKE 'I13%' OR d.icd_code LIKE 'I15%' OR d.icd_code LIKE 'I16%' )) ) ), htn_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN h.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_htn FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id LEFT JOIN htn_hadm h ON i.hadm_id = h.hadm_id ), htn_icu_flag AS ( SELECT admit_year, has_htn, stay_id, CASE WHEN hospital_expire_flag = 1 AND deathtime IS NOT NULL AND outtime IS NOT NULL AND deathtime <= outtime THEN 1 ELSE 0 END AS died_in_icu FROM htn_icu ) SELECT admit_year, CASE WHEN has_htn = 1 THEN 'HTN' ELSE 'NON_HTN' END AS htn_group, COUNT(DISTINCT stay_id) AS n_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM htn_icu_flag GROUP BY admit_year, CASE WHEN has_htn = 1 THEN 'HTN' ELSE 'NON_HTN' END ORDER BY admit_year, htn_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_054", "source": "aside.txt", "source_line": 2591, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "2-1", "user_query": "심부전, 심근경색, COPD 30일 재입원 (패턴 동일)", "sql": "WITH hf_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ) ), hf_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year, LEAD(a.admittime) OVER ( PARTITION BY a.subject_id ORDER BY a.admittime ) AS next_admittime FROM sso.admissions a JOIN hf_hadm h ON a.hadm_id = h.hadm_id WHERE a.dischtime IS NOT NULL ) SELECT admit_year, COUNT(*) AS n_hf_admissions, SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) AS n_30d_readmit, 100.0 * SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM hf_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"id": "aside_qv_055", "source": "aside.txt", "source_line": 2766, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "3-1", "user_query": "패혈증 vs 비패혈증 병원 사망률 (연도별)", "sql": "WITH sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' OR d.icd_code LIKE 'R6521%' )) ) ), sepsis_flag AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN s.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_sepsis, a.hospital_expire_flag FROM sso.admissions a LEFT JOIN sepsis_hadm s ON a.hadm_id = s.hadm_id ) SELECT admit_year, CASE WHEN has_sepsis = 1 THEN 'SEPSIS' ELSE 'NON_SEPSIS' END AS sepsis_group, COUNT(*) AS n_admissions, SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM sepsis_flag GROUP BY admit_year, CASE WHEN has_sepsis = 1 THEN 'SEPSIS' ELSE 'NON_SEPSIS' END ORDER BY admit_year, sepsis_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_056", "source": "aside.txt", "source_line": 2815, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "3-2", "user_query": "암 vs 비암 ICU 사망률 (연도별)", "sql": "WITH cancer_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 10 AND d.icd_code LIKE 'C%') OR (d.icd_version = 9 AND REGEXP_LIKE(d.icd_code, '^[0-9]{3}') AND TO_NUMBER(SUBSTR(d.icd_code, 1, 3)) BETWEEN 140 AND 208 ) ) ), cancer_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN c.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_cancer FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id LEFT JOIN cancer_hadm c ON i.hadm_id = c.hadm_id ), cancer_icu_flag AS ( SELECT admit_year, has_cancer, stay_id, CASE WHEN hospital_expire_flag = 1 AND deathtime IS NOT NULL AND outtime IS NOT NULL AND deathtime <= outtime THEN 1 ELSE 0 END AS died_in_icu FROM cancer_icu ) SELECT admit_year, CASE WHEN has_cancer = 1 THEN 'CANCER' ELSE 'NON_CANCER' END AS cancer_group, COUNT(DISTINCT stay_id) AS n_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM cancer_icu_flag GROUP BY admit_year, CASE WHEN has_cancer = 1 THEN 'CANCER' ELSE 'NON_CANCER' END ORDER BY admit_year, cancer_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_057", "source": "aside.txt", "source_line": 2880, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "3-3", "user_query": "CKD vs 비CKD 병원 사망률 (연도별)", "sql": "WITH ckd_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '585%' OR d.icd_code = '586' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'N18%' OR d.icd_code = 'N19' )) ) ), ckd_flag AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN c.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_ckd, a.hospital_expire_flag FROM sso.admissions a LEFT JOIN ckd_hadm c ON a.hadm_id = c.hadm_id ) SELECT admit_year, CASE WHEN has_ckd = 1 THEN 'CKD' ELSE 'NON_CKD' END AS ckd_group, COUNT(*) AS n_admissions, SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM ckd_flag GROUP BY admit_year, CASE WHEN has_ckd = 1 THEN 'CKD' ELSE 'NON_CKD' END ORDER BY admit_year, ckd_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_058", "source": "aside.txt", "source_line": 2932, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "4-1", "user_query": "평균 LOS (연도별)", "sql": "WITH hf_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ) ), ckd_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '585%') OR (d.icd_version = 10 AND d.icd_code LIKE 'N18%') ) ), hf_ckd_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, (CAST(a.dischtime AS DATE) - CAST(a.admittime AS DATE)) AS los_days FROM sso.admissions a JOIN hf_hadm hf ON a.hadm_id = hf.hadm_id JOIN ckd_hadm ckd ON a.hadm_id = ckd.hadm_id WHERE a.admittime IS NOT NULL AND a.dischtime IS NOT NULL AND a.dischtime >= a.admittime ) SELECT admit_year, COUNT(*) AS n_hf_ckd_admissions, AVG(los_days) AS avg_los_days FROM hf_ckd_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_059", "source": "aside.txt", "source_line": 2975, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "4-2", "user_query": "LOS 분포 (연도별, raw)", "sql": "WITH hf_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ) ), ckd_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '585%') OR (d.icd_version = 10 AND d.icd_code LIKE 'N18%') ) ), hf_ckd_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year, (CAST(a.dischtime AS DATE) - CAST(a.admittime AS DATE)) AS los_days FROM sso.admissions a JOIN hf_hadm hf ON a.hadm_id = hf.hadm_id JOIN ckd_hadm ckd ON a.hadm_id = ckd.hadm_id WHERE a.admittime IS NOT NULL AND a.dischtime IS NOT NULL AND a.dischtime >= a.admittime ) SELECT admit_year, subject_id, hadm_id, admittime, dischtime, los_days FROM hf_ckd_adm ORDER BY admit_year, los_days DESC, hadm_id;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_060", "source": "aside.txt", "source_line": 3027, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-1", "user_query": "암 + 패혈증 동반 환자의 ICU 재원 기간 분포 (연도별)", "sql": "WITH cancer_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 10 AND d.icd_code LIKE 'C%') OR (d.icd_version = 9 AND REGEXP_LIKE(d.icd_code, '^[0-9]{3}') AND TO_NUMBER(SUBSTR(d.icd_code, 1, 3)) BETWEEN 140 AND 208) ) ), sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' OR d.icd_code LIKE 'R6521%' )) ) ), cancer_sepsis_icu AS ( SELECT i.subject_id, i.hadm_id, i.stay_id, i.intime, i.outtime, a.admittime, EXTRACT(YEAR FROM a.admittime) AS admit_year, (CAST(i.outtime AS DATE) - CAST(i.intime AS DATE)) AS icu_los_days FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cancer_hadm c ON i.hadm_id = c.hadm_id JOIN sepsis_hadm s ON i.hadm_id = s.hadm_id WHERE i.intime IS NOT NULL AND i.outtime IS NOT NULL AND i.outtime >= i.intime ) SELECT admit_year, subject_id, hadm_id, stay_id, intime, outtime, icu_los_days FROM cancer_sepsis_icu ORDER BY admit_year, icu_los_days DESC, stay_id;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_061", "source": "aside.txt", "source_line": 3101, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-2", "user_query": "패혈증 + ARDS 유병률 (연도별)", "sql": "WITH sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' )) ) ), ards_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 10 AND d.icd_code LIKE 'J80%') OR (d.icd_version = 9 AND d.icd_code IN ('51882')) ) ), sepsis_ards_hadm AS ( SELECT s.hadm_id FROM sepsis_hadm s JOIN ards_hadm a ON s.hadm_id = a.hadm_id ) SELECT EXTRACT(YEAR FROM adm.admittime) AS admit_year, COUNT(*) AS n_admissions, SUM(CASE WHEN sa.hadm_id IS NOT NULL THEN 1 ELSE 0 END) AS n_sepsis_ards_admissions, 100.0 * SUM(CASE WHEN sa.hadm_id IS NOT NULL THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS sepsis_ards_prev_pct FROM sso.admissions adm LEFT JOIN sepsis_ards_hadm sa ON adm.hadm_id = sa.hadm_id GROUP BY EXTRACT(YEAR FROM adm.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_062", "source": "aside.txt", "source_line": 3153, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-3", "user_query": "COPD 환자 중 기계환기 치료 비율 / 7일 이상 비율 (연도별)", "sql": "WITH copd_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '491%' OR d.icd_code LIKE '492%' OR d.icd_code LIKE '496%' )) OR (d.icd_version = 10 AND d.icd_code LIKE 'J44%') ) ), copd_icu AS ( SELECT i.stay_id, i.hadm_id, i.subject_id, i.intime, i.outtime, a.admittime, EXTRACT(YEAR FROM a.admittime) AS admit_year, (CAST(i.outtime AS DATE) - CAST(i.intime AS DATE)) AS icu_los_days FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN copd_hadm c ON i.hadm_id = c.hadm_id WHERE i.intime IS NOT NULL AND i.outtime IS NOT NULL AND i.outtime >= i.intime ), mechvent_stay AS ( SELECT DISTINCT ce.stay_id FROM sso.chartevents ce JOIN sso.d_items di ON ce.itemid = di.itemid WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ( UPPER(di.label) LIKE '%ENDOTRACHEAL%' OR UPPER(di.label) LIKE '%ETT%' OR UPPER(di.label) LIKE '%INTUB%' OR UPPER(di.label) LIKE '%VENTILATOR MODE%' OR UPPER(di.label) LIKE '%MECH VENT%' ) ) SELECT c.admit_year, COUNT(DISTINCT c.stay_id) AS n_copd_icu_stays, SUM(CASE WHEN mv.stay_id IS NOT NULL THEN 1 ELSE 0 END) AS n_mechvent_stays, 100.0 * SUM(CASE WHEN mv.stay_id IS NOT NULL THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT c.stay_id), 0) AS mechvent_rate_pct, SUM(CASE WHEN c.icu_los_days >= 7 THEN 1 ELSE 0 END) AS n_icu_los_ge_7d_stays, 100.0 * SUM(CASE WHEN c.icu_los_days >= 7 THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT c.stay_id), 0) AS icu_los_ge_7d_rate_pct FROM copd_icu c LEFT JOIN mechvent_stay mv ON c.stay_id = mv.stay_id GROUP BY c.admit_year ORDER BY c.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_063", "source": "aside.txt", "source_line": 3226, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-4", "user_query": "AKI 환자: RRT 시행 vs 미시행 ICU 사망률 (연도별)", "sql": "WITH aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '584%') OR (d.icd_version = 10 AND d.icd_code LIKE 'N17%') ) ), aki_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN aki_hadm k ON i.hadm_id = k.hadm_id ), rrt_stays AS ( SELECT DISTINCT p.stay_id FROM sso.procedureevents p WHERE p.stay_id IS NOT NULL AND p.starttime IS NOT NULL AND p.itemid IN ( 225441, 225802, 225803, 225809, 225955, 225805 ) ), aki_rrt_flag AS ( SELECT ak.stay_id, ak.hadm_id, ak.outtime, ak.admittime, ak.deathtime, ak.hospital_expire_flag, ak.admit_year, CASE WHEN r.stay_id IS NOT NULL THEN 1 ELSE 0 END AS has_rrt, CASE WHEN ak.hospital_expire_flag = 1 AND ak.deathtime IS NOT NULL AND ak.outtime IS NOT NULL AND ak.deathtime <= ak.outtime THEN 1 ELSE 0 END AS died_in_icu FROM aki_icu ak LEFT JOIN rrt_stays r ON ak.stay_id = r.stay_id ) SELECT admit_year, CASE WHEN has_rrt = 1 THEN 'RRT' ELSE 'NO_RRT' END AS rrt_group, COUNT(DISTINCT stay_id) AS n_aki_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM aki_rrt_flag GROUP BY admit_year, CASE WHEN has_rrt = 1 THEN 'RRT' ELSE 'NO_RRT' END ORDER BY admit_year, rrt_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_064", "source": "aside.txt", "source_line": 3377, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-6", "user_query": "심근경색 환자의 ICU 재입원 비율 (연도별)", "sql": "WITH mi_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '410%') OR (d.icd_version = 10 AND (d.icd_code LIKE 'I21%' OR d.icd_code LIKE 'I22%')) ) ), mi_icu_counts AS ( SELECT i.hadm_id, COUNT(DISTINCT i.stay_id) AS n_icu_stays FROM sso.icustays i JOIN mi_hadm m ON i.hadm_id = m.hadm_id GROUP BY i.hadm_id ), mi_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN mi_hadm m ON a.hadm_id = m.hadm_id ) SELECT m.admit_year, COUNT(*) AS n_mi_admissions, SUM(CASE WHEN NVL(ic.n_icu_stays, 0) >= 2 THEN 1 ELSE 0 END) AS n_icu_readmit, 100.0 * SUM(CASE WHEN NVL(ic.n_icu_stays, 0) >= 2 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS icu_readmission_rate_pct FROM mi_adm m LEFT JOIN mi_icu_counts ic ON m.hadm_id = ic.hadm_id GROUP BY m.admit_year ORDER BY m.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_065", "source": "aside.txt", "source_line": 3421, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-7", "user_query": "암 + 패혈증 동반 환자의 병원 사망률 (연도별)", "sql": "WITH cancer_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 10 AND d.icd_code LIKE 'C%') OR (d.icd_version = 9 AND REGEXP_LIKE(d.icd_code, '^[0-9]{3}') AND TO_NUMBER(SUBSTR(d.icd_code, 1, 3)) BETWEEN 140 AND 208) ) ), sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' )) ) ), cancer_sepsis_hadm AS ( SELECT c.hadm_id FROM cancer_hadm c JOIN sepsis_hadm s ON c.hadm_id = s.hadm_id ) SELECT EXTRACT(YEAR FROM a.admittime) AS admit_year, COUNT(*) AS n_cancer_sepsis_admissions, SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN a.hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM sso.admissions a JOIN cancer_sepsis_hadm cs ON a.hadm_id = cs.hadm_id GROUP BY EXTRACT(YEAR FROM a.admittime) ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_066", "source": "aside.txt", "source_line": 3478, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5-8", "user_query": "패혈증 환자: vasopressor 사용 vs 미사용 ICU 사망률 (연도별)", "sql": "WITH sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' )) ) ), sepsis_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year, CASE WHEN a.hospital_expire_flag = 1 AND a.deathtime IS NOT NULL AND i.outtime IS NOT NULL AND a.deathtime <= i.outtime THEN 1 ELSE 0 END AS died_in_icu FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN sepsis_hadm s ON i.hadm_id = s.hadm_id ), vasopressor_stays AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%NOREPINEPHRINE%' OR UPPER(di.label) LIKE '%EPINEPHRINE%' OR UPPER(di.label) LIKE '%VASOPRESSIN%' OR UPPER(di.label) LIKE '%PHENYLEPHRINE%' OR UPPER(di.label) LIKE '%DOPAMINE%' OR UPPER(di.label) LIKE '%DOBUTAMINE%' ) ) SELECT s.admit_year, CASE WHEN v.stay_id IS NOT NULL THEN 'VASO' ELSE 'NO_VASO' END AS vaso_group, COUNT(DISTINCT s.stay_id) AS n_sepsis_icu_stays, SUM(s.died_in_icu) AS n_icu_deaths, 100.0 * SUM(s.died_in_icu) / NULLIF(COUNT(DISTINCT s.stay_id), 0) AS icu_mortality_rate_pct FROM sepsis_icu s LEFT JOIN vasopressor_stays v ON s.stay_id = v.stay_id GROUP BY s.admit_year, CASE WHEN v.stay_id IS NOT NULL THEN 'VASO' ELSE 'NO_VASO' END ORDER BY s.admit_year, vaso_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_067", "source": "aside.txt", "source_line": 3578, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "1", "user_query": "수술계 vs 비수술계 병원 사망률 (연도별)", "sql": "WITH adm_service AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, a.hospital_expire_flag, CASE WHEN MAX( CASE WHEN s.curr_service IN ( 'SURG', 'CSURG', 'NSURG', 'TSURG', 'VSURG', 'ORTHO', 'PSURG' ) THEN 1 ELSE 0 END ) = 1 THEN 1 ELSE 0 END AS is_surgical FROM sso.admissions a LEFT JOIN sso.services s ON a.hadm_id = s.hadm_id GROUP BY a.hadm_id, EXTRACT(YEAR FROM a.admittime), a.hospital_expire_flag ) SELECT admit_year, CASE WHEN is_surgical = 1 THEN 'SURGICAL' ELSE 'NON_SURGICAL' END AS service_group, COUNT(*) AS n_admissions, SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM adm_service GROUP BY admit_year, CASE WHEN is_surgical = 1 THEN 'SURGICAL' ELSE 'NON_SURGICAL' END ORDER BY admit_year, service_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_068", "source": "aside.txt", "source_line": 3624, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "2", "user_query": "수술 후 48시간 이내 vs 이후 ICU 입실 환자의 ICU 사망률 (수술계)", "sql": "WITH surg_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, a.hospital_expire_flag, a.deathtime FROM sso.admissions a JOIN sso.services s ON a.hadm_id = s.hadm_id WHERE s.curr_service IN ('SURG','CSURG','NSURG','TSURG','VSURG') GROUP BY a.hadm_id, EXTRACT(YEAR FROM a.admittime), a.hospital_expire_flag, a.deathtime ), first_proc AS ( SELECT p.hadm_id, MIN(p.chartdate) AS first_surg_date FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND p.chartdate IS NOT NULL GROUP BY p.hadm_id ), surg_icu AS ( SELECT i.stay_id, i.hadm_id, i.intime, i.outtime, sa.admit_year, sa.hospital_expire_flag, sa.deathtime, CAST(fp.first_surg_date AS TIMESTAMP) AS surg_ts FROM sso.icustays i JOIN surg_adm sa ON i.hadm_id = sa.hadm_id JOIN first_proc fp ON i.hadm_id = fp.hadm_id WHERE i.intime IS NOT NULL AND i.outtime IS NOT NULL AND i.outtime >= i.intime AND i.intime >= CAST(fp.first_surg_date AS TIMESTAMP) ), surg_icu_flag AS ( SELECT stay_id, hadm_id, admit_year, intime, outtime, CASE WHEN intime <= surg_ts + NUMTODSINTERVAL(48, 'HOUR') THEN 'ICU_WITHIN_48H' ELSE 'ICU_AFTER_48H' END AS icu_timing_group, CASE WHEN hospital_expire_flag = 1 AND deathtime IS NOT NULL AND deathtime <= outtime THEN 1 ELSE 0 END AS died_in_icu FROM surg_icu ) SELECT admit_year, icu_timing_group, COUNT(DISTINCT stay_id) AS n_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM surg_icu_flag GROUP BY admit_year, icu_timing_group ORDER BY admit_year, icu_timing_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"id": "aside_qv_069", "source": "aside.txt", "source_line": 3711, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "3", "user_query": "수술계 진료과 환자의 수술 후 30일 재입원율 (연도별)", "sql": "WITH surg_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN sso.services s ON a.hadm_id = s.hadm_id WHERE s.curr_service IN ('SURG','CSURG','NSURG','TSURG','VSURG') GROUP BY a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) ), first_proc AS ( SELECT p.hadm_id, MIN(p.chartdate) AS first_surg_date FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND p.chartdate IS NOT NULL GROUP BY p.hadm_id ), surg_proc_adm AS ( SELECT sa.subject_id, sa.hadm_id, sa.admit_year, sa.admittime, sa.dischtime, fp.first_surg_date FROM surg_adm sa JOIN first_proc fp ON sa.hadm_id = fp.hadm_id WHERE sa.dischtime IS NOT NULL AND sa.admittime IS NOT NULL AND sa.dischtime >= sa.admittime ), surg_proc_with_next AS ( SELECT spa.*, LEAD(spa2.admittime) OVER ( PARTITION BY spa2.subject_id ORDER BY spa2.admittime ) AS next_admittime FROM sso.admissions spa2 JOIN surg_proc_adm spa ON spa2.hadm_id = spa.hadm_id ), flag AS ( SELECT admit_year, hadm_id, CASE WHEN next_admittime IS NOT NULL AND dischtime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30,'DAY') THEN 1 ELSE 0 END AS readmit_30d FROM surg_proc_with_next ) SELECT admit_year, COUNT(*) AS n_surg_proc_admissions, SUM(readmit_30d) AS n_30d_readmit, 100.0 * SUM(readmit_30d) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM flag GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_070", "source": "aside.txt", "source_line": 3793, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "4", "user_query": "CABG vs 기타 심장 수술 환자의 ICU 사망률 (연도별)", "sql": "WITH cabg_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND ( (p.icd_version = 9 AND ( p.icd_code LIKE '3610%' OR p.icd_code LIKE '3611%' OR p.icd_code LIKE '3612%' OR p.icd_code LIKE '3613%' OR p.icd_code LIKE '3614%' OR p.icd_code LIKE '3615%' OR p.icd_code LIKE '3616%' OR p.icd_code LIKE '3617%' OR p.icd_code LIKE '3619%' )) ) ), valve_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND ( (p.icd_version = 9 AND p.icd_code LIKE '35%') ) ), cardiac_surg_cohort AS ( SELECT hadm_id, 'CABG' AS surg_group FROM cabg_hadm UNION ALL SELECT v.hadm_id, 'OTHER_CARDIAC' AS surg_group FROM valve_hadm v LEFT JOIN cabg_hadm c ON v.hadm_id = c.hadm_id WHERE c.hadm_id IS NULL ), cohort_icu AS ( SELECT i.stay_id, i.hadm_id, i.outtime, a.admittime, a.deathtime, a.hospital_expire_flag, EXTRACT(YEAR FROM a.admittime) AS admit_year, cs.surg_group, CASE WHEN a.hospital_expire_flag = 1 AND a.deathtime IS NOT NULL AND i.outtime IS NOT NULL AND a.deathtime <= i.outtime THEN 1 ELSE 0 END AS died_in_icu FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cardiac_surg_cohort cs ON i.hadm_id = cs.hadm_id ) SELECT admit_year, surg_group, COUNT(DISTINCT stay_id) AS n_icu_stays, SUM(died_in_icu) AS n_icu_deaths, 100.0 * SUM(died_in_icu) / NULLIF(COUNT(DISTINCT stay_id), 0) AS icu_mortality_rate_pct FROM cohort_icu GROUP BY admit_year, surg_group ORDER BY admit_year, surg_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_071", "source": "aside.txt", "source_line": 3878, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "5", "user_query": "CABG 수술 환자 중 기계환기 ≥3일 비율 (연도별)", "sql": "WITH cabg_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND p.icd_version = 9 AND ( p.icd_code LIKE '3610%' OR p.icd_code LIKE '3611%' OR p.icd_code LIKE '3612%' OR p.icd_code LIKE '3613%' OR p.icd_code LIKE '3614%' OR p.icd_code LIKE '3615%' OR p.icd_code LIKE '3616%' OR p.icd_code LIKE '3617%' OR p.icd_code LIKE '3619%' ) ), cabg_icu AS ( SELECT i.stay_id, i.hadm_id, i.intime, i.outtime, a.admittime, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.icustays i JOIN sso.admissions a ON i.hadm_id = a.hadm_id JOIN cabg_hadm c ON i.hadm_id = c.hadm_id WHERE i.stay_id IS NOT NULL ), vent_signal AS ( SELECT ce.stay_id, MIN(ce.charttime) AS vent_starttime, MAX(ce.charttime) AS vent_endtime FROM sso.chartevents ce JOIN sso.d_items di ON ce.itemid = di.itemid WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ( UPPER(di.label) LIKE '%VENTILATOR MODE%' OR UPPER(di.label) LIKE '%MECH VENT%' OR UPPER(di.label) LIKE '%ENDOTRACHEAL%' OR UPPER(di.label) LIKE '%ETT%' OR UPPER(di.label) LIKE '%INTUB%' ) GROUP BY ce.stay_id ), cabg_vent_days AS ( SELECT c.admit_year, c.hadm_id, c.stay_id, CASE WHEN v.vent_starttime IS NULL OR v.vent_endtime IS NULL THEN 0 ELSE (CAST(v.vent_endtime AS DATE) - CAST(v.vent_starttime AS DATE)) END AS vent_days FROM cabg_icu c LEFT JOIN vent_signal v ON c.stay_id = v.stay_id ), cabg_by_adm AS ( SELECT admit_year, hadm_id, MAX(vent_days) AS vent_days_in_adm FROM cabg_vent_days GROUP BY admit_year, hadm_id ) SELECT admit_year, COUNT(*) AS n_cabg_admissions, SUM(CASE WHEN vent_days_in_adm >= 3 THEN 1 ELSE 0 END) AS n_vent_ge_3d, 100.0 * SUM(CASE WHEN vent_days_in_adm >= 3 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS vent_ge_3d_rate_pct FROM cabg_by_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_072", "source": "aside.txt", "source_line": 3971, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "6", "user_query": "주요 복부 수술 후 ICU 입실 vs 미입실 병원 사망률 (연도별)", "sql": "WITH major_abd_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p JOIN sso.d_icd_procedures dp ON p.icd_code = dp.icd_code AND p.icd_version = dp.icd_version WHERE p.hadm_id IS NOT NULL AND ( UPPER(dp.long_title) LIKE '%COLECTOMY%' OR UPPER(dp.long_title) LIKE '%HEMICOLECTOMY%' OR UPPER(dp.long_title) LIKE '%SIGMOIDECTOMY%' OR UPPER(dp.long_title) LIKE '%PROCTECTOMY%' OR UPPER(dp.long_title) LIKE '%BOWEL RESECTION%' OR UPPER(dp.long_title) LIKE '%INTESTIN%' AND UPPER(dp.long_title) LIKE '%RESECTION%' OR UPPER(dp.long_title) LIKE '%GASTRECTOMY%' OR UPPER(dp.long_title) LIKE '%GASTRIC RESECTION%' OR UPPER(dp.long_title) LIKE '%HEPATECTOMY%' OR UPPER(dp.long_title) LIKE '%LOBECTOMY OF LIVER%' OR UPPER(dp.long_title) LIKE '%LIVER RESECTION%' OR UPPER(dp.long_title) LIKE '%PANCREATECTOMY%' OR UPPER(dp.long_title) LIKE '%PANCREATICODUODENECTOMY%' OR UPPER(dp.long_title) LIKE '%WHIPPLE%' ) ), icu_hadm AS ( SELECT DISTINCT hadm_id FROM sso.icustays WHERE hadm_id IS NOT NULL ), abd_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, a.hospital_expire_flag, CASE WHEN i.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS has_icu FROM sso.admissions a JOIN major_abd_hadm m ON a.hadm_id = m.hadm_id LEFT JOIN icu_hadm i ON a.hadm_id = i.hadm_id ) SELECT admit_year, CASE WHEN has_icu = 1 THEN 'ICU_ADMIT' ELSE 'NO_ICU' END AS icu_group, COUNT(*) AS n_major_abd_admissions, SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) AS n_deaths, 100.0 * SUM(CASE WHEN hospital_expire_flag = 1 THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS hospital_mortality_rate_pct FROM abd_adm GROUP BY admit_year, CASE WHEN has_icu = 1 THEN 'ICU_ADMIT' ELSE 'NO_ICU' END ORDER BY admit_year, icu_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_073", "source": "aside.txt", "source_line": 4037, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "7", "user_query": "신경외과 수술 후 tracheostomy 시행 비율 (연도별)", "sql": "WITH nsurg_adm AS ( SELECT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year FROM sso.admissions a JOIN sso.services s ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'NSURG' GROUP BY a.hadm_id, EXTRACT(YEAR FROM a.admittime) ), nsurg_surg_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL ), trach_hadm AS ( SELECT DISTINCT p.hadm_id FROM sso.procedures_icd p WHERE p.hadm_id IS NOT NULL AND ( (p.icd_version = 9 AND (p.icd_code LIKE '311%' OR p.icd_code LIKE '312%')) ) ) SELECT na.admit_year, COUNT(*) AS n_nsurg_surg_admissions, SUM(CASE WHEN th.hadm_id IS NOT NULL THEN 1 ELSE 0 END) AS n_tracheostomy, 100.0 * SUM(CASE WHEN th.hadm_id IS NOT NULL THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS tracheostomy_rate_pct FROM nsurg_adm na JOIN nsurg_surg_hadm nsh ON na.hadm_id = nsh.hadm_id LEFT JOIN trach_hadm th ON na.hadm_id = th.hadm_id GROUP BY na.admit_year ORDER BY na.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_074", "source": "aside.txt", "source_line": 4085, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "8", "user_query": "CVC 삽입 후 48시간 이내 패혈증 vs 비패혈증 환자의 ICU 사망률", "sql": "WITH sepsis_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( ( d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR ( d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' )) ) ), cvc AS ( SELECT pe.stay_id, MIN(pe.starttime) AS cvc_time FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.starttime IS NOT NULL AND pe.itemid IN (224267, 225199) GROUP BY pe.stay_id ), cohort AS ( SELECT i.stay_id, i.hadm_id, i.intime, i.outtime, c.cvc_time FROM sso.icustays i JOIN cvc c ON i.stay_id = c.stay_id WHERE c.cvc_time BETWEEN i.intime AND i.outtime ), labeled AS ( SELECT co.stay_id, co.hadm_id, co.cvc_time, CASE WHEN sh.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS sepsis_flag_icd, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime >= co.cvc_time AND adm.deathtime < (co.cvc_time + INTERVAL '48' HOUR) AND adm.deathtime <= co.outtime THEN 1 ELSE 0 END AS icu_death_within_48h FROM cohort co LEFT JOIN sepsis_hadm sh ON co.hadm_id = sh.hadm_id LEFT JOIN sso.admissions adm ON co.hadm_id = adm.hadm_id ) SELECT sepsis_flag_icd AS sepsis_vs_nonsepsis, COUNT(*) AS n_stays, SUM(icu_death_within_48h) AS n_icu_death_within_48h, ROUND(SUM(icu_death_within_48h) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate_within_48h FROM labeled GROUP BY sepsis_flag_icd ORDER BY sepsis_flag_icd;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_075", "source": "aside.txt", "source_line": 4172, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "9", "user_query": "혈액투석 catheter 삽입 환자의 RRT 시행 비율 (연도별)", "sql": "WITH hd_cath AS ( SELECT pe.stay_id, MIN(pe.starttime) AS hd_cath_time FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.starttime IS NOT NULL AND pe.itemid = 224270 AND pe.value IS NOT NULL GROUP BY pe.stay_id ), base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id JOIN hd_cath h ON i.stay_id = h.stay_id ), rrt_events AS ( SELECT pe.stay_id, MIN(pe.starttime) AS rrt_time FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.starttime IS NOT NULL AND pe.value IS NOT NULL AND pe.itemid IN ( 225441, 225802, 225803, 225805, 224270, 225809, 225955, 225436 ) GROUP BY pe.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN r.stay_id IS NOT NULL THEN 1 ELSE 0 END AS rrt_flag FROM base b LEFT JOIN rrt_events r ON b.stay_id = r.stay_id ) SELECT anchor_year_group, COUNT(*) AS n_hd_catheter_stays, SUM(rrt_flag) AS n_rrt_stays, ROUND(SUM(rrt_flag) / NULLIF(COUNT(*), 0), 4) AS rrt_rate FROM labeled GROUP BY anchor_year_group ORDER BY anchor_year_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_076", "source": "aside.txt", "source_line": 4253, "level": "L2", "section": "B", "section_title": "수술/시술 관련 코호트·예후 (10문항)", "question_no": "10", "user_query": "혈액투석 catheter 삽입 vs 비삽입 환자의 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), hd_cath AS ( SELECT pe.stay_id, MIN(pe.starttime) AS hd_cath_time FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.starttime IS NOT NULL AND pe.itemid = 224270 AND pe.value IS NOT NULL GROUP BY pe.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN h.stay_id IS NOT NULL THEN 1 ELSE 0 END AS hd_catheter_flag, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN hd_cath h ON b.stay_id = h.stay_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id ) SELECT anchor_year_group, hd_catheter_flag, COUNT(*) AS n_stays, SUM(icu_mortality) AS n_icu_death, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, hd_catheter_flag ORDER BY anchor_year_group, hd_catheter_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_077", "source": "aside.txt", "source_line": 4335, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "1-1", "user_query": "vasopressin 사용 vs 미사용 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), vaso AS ( SELECT ie.stay_id, MIN(ie.starttime) AS vaso_starttime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid = 222315 GROUP BY ie.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END AS vasopressin_flag, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN vaso v ON b.stay_id = v.stay_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id ) SELECT anchor_year_group, vasopressin_flag, COUNT(*) AS n_stays, SUM(icu_mortality) AS n_icu_death, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, vasopressin_flag ORDER BY anchor_year_group, vasopressin_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_078", "source": "aside.txt", "source_line": 4396, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "1-2", "user_query": "epinephrine 사용 vs 미사용 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), epi AS ( SELECT ie.stay_id, MIN(ie.starttime) AS epi_starttime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid = 221289 GROUP BY ie.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN e.stay_id IS NOT NULL THEN 1 ELSE 0 END AS epinephrine_flag, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN epi e ON b.stay_id = e.stay_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id ) SELECT anchor_year_group, epinephrine_flag, COUNT(*) AS n_stays, SUM(icu_mortality) AS n_icu_death, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, epinephrine_flag ORDER BY anchor_year_group, epinephrine_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_079", "source": "aside.txt", "source_line": 4457, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "1-3", "user_query": "norepinephrine 단독 vs norepi+vasopressin 병용 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), norepi AS ( SELECT ie.stay_id, MIN(ie.starttime) AS norepi_starttime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid = 221906 GROUP BY ie.stay_id ), vaso AS ( SELECT ie.stay_id, MIN(ie.starttime) AS vaso_starttime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid = 222315 GROUP BY ie.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN n.stay_id IS NOT NULL AND v.stay_id IS NOT NULL THEN 'norepi_vaso_combo' WHEN n.stay_id IS NOT NULL AND v.stay_id IS NULL THEN 'norepi_alone' ELSE NULL END AS therapy_group, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN norepi n ON b.stay_id = n.stay_id LEFT JOIN vaso v ON b.stay_id = v.stay_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id WHERE n.stay_id IS NOT NULL ) SELECT anchor_year_group, therapy_group, COUNT(*) AS n_stays, SUM(icu_mortality) AS n_icu_death, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, therapy_group ORDER BY anchor_year_group, therapy_group;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_080", "source": "aside.txt", "source_line": 4538, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "2-1", "user_query": "vancomycin 사용 vs 미사용 환자의 AKI 발생 비율 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), vanco AS ( SELECT ie.stay_id, MIN(ie.starttime) AS vanco_starttime FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND LOWER(di.label) LIKE '%vancomycin%' GROUP BY ie.stay_id ), creat_base AS ( SELECT le.stay_id, MIN(le.valuenum) AS creat_baseline FROM sso.chartevents le JOIN sso.d_items di ON le.itemid = di.itemid WHERE le.stay_id IS NOT NULL AND le.charttime IS NOT NULL AND le.valuenum IS NOT NULL AND le.valuenum > 0 AND LOWER(di.label) LIKE '%creatinine%' AND le.charttime <= ( SELECT i.intime + INTERVAL '48' HOUR FROM sso.icustays i WHERE i.stay_id = le.stay_id ) GROUP BY le.stay_id ), creat_peak AS ( SELECT le.stay_id, MAX(le.valuenum) AS creat_peak FROM sso.chartevents le JOIN sso.d_items di ON le.itemid = di.itemid WHERE le.stay_id IS NOT NULL AND le.charttime IS NOT NULL AND le.valuenum IS NOT NULL AND le.valuenum > 0 AND LOWER(di.label) LIKE '%creatinine%' GROUP BY le.stay_id ), aki AS ( SELECT cb.stay_id, CASE WHEN cp.creat_peak >= cb.creat_baseline * 1.5 THEN 1 ELSE 0 END AS aki_flag FROM creat_base cb LEFT JOIN creat_peak cp ON cb.stay_id = cp.stay_id ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END AS vanco_flag, COALESCE(a.aki_flag, 0) AS aki_flag FROM base b LEFT JOIN vanco v ON b.stay_id = v.stay_id LEFT JOIN aki a ON b.stay_id = a.stay_id ) SELECT anchor_year_group, vanco_flag, COUNT(*) AS n_stays, SUM(aki_flag) AS n_aki, ROUND(SUM(aki_flag) / NULLIF(COUNT(*), 0), 4) AS aki_rate FROM labeled GROUP BY anchor_year_group, vanco_flag ORDER BY anchor_year_group, vanco_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_081", "source": "aside.txt", "source_line": 4649, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "2-2", "user_query": "broad‑spectrum 항생제 사용 vs 미사용 환자의 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), abx_hadm AS ( SELECT DISTINCT pr.hadm_id FROM sso.prescriptions pr WHERE pr.hadm_id IS NOT NULL AND pr.drug IS NOT NULL AND ( UPPER(pr.drug) LIKE '%PIPERACILLIN%TAZOBACTAM%' OR UPPER(pr.drug) LIKE '%PIPERACILLIN/TAZOBACTAM%' OR (UPPER(pr.drug) LIKE '%PIPERACILLIN%' AND UPPER(pr.drug) LIKE '%TAZOBACTAM%') OR UPPER(pr.drug) LIKE '%ZOSYN%' OR UPPER(pr.drug) LIKE '%TAZOCIN%' OR UPPER(pr.drug) LIKE '%MEROPENEM%' OR UPPER(pr.drug) LIKE '%IMIPENEM%' OR UPPER(pr.drug) LIKE '%ERTAPENEM%' OR UPPER(pr.drug) LIKE '%DORIPENEM%' ) ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN a.hadm_id IS NOT NULL THEN 1 ELSE 0 END AS broad_abx_flag, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN abx_hadm a ON b.hadm_id = a.hadm_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id ) SELECT anchor_year_group, broad_abx_flag, COUNT(*) AS n_icu_stays, SUM(icu_mortality) AS n_icu_deaths, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, broad_abx_flag ORDER BY anchor_year_group, broad_abx_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_082", "source": "aside.txt", "source_line": 4724, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "3-1", "user_query": "propofol 단독 vs midazolam 단독 진정: 기계환기 기간 분포", "sql": "WITH propofol_stay AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND UPPER(di.label) LIKE '%PROPOFOL%' ), midazolam_stay AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND (UPPER(di.label) LIKE '%MIDAZOLAM%' OR UPPER(di.label) LIKE '%VERSED%') ), sedation_cohort AS ( SELECT i.stay_id, i.intime, i.outtime, CASE WHEN p.stay_id IS NOT NULL AND m.stay_id IS NULL THEN 'propofol_only' WHEN p.stay_id IS NULL AND m.stay_id IS NOT NULL THEN 'midazolam_only' ELSE NULL END AS sed_group FROM sso.icustays i LEFT JOIN propofol_stay p ON i.stay_id = p.stay_id LEFT JOIN midazolam_stay m ON i.stay_id = m.stay_id WHERE (p.stay_id IS NOT NULL AND m.stay_id IS NULL) OR (p.stay_id IS NULL AND m.stay_id IS NOT NULL) ), vent_signal AS ( SELECT ce.stay_id, MIN(ce.charttime) AS vent_starttime, MAX(ce.charttime) AS vent_endtime FROM sso.chartevents ce JOIN sso.d_items di ON ce.itemid = di.itemid WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ( UPPER(di.label) LIKE '%VENTILATOR MODE%' OR UPPER(di.label) LIKE '%MECH VENT%' OR UPPER(di.label) LIKE '%ENDOTRACHEAL%' OR UPPER(di.label) LIKE '%ETT%' OR UPPER(di.label) LIKE '%INTUB%' ) GROUP BY ce.stay_id ), mv AS ( SELECT sc.sed_group, sc.stay_id, vs.vent_starttime, vs.vent_endtime, CASE WHEN vs.vent_starttime IS NOT NULL AND vs.vent_endtime IS NOT NULL AND vs.vent_endtime >= vs.vent_starttime THEN (CAST(vs.vent_endtime AS DATE) - CAST(vs.vent_starttime AS DATE)) * 24 ELSE NULL END AS mv_hours FROM sedation_cohort sc LEFT JOIN vent_signal vs ON sc.stay_id = vs.stay_id ) SELECT sed_group, COUNT(*) AS n_stays, SUM(CASE WHEN mv_hours IS NOT NULL THEN 1 ELSE 0 END) AS n_with_mv_signal, ROUND(AVG(mv_hours), 2) AS mean_mv_hours, ROUND(MIN(mv_hours), 2) AS min_mv_hours, ROUND(MAX(mv_hours), 2) AS max_mv_hours FROM mv GROUP BY sed_group ORDER BY sed_group;", "expected_chart_type": "box", "accepted_chart_types": ["box", "violin", "hist"], "chart_rationale": "그룹 간 분포 비교 질문"}
{"id": "aside_qv_083", "source": "aside.txt", "source_line": 4822, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "3-2", "user_query": "dexmedetomidine 사용 vs 미사용 ICU 사망률 (연도별)", "sql": "WITH base AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime, p.anchor_year_group FROM sso.icustays i JOIN sso.patients p ON i.subject_id = p.subject_id ), dex AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%DEXMEDETOMIDINE%' OR UPPER(di.label) LIKE '%PRECEDEX%' ) ), labeled AS ( SELECT b.anchor_year_group, b.stay_id, CASE WHEN d.stay_id IS NOT NULL THEN 1 ELSE 0 END AS dex_flag, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN b.intime AND b.outtime THEN 1 ELSE 0 END AS icu_mortality FROM base b LEFT JOIN dex d ON b.stay_id = d.stay_id LEFT JOIN sso.admissions adm ON b.hadm_id = adm.hadm_id ) SELECT anchor_year_group, dex_flag, COUNT(*) AS n_stays, SUM(icu_mortality) AS n_icu_death, ROUND(SUM(icu_mortality) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate FROM labeled GROUP BY anchor_year_group, dex_flag ORDER BY anchor_year_group, dex_flag;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_084", "source": "aside.txt", "source_line": 4885, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "3-3", "user_query": "loop diuretic 사용량 사분위수별 AKI 비율", "sql": "WITH loop_rx AS ( SELECT pr.hadm_id, SUM( CASE WHEN REGEXP_SUBSTR(pr.dose_val_rx, '([0-9]+(\\.[0-9]+)?)') IS NOT NULL THEN TO_NUMBER(REGEXP_SUBSTR(pr.dose_val_rx, '([0-9]+(\\.[0-9]+)?)')) ELSE 0 END ) AS total_loop_dose_raw FROM sso.prescriptions pr WHERE pr.hadm_id IS NOT NULL AND pr.drug IS NOT NULL AND pr.dose_val_rx IS NOT NULL AND ( UPPER(pr.drug) LIKE '%FUROSEMIDE%' OR UPPER(pr.drug) LIKE '%LASIX%' OR UPPER(pr.drug) LIKE '%BUMETANIDE%' OR UPPER(pr.drug) LIKE '%BUMEX%' OR UPPER(pr.drug) LIKE '%TORSEMIDE%' OR UPPER(pr.drug) LIKE '%DEMADEX%' ) GROUP BY pr.hadm_id ), loop_q AS ( SELECT hadm_id, total_loop_dose_raw AS total_loop_dose, NTILE(4) OVER (ORDER BY total_loop_dose_raw) AS loop_quartile FROM loop_rx ), creat AS ( SELECT le.hadm_id, le.charttime, le.valuenum AS creatinine FROM sso.labevents le WHERE le.hadm_id IS NOT NULL AND le.charttime IS NOT NULL AND le.valuenum IS NOT NULL AND le.valuenum > 0 AND le.itemid IN (50912, 52546) ), adm_time AS ( SELECT hadm_id, admittime FROM sso.admissions WHERE hadm_id IS NOT NULL AND admittime IS NOT NULL ), creat_baseline AS ( SELECT c.hadm_id, MIN(c.creatinine) AS creat_baseline FROM creat c JOIN adm_time a ON c.hadm_id = a.hadm_id WHERE c.charttime >= a.admittime AND c.charttime < (a.admittime + INTERVAL '48' HOUR) GROUP BY c.hadm_id ), creat_peak AS ( SELECT hadm_id, MAX(creatinine) AS creat_peak FROM creat GROUP BY hadm_id ), aki_hadm AS ( SELECT cb.hadm_id, CASE WHEN cp.creat_peak >= cb.creat_baseline * 1.5 THEN 1 ELSE 0 END AS aki_flag FROM creat_baseline cb JOIN creat_peak cp ON cb.hadm_id = cp.hadm_id ) SELECT lq.loop_quartile, MIN(lq.total_loop_dose) AS q_min_total_dose, MAX(lq.total_loop_dose) AS q_max_total_dose, COUNT(*) AS n_hadm, SUM(COALESCE(ah.aki_flag, 0)) AS n_aki, ROUND(SUM(COALESCE(ah.aki_flag, 0)) / NULLIF(COUNT(*), 0), 4) AS aki_rate FROM loop_q lq LEFT JOIN aki_hadm ah ON lq.hadm_id = ah.hadm_id GROUP BY lq.loop_quartile ORDER BY lq.loop_quartile;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "범주/그룹 비교 질문"}
{"id": "aside_qv_085", "source": "aside.txt", "source_line": 5001, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "3-4", "user_query": "opioids 사용 vs 미사용 환자의 ICU LOS 분포", "sql": "WITH opioid_stay AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie JOIN sso.d_items di ON ie.itemid = di.itemid WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ( UPPER(di.label) LIKE '%FENTANYL%' OR UPPER(di.label) LIKE '%MORPHINE%' OR UPPER(di.label) LIKE '%HYDROMORPHONE%' OR UPPER(di.label) LIKE '%DILAUDID%' OR UPPER(di.label) LIKE '%OXYCODONE%' OR UPPER(di.label) LIKE '%METHADONE%' OR UPPER(di.label) LIKE '%TRAMADOL%' OR UPPER(di.label) LIKE '%CODEINE%' OR UPPER(di.label) LIKE '%HYDROCODONE%' ) ), stay_los AS ( SELECT i.stay_id, CASE WHEN o.stay_id IS NOT NULL THEN 'opioid_used' ELSE 'opioid_not_used' END AS opioid_group, (CAST(i.outtime AS DATE) - CAST(i.intime AS DATE)) * 24 AS icu_los_hours FROM sso.icustays i LEFT JOIN opioid_stay o ON i.stay_id = o.stay_id WHERE i.intime IS NOT NULL AND i.outtime IS NOT NULL AND i.outtime >= i.intime ), binned AS ( SELECT opioid_group, CASE WHEN icu_los_hours < 24 THEN '<24h' WHEN icu_los_hours < 48 THEN '24-48h' WHEN icu_los_hours < 72 THEN '48-72h' WHEN icu_los_hours < 168 THEN '72h-7d' ELSE '>=7d' END AS los_bin FROM stay_los ) SELECT opioid_group, los_bin, COUNT(*) AS n_stays FROM binned GROUP BY opioid_group, los_bin ORDER BY opioid_group, los_bin;", "expected_chart_type": "box", "accepted_chart_types": ["box", "violin", "hist"], "chart_rationale": "그룹 간 분포 비교 질문"}
{"id": "aside_qv_086", "source": "aside.txt", "source_line": 5175, "level": "L3", "section": "unknown", "section_title": "", "question_no": "1", "user_query": "패혈증: 병동 입실 → 첫 ICU 입실까지 시간 분포", "sql": "WITH sepsis_adm AS ( SELECT DISTINCT a.subject_id, a.hadm_id, a.admittime FROM sso.admissions a JOIN sso.diagnoses_icd d ON a.hadm_id = d.hadm_id WHERE a.hadm_id IS NOT NULL AND a.admittime IS NOT NULL AND ( ( d.icd_version = 9 AND ( d.icd_code LIKE '038%' OR d.icd_code = '99591' OR d.icd_code = '99592' OR d.icd_code = '78552' )) OR ( d.icd_version = 10 AND ( d.icd_code LIKE 'A40%' OR d.icd_code LIKE 'A41%' OR d.icd_code LIKE 'R652%' )) ) ), first_icu AS ( SELECT i.subject_id, i.hadm_id, MIN(i.intime) AS first_icu_intime FROM sso.icustays i WHERE i.subject_id IS NOT NULL AND i.hadm_id IS NOT NULL AND i.intime IS NOT NULL GROUP BY i.subject_id, i.hadm_id ), sepsis_with_icu AS ( SELECT sa.subject_id, sa.hadm_id, sa.admittime, fi.first_icu_intime, (CAST(fi.first_icu_intime AS DATE) - CAST(sa.admittime AS DATE)) AS time_to_icu_days FROM sepsis_adm sa JOIN first_icu fi ON sa.subject_id = fi.subject_id AND sa.hadm_id = fi.hadm_id WHERE fi.first_icu_intime >= sa.admittime ) SELECT CASE WHEN time_to_icu_days < (1/24) THEN '<1h' WHEN time_to_icu_days < (6/24) THEN '1-6h' WHEN time_to_icu_days < (12/24) THEN '6-12h' WHEN time_to_icu_days < 1 THEN '12-24h' WHEN time_to_icu_days < 2 THEN '1-2d' WHEN time_to_icu_days < 3 THEN '2-3d' WHEN time_to_icu_days < 7 THEN '3-7d' ELSE '>=7d' END AS time_bin, COUNT(*) AS n_hadm FROM sepsis_with_icu GROUP BY CASE WHEN time_to_icu_days < (1/24) THEN '<1h' WHEN time_to_icu_days < (6/24) THEN '1-6h' WHEN time_to_icu_days < (12/24) THEN '6-12h' WHEN time_to_icu_days < 1 THEN '12-24h' WHEN time_to_icu_days < 2 THEN '1-2d' WHEN time_to_icu_days < 3 THEN '2-3d' WHEN time_to_icu_days < 7 THEN '3-7d' ELSE '>=7d' END ORDER BY time_bin;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_087", "source": "aside.txt", "source_line": 5258, "level": "L3", "section": "unknown", "section_title": "", "question_no": "2", "user_query": "ICU 입실 후 첫 24시간: 0–6/6–12/12–24시간 평균 MAP", "sql": "WITH base AS ( SELECT i.stay_id, i.intime FROM sso.icustays i WHERE i.stay_id IS NOT NULL AND i.intime IS NOT NULL ), map_events AS ( SELECT ce.stay_id, ce.charttime, ce.valuenum AS map_value FROM sso.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ce.valuenum IS NOT NULL AND ce.valuenum > 0 AND ce.valuenum < 300 AND ce.itemid IN ( 456, 52, 6702, 443, 220052, 220181, 225312 ) ), map_24h AS ( SELECT m.stay_id, (CAST(m.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 AS hrs_since_icu, m.map_value FROM map_events m JOIN base b ON m.stay_id = b.stay_id WHERE (CAST(m.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 >= 0 AND (CAST(m.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 < 24 ), map_bins AS ( SELECT stay_id, CASE WHEN hrs_since_icu < 6 THEN '0-6h' WHEN hrs_since_icu < 12 THEN '6-12h' ELSE '12-24h' END AS time_bin, AVG(map_value) AS avg_map FROM map_24h GROUP BY stay_id, CASE WHEN hrs_since_icu < 6 THEN '0-6h' WHEN hrs_since_icu < 12 THEN '6-12h' ELSE '12-24h' END ) SELECT time_bin, COUNT(DISTINCT stay_id) AS n_stays_with_map, ROUND(AVG(avg_map), 2) AS mean_of_stay_avg_map FROM map_bins GROUP BY time_bin ORDER BY CASE time_bin WHEN '0-6h' THEN 1 WHEN '6-12h' THEN 2 ELSE 3 END;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"id": "aside_qv_088", "source": "aside.txt", "source_line": 5346, "level": "L3", "section": "unknown", "section_title": "", "question_no": "3", "user_query": "ICU 입실 후 첫 72시간: 시간대별 평균 heart rate", "sql": "WITH base AS ( SELECT i.stay_id, i.intime FROM sso.icustays i WHERE i.stay_id IS NOT NULL AND i.intime IS NOT NULL ), hr_events AS ( SELECT ce.stay_id, ce.charttime, ce.valuenum AS hr FROM sso.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ce.valuenum IS NOT NULL AND ce.itemid IN (211, 220045) AND ce.valuenum > 0 AND ce.valuenum < 300 ), hr_72h AS ( SELECT h.stay_id, (CAST(h.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 AS hrs_since_icu, h.hr FROM hr_events h JOIN base b ON h.stay_id = b.stay_id WHERE (CAST(h.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 >= 0 AND (CAST(h.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 < 72 ), binned AS ( SELECT FLOOR(hrs_since_icu / 6) AS bin_idx, hr FROM hr_72h ) SELECT (bin_idx * 6) AS bin_start_hour, (bin_idx * 6) || '-' || ((bin_idx + 1) * 6) || 'h' AS time_bin, COUNT(*) AS n_measurements, ROUND(AVG(hr), 2) AS mean_hr FROM binned GROUP BY bin_idx ORDER BY bin_idx;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_089", "source": "aside.txt", "source_line": 5405, "level": "L3", "section": "unknown", "section_title": "", "question_no": "4", "user_query": "ICU 입실 후 24h vs 24–48h lactate 분포 비교", "sql": "WITH icu AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime FROM sso.icustays i WHERE i.stay_id IS NOT NULL AND i.subject_id IS NOT NULL AND i.hadm_id IS NOT NULL AND i.intime IS NOT NULL AND i.outtime IS NOT NULL ), lact AS ( SELECT le.subject_id, le.hadm_id, le.charttime, le.valuenum AS lactate FROM sso.labevents le WHERE le.subject_id IS NOT NULL AND le.hadm_id IS NOT NULL AND le.charttime IS NOT NULL AND le.valuenum IS NOT NULL AND le.valuenum > 0 AND le.valuenum < 50 AND le.itemid = 50813 ), lact_icu AS ( SELECT i.stay_id, i.intime, l.charttime, l.lactate, (CAST(l.charttime AS DATE) - CAST(i.intime AS DATE)) * 24 AS hrs_since_icu FROM icu i JOIN lact l ON i.subject_id = l.subject_id AND i.hadm_id = l.hadm_id AND l.charttime >= i.intime AND l.charttime <= i.outtime AND l.charttime < (i.intime + INTERVAL '48' HOUR) ), windowed AS ( SELECT CASE WHEN hrs_since_icu < 24 THEN '0-24h' ELSE '24-48h' END AS time_window, lactate FROM lact_icu WHERE hrs_since_icu >= 0 AND hrs_since_icu < 48 ), binned AS ( SELECT time_window, CASE WHEN lactate < 2 THEN '<2' WHEN lactate < 4 THEN '2-4' WHEN lactate < 6 THEN '4-6' WHEN lactate < 8 THEN '6-8' WHEN lactate < 10 THEN '8-10' ELSE '>=10' END AS lactate_bin FROM windowed ) SELECT time_window, lactate_bin, COUNT(*) AS n_measurements FROM binned GROUP BY time_window, lactate_bin ORDER BY CASE time_window WHEN '0-24h' THEN 1 ELSE 2 END, CASE lactate_bin WHEN '<2' THEN 1 WHEN '2-4' THEN 2 WHEN '4-6' THEN 3 WHEN '6-8' THEN 4 WHEN '8-10' THEN 5 ELSE 6 END;", "expected_chart_type": "box", "accepted_chart_types": ["box", "violin", "hist"], "chart_rationale": "그룹 간 분포 비교 질문"}
{"id": "aside_qv_090", "source": "aside.txt", "source_line": 5506, "level": "L3", "section": "unknown", "section_title": "", "question_no": "5", "user_query": "ICU 입실 후 72시간 이내 혈청 creatinine 최댓값 분포", "sql": "WITH icu AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, i.intime, i.outtime FROM sso.icustays i WHERE i.stay_id IS NOT NULL AND i.subject_id IS NOT NULL AND i.hadm_id IS NOT NULL AND i.intime IS NOT NULL ), cr_lab AS ( SELECT le.subject_id, le.hadm_id, le.charttime, le.valuenum AS creatinine FROM sso.labevents le WHERE le.subject_id IS NOT NULL AND le.hadm_id IS NOT NULL AND le.charttime IS NOT NULL AND le.valuenum IS NOT NULL AND le.valuenum > 0 AND le.valuenum < 50 AND le.itemid IN (50912, 52546) ), cr_72h AS ( SELECT i.stay_id, l.creatinine FROM icu i JOIN cr_lab l ON i.subject_id = l.subject_id AND i.hadm_id = l.hadm_id AND l.charttime >= i.intime AND l.charttime < (i.intime + INTERVAL '72' HOUR) ), cr_max AS ( SELECT stay_id, MAX(creatinine) AS max_creatinine_72h FROM cr_72h GROUP BY stay_id ), binned AS ( SELECT CASE WHEN max_creatinine_72h < 1 THEN '<1.0' WHEN max_creatinine_72h < 1.5 THEN '1.0-1.5' WHEN max_creatinine_72h < 2 THEN '1.5-2.0' WHEN max_creatinine_72h < 3 THEN '2.0-3.0' WHEN max_creatinine_72h < 5 THEN '3.0-5.0' ELSE '>=5.0' END AS creat_bin FROM cr_max ) SELECT creat_bin, COUNT(*) AS n_stays FROM binned GROUP BY creat_bin ORDER BY CASE creat_bin WHEN '<1.0' THEN 1 WHEN '1.0-1.5' THEN 2 WHEN '1.5-2.0' THEN 3 WHEN '2.0-3.0' THEN 4 WHEN '3.0-5.0' THEN 5 ELSE 6 END;", "expected_chart_type": "hist", "accepted_chart_types": ["hist", "box"], "chart_rationale": "분포 중심 질문"}
{"id": "aside_qv_091", "source": "aside.txt", "source_line": 5601, "level": "L3", "section": "unknown", "section_title": "", "question_no": "6", "user_query": "vasopressor 시작 후 0–6h vs 6–24h MAP ≥65 유지 시간 비율", "sql": "WITH vaso_evt AS ( SELECT ie.stay_id, ie.starttime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid IN ( 221906, 221289, 221749, 222315, 221662 ) ), vaso_start AS ( SELECT stay_id, MIN(starttime) AS vaso_starttime FROM vaso_evt GROUP BY stay_id ), map_evt AS ( SELECT ce.stay_id, ce.charttime, ce.valuenum AS map_value FROM sso.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ce.valuenum IS NOT NULL AND ce.valuenum > 0 AND ce.valuenum < 300 AND ce.itemid IN ( 220052, 220181, 225312 ) ), map_post_vaso AS ( SELECT m.stay_id, (CAST(m.charttime AS DATE) - CAST(v.vaso_starttime AS DATE)) * 24 AS hrs_since_vaso, m.map_value FROM map_evt m JOIN vaso_start v ON m.stay_id = v.stay_id WHERE (CAST(m.charttime AS DATE) - CAST(v.vaso_starttime AS DATE)) * 24 >= 0 AND (CAST(m.charttime AS DATE) - CAST(v.vaso_starttime AS DATE)) * 24 < 24 ), windowed AS ( SELECT stay_id, CASE WHEN hrs_since_vaso < 6 THEN '0-6h' ELSE '6-24h' END AS time_window, map_value FROM map_post_vaso ), agg AS ( SELECT time_window, COUNT(*) AS n_map_meas, SUM(CASE WHEN map_value >= 65 THEN 1 ELSE 0 END) AS n_map_ge_65 FROM windowed GROUP BY time_window ) SELECT time_window, n_map_meas, n_map_ge_65, ROUND(n_map_ge_65 / NULLIF(n_map_meas, 0), 4) AS prop_map_ge_65 FROM agg ORDER BY CASE time_window WHEN '0-6h' THEN 1 ELSE 2 END;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"id": "aside_qv_092", "source": "aside.txt", "source_line": 5701, "level": "L3", "section": "unknown", "section_title": "", "question_no": "7", "user_query": "수술 종료 후 첫 24시간 시간대별 평균 MAP", "sql": "WITH proc_end_pe AS ( SELECT pe.stay_id, MAX(pe.endtime) AS proc_endtime_pe FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.endtime IS NOT NULL GROUP BY pe.stay_id ), proc_end_icd AS ( SELECT pi.hadm_id, MAX(CAST(pi.chartdate AS TIMESTAMP)) AS proc_endtime_icd FROM sso.procedures_icd pi WHERE pi.hadm_id IS NOT NULL AND pi.chartdate IS NOT NULL GROUP BY pi.hadm_id ), surg_end AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, COALESCE(p.proc_endtime_pe, x.proc_endtime_icd) AS surg_endtime FROM sso.icustays i LEFT JOIN proc_end_pe p ON i.stay_id = p.stay_id LEFT JOIN proc_end_icd x ON i.hadm_id = x.hadm_id WHERE i.stay_id IS NOT NULL AND i.intime IS NOT NULL AND COALESCE(p.proc_endtime_pe, x.proc_endtime_icd) IS NOT NULL ), map_evt AS ( SELECT ce.stay_id, ce.charttime, ce.valuenum AS map_value FROM sso.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ce.valuenum IS NOT NULL AND ce.valuenum > 0 AND ce.valuenum < 300 AND ce.itemid IN ( 220052, 220181, 225312 ) ), map_post_surg AS ( SELECT s.stay_id, FLOOR( (CAST(m.charttime AS DATE) - CAST(s.surg_endtime AS DATE)) * 24 ) AS hour_since_surg_end, m.map_value FROM surg_end s JOIN map_evt m ON s.stay_id = m.stay_id WHERE (CAST(m.charttime AS DATE) - CAST(s.surg_endtime AS DATE)) * 24 >= 0 AND (CAST(m.charttime AS DATE) - CAST(s.surg_endtime AS DATE)) * 24 < 24 ) SELECT hour_since_surg_end, COUNT(*) AS n_measurements, ROUND(AVG(map_value), 2) AS mean_map FROM map_post_surg GROUP BY hour_since_surg_end ORDER BY hour_since_surg_end;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_093", "source": "aside.txt", "source_line": 5793, "level": "L3", "section": "unknown", "section_title": "", "question_no": "8", "user_query": "수술 종료 후 첫 48시간: vasopressor 사용 여부 비율 변화", "sql": "WITH proc_end_pe AS ( SELECT pe.stay_id, MAX(pe.endtime) AS proc_endtime_pe FROM sso.procedureevents pe WHERE pe.stay_id IS NOT NULL AND pe.endtime IS NOT NULL GROUP BY pe.stay_id ), proc_end_icd AS ( SELECT pi.hadm_id, MAX(CAST(pi.chartdate AS TIMESTAMP)) AS proc_endtime_icd FROM sso.procedures_icd pi WHERE pi.hadm_id IS NOT NULL AND pi.chartdate IS NOT NULL GROUP BY pi.hadm_id ), surg_end AS ( SELECT i.stay_id, i.subject_id, i.hadm_id, COALESCE(p.proc_endtime_pe, x.proc_endtime_icd) AS surg_endtime FROM sso.icustays i LEFT JOIN proc_end_pe p ON i.stay_id = p.stay_id LEFT JOIN proc_end_icd x ON i.hadm_id = x.hadm_id WHERE i.stay_id IS NOT NULL AND i.hadm_id IS NOT NULL AND COALESCE(p.proc_endtime_pe, x.proc_endtime_icd) IS NOT NULL ), vaso_episode AS ( SELECT ie.stay_id, ie.starttime, ie.endtime FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.endtime IS NOT NULL AND ie.endtime > ie.starttime AND ie.itemid IN ( 221906, 221289, 221749, 222315, 221662 ) ), hour_bins AS ( SELECT se.stay_id, se.surg_endtime, (LEVEL - 1) AS hour_idx, (se.surg_endtime + NUMTODSINTERVAL(LEVEL - 1, 'HOUR')) AS bin_start, (se.surg_endtime + NUMTODSINTERVAL(LEVEL, 'HOUR')) AS bin_end FROM surg_end se CONNECT BY LEVEL <= 48 AND PRIOR se.stay_id = se.stay_id AND PRIOR SYS_GUID() IS NOT NULL ), on_flag AS ( SELECT hb.stay_id, hb.hour_idx, CASE WHEN COUNT(ve.stay_id) > 0 THEN 1 ELSE 0 END AS vaso_on FROM hour_bins hb LEFT JOIN vaso_episode ve ON ve.stay_id = hb.stay_id AND ve.starttime < hb.bin_end AND ve.endtime > hb.bin_start GROUP BY hb.stay_id, hb.hour_idx ) SELECT hour_idx AS hour_since_surg_end, COUNT(*) AS n_stays, SUM(vaso_on) AS n_stays_vaso_on, ROUND(SUM(vaso_on) / NULLIF(COUNT(*), 0), 4) AS prop_vaso_on FROM on_flag GROUP BY hour_idx ORDER BY hour_idx;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간축 추세 질문"}
{"id": "aside_qv_094", "source": "aside.txt", "source_line": 5903, "level": "L3", "section": "unknown", "section_title": "", "question_no": "9", "user_query": "기계환기 시작 후 0–24h vs 24–72h 평균 tidal volume", "sql": "WITH vent_signal AS ( SELECT ce.stay_id, MIN(ce.charttime) AS vent_starttime FROM sso.chartevents ce JOIN sso.d_items di ON ce.itemid = di.itemid WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ( UPPER(di.label) LIKE '%VENTILATOR MODE%' OR UPPER(di.label) LIKE '%MECH VENT%' OR UPPER(di.label) LIKE '%ENDOTRACHEAL%' OR UPPER(di.label) LIKE '%ETT%' OR UPPER(di.label) LIKE '%INTUB%' ) GROUP BY ce.stay_id ), tv_evt AS ( SELECT ce.stay_id, ce.charttime, ce.valuenum AS tidal_volume FROM sso.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.charttime IS NOT NULL AND ce.valuenum IS NOT NULL AND ce.valuenum > 0 AND ce.valuenum < 2000 AND ce.itemid IN ( 224685, 224684, 224686, 639, 654, 681, 682, 683, 684 ) ), tv_windowed AS ( SELECT t.stay_id, CASE WHEN (CAST(t.charttime AS DATE) - CAST(v.vent_starttime AS DATE)) * 24 < 24 THEN '0-24h' ELSE '24-72h' END AS time_window, t.tidal_volume FROM tv_evt t JOIN vent_signal v ON t.stay_id = v.stay_id WHERE (CAST(t.charttime AS DATE) - CAST(v.vent_starttime AS DATE)) * 24 >= 0 AND (CAST(t.charttime AS DATE) - CAST(v.vent_starttime AS DATE)) * 24 < 72 ) SELECT time_window, COUNT(*) AS n_measurements, ROUND(AVG(tidal_volume), 2) AS mean_tidal_volume FROM tv_windowed GROUP BY time_window ORDER BY CASE time_window WHEN '0-24h' THEN 1 ELSE 2 END;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"id": "aside_qv_095", "source": "aside.txt", "source_line": 5977, "level": "L3", "section": "unknown", "section_title": "", "question_no": "10", "user_query": "ICU 입실 후 0–6/6–12/12–24h 구간별 urine output 평균", "sql": "WITH base AS ( SELECT stay_id, intime FROM sso.icustays WHERE stay_id IS NOT NULL AND intime IS NOT NULL ), uo_evt AS ( SELECT oe.stay_id, oe.charttime, CASE WHEN oe.itemid = 227488 THEN -1 * oe.value ELSE oe.value END AS uo_value_ml FROM sso.outputevents oe WHERE oe.stay_id IS NOT NULL AND oe.charttime IS NOT NULL AND oe.value IS NOT NULL AND oe.itemid IN ( 226559, 226560, 226561, 226563, 226564, 226565, 226567, 226584, 226557, 226558, 227488, 227489, 226566 ) ), uo_24h AS ( SELECT u.stay_id, CASE WHEN (CAST(u.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 < 6 THEN '0-6h' WHEN (CAST(u.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 < 12 THEN '6-12h' ELSE '12-24h' END AS time_bin, u.uo_value_ml FROM uo_evt u JOIN base b ON u.stay_id = b.stay_id WHERE (CAST(u.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 >= 0 AND (CAST(u.charttime AS DATE) - CAST(b.intime AS DATE)) * 24 < 24 ), uo_stay_bin AS ( SELECT stay_id, time_bin, SUM(uo_value_ml) AS uo_ml_sum FROM uo_24h GROUP BY stay_id, time_bin ) SELECT time_bin, COUNT(*) AS n_stays_with_uo, ROUND(AVG(uo_ml_sum), 2) AS mean_uo_ml_per_stay FROM uo_stay_bin GROUP BY time_bin ORDER BY CASE time_bin WHEN '0-6h' THEN 1 WHEN '6-12h' THEN 2 ELSE 3 END;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "시간 단위 그룹 집계"}
{"source": "L2 (중간) 다중 조인, 코호트 정의, 그룹 비교 (40문항).txt", "source_line": 222, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "4", "user_query": "심부전 진단 환자의 30일 재입원율을 연도별로 보여줘.", "sql": "WITH hf_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '428%') OR (d.icd_version = 10 AND d.icd_code LIKE 'I50%') ) ), hf_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year, LEAD(a.admittime) OVER ( PARTITION BY a.subject_id ORDER BY a.admittime ) AS next_admittime FROM sso.admissions a JOIN hf_hadm h ON a.hadm_id = h.hadm_id WHERE a.dischtime IS NOT NULL ) SELECT admit_year, COUNT(*) AS n_hf_admissions, SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) AS n_30d_readmit, 100.0 * SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM hf_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "연도별 재입원율 추세 질문", "id": "aside_qv_096"}
{"source": "L2 (중간) 다중 조인, 코호트 정의, 그룹 비교 (40문항).txt", "source_line": 275, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "5", "user_query": "심근경색(STEMI/NSTEMI) 진단 환자의 30일 재입원율을 연도별로 보여줘.", "sql": "WITH ami_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND d.icd_code LIKE '410%') OR (d.icd_version = 10 AND (d.icd_code LIKE 'I21%' OR d.icd_code LIKE 'I22%')) ) ), ami_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year, LEAD(a.admittime) OVER ( PARTITION BY a.subject_id ORDER BY a.admittime ) AS next_admittime FROM sso.admissions a JOIN ami_hadm c ON a.hadm_id = c.hadm_id WHERE a.dischtime IS NOT NULL ) SELECT admit_year, COUNT(*) AS n_ami_admissions, SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) AS n_30d_readmit, 100.0 * SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM ami_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "연도별 재입원율 추세 질문", "id": "aside_qv_097"}
{"source": "L2 (중간) 다중 조인, 코호트 정의, 그룹 비교 (40문항).txt", "source_line": 328, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "6", "user_query": "COPD 진단 환자의 30일 재입원율을 연도별로 보여줘.", "sql": "WITH copd_hadm AS ( SELECT DISTINCT d.hadm_id FROM sso.diagnoses_icd d WHERE d.hadm_id IS NOT NULL AND ( (d.icd_version = 9 AND ( d.icd_code LIKE '491%' OR d.icd_code LIKE '492%' OR d.icd_code LIKE '496%' )) OR (d.icd_version = 10 AND ( d.icd_code LIKE 'J44%' OR d.icd_code LIKE 'J43%' )) ) ), copd_adm AS ( SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, EXTRACT(YEAR FROM a.admittime) AS admit_year, LEAD(a.admittime) OVER ( PARTITION BY a.subject_id ORDER BY a.admittime ) AS next_admittime FROM sso.admissions a JOIN copd_hadm c ON a.hadm_id = c.hadm_id WHERE a.dischtime IS NOT NULL ) SELECT admit_year, COUNT(*) AS n_copd_admissions, SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) AS n_30d_readmit, 100.0 * SUM( CASE WHEN next_admittime IS NOT NULL AND next_admittime > dischtime AND next_admittime <= dischtime + NUMTODSINTERVAL(30, 'DAY') THEN 1 ELSE 0 END ) / NULLIF(COUNT(*), 0) AS readmit_30d_rate_pct FROM copd_adm GROUP BY admit_year ORDER BY admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "연도별 재입원율 추세 질문", "id": "aside_qv_098"}
{"source": "L2 (중간) 다중 조인, 코호트 정의, 그룹 비교 (40문항).txt", "source_line": 937, "level": "L2", "section": "A", "section_title": "질환 코호트·예후·합병증 (20문항)", "question_no": "16", "user_query": "뇌졸중 진단 환자에서 기계환기 치료를 받은 환자 비율을 연도별로 보여줘.", "sql": "WITH stroke_base AS ( SELECT DISTINCT a.hadm_id, EXTRACT(YEAR FROM a.admittime) AS admit_year, a.admittime, a.dischtime FROM sso.admissions a JOIN sso.diagnoses_icd d ON d.hadm_id = a.hadm_id WHERE ( d.icd_version = 10 AND ( d.icd_code LIKE 'I60%' OR d.icd_code LIKE 'I61%' OR d.icd_code LIKE 'I63%' OR d.icd_code LIKE 'I64%') ) OR ( d.icd_version = 9 AND ( d.icd_code LIKE '430%' OR d.icd_code LIKE '431%' OR d.icd_code LIKE '434%' OR d.icd_code LIKE '436%') ) ), stroke_vent AS ( SELECT DISTINCT sb.hadm_id FROM stroke_base sb JOIN sso.icustays i ON i.hadm_id = sb.hadm_id JOIN sso.chartevents ce ON ce.stay_id = i.stay_id JOIN sso.d_items di ON di.itemid = ce.itemid WHERE ce.charttime >= sb.admittime AND ce.charttime <= sb.dischtime AND ( REGEXP_LIKE(UPPER(di.label), 'VENT|VENTILAT|MECH') OR REGEXP_LIKE(UPPER(ce.value), 'VENT|ETT|INTUB|EXTUB|TRACH') ) ) SELECT b.admit_year, COUNT(*) AS n_stroke_admissions, SUM(CASE WHEN v.hadm_id IS NOT NULL THEN 1 ELSE 0 END) AS n_vent, ROUND( 100 * SUM(CASE WHEN v.hadm_id IS NOT NULL THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) , 2) AS vent_rate_pct FROM stroke_base b LEFT JOIN stroke_vent v ON v.hadm_id = b.hadm_id GROUP BY b.admit_year ORDER BY b.admit_year;", "expected_chart_type": "line", "accepted_chart_types": ["line", "bar"], "chart_rationale": "연도별 비율 추세 질문", "id": "aside_qv_099"}
{"source": "L2 (중간) 다중 조인, 코호트 정의, 그룹 비교 (40문항).txt", "source_line": 2692, "level": "L2", "section": "C", "section_title": "약물 사용 및 예후·용량 구간 (10문항)", "question_no": "10", "user_query": "ICU 입실 후 첫 입원에서 vasopressor를 사용한 환자와 이후 입원에서만 vasopressor를 사용한 환자의 ICU 사망률을 비교해줘.", "sql": "WITH icu_ranked AS ( SELECT i.subject_id, i.hadm_id, i.stay_id, i.intime, i.outtime, ROW_NUMBER() OVER (PARTITION BY i.subject_id ORDER BY i.intime) AS rn_icu FROM sso.icustays i WHERE i.subject_id IS NOT NULL AND i.stay_id IS NOT NULL AND i.intime IS NOT NULL ), vaso_stay AS ( SELECT DISTINCT ie.stay_id FROM sso.inputevents ie WHERE ie.stay_id IS NOT NULL AND ie.starttime IS NOT NULL AND ie.itemid IN ( 221906, 221289, 221749, 222315, 221662 ) ), first_icu AS ( SELECT r.subject_id, r.hadm_id, r.stay_id AS first_stay_id, r.intime AS first_intime, r.outtime AS first_outtime, CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END AS vaso_in_first_icu FROM icu_ranked r LEFT JOIN vaso_stay v ON r.stay_id = v.stay_id WHERE r.rn_icu = 1 ), later_icu_vaso AS ( SELECT r.subject_id, MAX(CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END) AS vaso_in_later_icu FROM icu_ranked r LEFT JOIN vaso_stay v ON r.stay_id = v.stay_id WHERE r.rn_icu > 1 GROUP BY r.subject_id ), labeled AS ( SELECT f.subject_id, f.first_stay_id, CASE WHEN f.vaso_in_first_icu = 1 THEN 'vaso_in_first_icu' WHEN f.vaso_in_first_icu = 0 AND COALESCE(l.vaso_in_later_icu, 0) = 1 THEN 'vaso_only_later_icu' ELSE NULL END AS patient_group, CASE WHEN adm.deathtime IS NOT NULL AND adm.deathtime BETWEEN f.first_intime AND f.first_outtime THEN 1 ELSE 0 END AS icu_mortality_first_icu FROM first_icu f LEFT JOIN later_icu_vaso l ON f.subject_id = l.subject_id LEFT JOIN sso.admissions adm ON f.hadm_id = adm.hadm_id ) SELECT patient_group, COUNT(*) AS n_patients, SUM(icu_mortality_first_icu) AS n_icu_death_first_icu, ROUND(SUM(icu_mortality_first_icu) / NULLIF(COUNT(*), 0), 4) AS icu_mortality_rate_first_icu FROM labeled WHERE patient_group IS NOT NULL GROUP BY patient_group ORDER BY patient_group;", "expected_chart_type": "bar", "accepted_chart_types": ["bar", "line"], "chart_rationale": "그룹 간 사망률 비교 질문", "id": "aside_qv_100"}
