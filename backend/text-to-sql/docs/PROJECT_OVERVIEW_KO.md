# Text-to-SQL ?꾩껜 援ъ“ + ?듭떖 ?곸꽭 臾몄꽌 

## 1) ?꾩껜 援ъ“ ?붿빟

- `(root)` ?꾨줈?앺듃 理쒖긽???뚯씪 (README, .gitignore ??
- `backend/` API ?쒕쾭(FastAPI), RAG, Oracle, ?뺤콉, ?덉궛, 濡쒓퉭
- `../ui/` Next.js 湲곕컲 ??UI (repo root, ?꾩옱 ?곌껐 ???
- `ui/` ?덇굅??UI (text-to-sql ?대?)
- `scripts/` 寃利??됯?/?곕え罹먯떆 ?ㅽ겕由쏀듃
- `deploy/` Docker Compose 諛?Dockerfile
- `docs/` 臾몄꽌 紐⑥쓬
- `var/` ?고????곗씠??硫뷀??곗씠?? 罹먯떆, 濡쒓렇 ??


## 2) ?듭떖 ?곸꽭 ?ㅻ챸

### 2.1 ?꾩껜 泥섎━ ?먮쫫 (?쒕늿??蹂닿린)

1) ?ъ슜?먭? UI(`/ask`)?먯꽌 吏덈Ц ?낅젰
2) Demo 紐⑤뱶?대㈃ 罹먯떆(`var/cache/demo_cache.json`)?먯꽌 利됱떆 ?묐떟
3) Advanced 紐⑤뱶?대㈃ RAG 而⑦뀓?ㅽ듃 ?앹꽦
4) ENGINEER 紐⑤뜽??SQL 珥덉븞 ?앹꽦
5) ?꾪뿕?꾧? ?믪쑝硫?EXPERT 紐⑤뜽???ш???
6) ?꾩쿂由?洹쒖튃?쇰줈 Oracle 臾몃쾿/留ㅽ븨 蹂댁젙
7) PolicyGate媛 ?덉쟾??寃??(SELECT-only, WHERE ?꾩닔 ??
8) Oracle ?ㅽ뻾 ??寃곌낵 諛섑솚

---

### 2.2 Backend (API + RAG + Oracle) ?곸꽭

**?듭떖 ?ㅼ젙**
- `backend/app/core/config.py`
  - `.env`瑜??쎌뼱 紐⑤뱺 ?듭떖 ?ㅼ젙??濡쒕뵫?⑸땲??
  - 紐⑤뜽/?덉궛/DB/RAG ?ㅼ젙? ???뚯씪??湲곗??낅땲??
  - ?? `ENGINEER_MODEL`, `EXPERT_MODEL`, `ROW_CAP`, `DB_TIMEOUT_SEC` ??

**API 吏꾩엯??*
- `backend/app/main.py`
  - FastAPI ???앹꽦 諛??쇱슦???깅줉

**API ?쇱슦??*
- `backend/app/api/routes/query.py` : 吏덈Ц 泥섎━(oneshot/run ??
- `backend/app/api/routes/admin_metadata.py` : 硫뷀??곗씠???숆린??
- `backend/app/api/routes/admin_budget.py` : ?덉궛 ?곹깭/?ㅼ젙
- `backend/app/api/routes/admin_oracle.py` : Oracle ? ?곹깭
- `backend/app/api/routes/report.py` : 由ы룷??利앸튃 ?낅줈??

**RAG ?뚯씠?꾨씪??*
- `backend/app/services/rag/indexer.py`
  - `var/metadata/*` 臾몄꽌瑜??됱씤???곸옱
- `backend/app/services/rag/retrieval.py`
  - 吏덈Ц??愿?⑤맂 ?ㅽ궎留??덉떆/?쒗뵆由??⑹뼱吏묒쓣 寃??
- `backend/app/services/rag/mongo_store.py`
  - MongoDB ?먮뒗 SimpleStore 湲곕컲 寃????μ냼
- `backend/app/services/runtime/context_budget.py`
  - ?좏겙 ?덉궛??留욎떠 而⑦뀓?ㅽ듃瑜??섎씪??

**SQL ?앹꽦(LLM)怨??ㅼ??ㅽ듃?덉씠??*
- `backend/app/services/agents/orchestrator.py`
  - Demo 罹먯떆, RAG, ?붿??덉뼱/?묒뒪?쇳듃 紐⑤뜽 ?몄텧??珥앷큵
- `backend/app/services/agents/sql_engineer.py`
  - ENGINEER 紐⑤뜽濡?SQL 珥덉븞 ?앹꽦
- `backend/app/services/agents/sql_expert.py`
  - ?꾪뿕?꾧? ?믪쑝硫?EXPERT 紐⑤뜽濡??ш???
- `backend/app/services/agents/llm_client.py`
  - OpenAI ?명솚 API ?몄텧 ?섑띁
- `backend/app/services/agents/prompts.py`
  - 紐⑤뜽 ?꾨＼?꾪듃(Oracle 臾몃쾿 ??吏?쒖궗??
- `backend/app/services/agents/sql_postprocess.py`
  - ?앹꽦 SQL??Oracle 臾몃쾿/?ㅽ궎留덉뿉 留욊쾶 ?먮룞 蹂댁젙

**Oracle ?곌껐/?ㅽ뻾**
- `backend/app/services/oracle/connection.py`
  - Oracle ?곌껐 ? 愿由?
- `backend/app/services/oracle/executor.py`
  - SQL ?ㅽ뻾, row cap/timeout ?곸슜
- `backend/app/services/oracle/metadata_extractor.py`
  - ?ㅽ궎留??뺣낫 異붿텧 (ALL_* 酉?

**?뺤콉/?덉궛/濡쒓렇**
- `backend/app/services/policy/gate.py`
  - SELECT-only, WHERE ?꾩닔, JOIN ?쒗븳 ??
- `backend/app/services/budget_gate.py`
  - ?덉궛 ?쒕룄/?뚮┝ 泥섎━
- `backend/app/services/cost_tracker.py`
  - 鍮꾩슜 ?꾩쟻 諛?濡쒓렇 湲곕줉
- `backend/app/services/logging_store/store.py`
  - ?대깽??濡쒓렇 ???

---

### 2.3 UI (Next.js) ?곸꽭

?꾩옱 ?ъ슜 UI??repo root `../ui/` ?낅땲??  

- `ui/app/ask/page.tsx`
  - 吏덈Ц ?낅젰/?곕え ?ㅽ뻾 ?붾㈃
- `ui/app/review/[qid]/page.tsx`
  - SQL 寃??+ ?ㅽ뻾 ?숈쓽 ?붾㈃
- `ui/app/results/[qid]/page.tsx`
  - 寃곌낵 ?쒖떆 ?붾㈃
- `ui/app/admin/page.tsx`
  - ?덉궛/RAG ?곹깭 ??愿由??붾㈃
- `ui/app/layout.tsx`, `ui/app/globals.css`
  - 怨듯넻 ?덉씠?꾩썐/?ㅽ???

---

### 2.4 Scripts (寃利??됯?) ?곸꽭

- `scripts/validate_assets.py` : 硫뷀??곗씠???좏슚??寃??
- `scripts/validate_index.py` : RAG ?몃뜳???앹꽦/寃利?
- `scripts/validate_examples.py` : SQL ?덉떆 寃利?
- `scripts/pregen_demo_cache.py` : ?곕え 罹먯떆 ?앹꽦
- `scripts/eval_questions.py` : 吏덈Ц?뭆QL?믨껐怨?鍮꾧탳 ?됯?
- `scripts/eval_report_summary.py` : ?됯? ?붿빟 + CSV 異쒕젰
- `scripts/test_oracle_connection.py` : Oracle ?곌껐 ?뺤씤

---

### 2.5 Deploy (Docker) ?곸꽭

- `deploy/compose/docker-compose.yml`
  - API/UI 而⑦뀒?대꼫 援ъ꽦 諛??ы듃 留ㅽ븨
- `deploy/docker/Dockerfile.api`
  - API ?대?吏 鍮뚮뱶
- `deploy/docker/Dockerfile.ui`
  - UI ?대?吏 鍮뚮뱶

---

### 2.6 var/ ?붾젆?좊━ (?고????곗씠??

- `var/metadata/` : ?ㅽ궎留??덉떆/?⑹뼱吏??쒗뵆由???RAG 臾몄꽌
- `var/cache/` : Demo 罹먯떆
- `var/logs/` : ?ㅽ뻾 濡쒓렇, 鍮꾩슜, ?됯? 寃곌낵 ??
- `var/rag/` : SimpleStore ??μ냼 (Mongo ?ㅼ젙???놁쓣 ???ъ슜)
- `var/mongo/` : Docker Compose MongoDB ?곗씠???붾젆?곕━

> ???붾젆?좊━??**?고????앹꽦 ?곗씠??*媛 留롮쑝誘濡?蹂댄넻 git?먯꽌 ?쒖쇅?⑸땲??

---

## 3) FAQ

**Q. 紐⑤뜽 ?숈뒿? ?대뵒???섎굹??**
- ???꾨줈?앺듃 ?덉뿉???숈뒿? ?섏? ?딆뒿?덈떎. ?몃? LLM(API)???ъ슜?⑸땲??

**Q. ?깅뒫???믪씠?ㅻ㈃ 臾댁뾿??諛붽퓭???섎굹??**
- `var/metadata/sql_examples.jsonl`, `glossary_docs.jsonl`瑜?蹂닿컯?섍퀬
- `sql_postprocess.py`??蹂댁젙 洹쒖튃??異붽??섎뒗 寃껋씠 媛???④낵?곸엯?덈떎.

---

## 4) 李멸퀬 臾몄꽌

- `docs/TECHNICAL.md` : 湲곗닠 臾몄꽌(?댁쁺/援ъ꽦 ?곸꽭)
- `docs/MODEL_GUIDE_KO.md` : 紐⑤뜽 ?ъ슜/?숈뒿 諛⑹떇 ?ㅻ챸??
