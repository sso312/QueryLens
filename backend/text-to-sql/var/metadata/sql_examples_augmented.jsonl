{"question": "Compare ICU mortality rate by gender using ICU-timed death definition", "sql": "SELECT p.GENDER, ROUND(100 * COUNT(DISTINCT CASE WHEN a.DEATHTIME IS NOT NULL AND i.INTIME IS NOT NULL AND i.OUTTIME IS NOT NULL AND a.DEATHTIME BETWEEN i.INTIME AND i.OUTTIME THEN a.HADM_ID END) / NULLIF(COUNT(DISTINCT a.HADM_ID), 0), 2) AS ICU_MORTALITY_RATE_PCT FROM ADMISSIONS a JOIN ICUSTAYS i ON i.HADM_ID = a.HADM_ID AND i.SUBJECT_ID = a.SUBJECT_ID JOIN PATIENTS p ON p.SUBJECT_ID = a.SUBJECT_ID GROUP BY p.GENDER ORDER BY p.GENDER"}
{"question": "Among first ICU stays, compare average lactate in the first 24 hours by in-hospital mortality status", "sql": "WITH first_icu AS ( SELECT i.SUBJECT_ID, i.HADM_ID, i.STAY_ID, i.INTIME, ROW_NUMBER() OVER (PARTITION BY i.SUBJECT_ID ORDER BY i.INTIME) AS RN FROM ICUSTAYS i WHERE i.INTIME IS NOT NULL ), lactate_24h AS ( SELECT f.HADM_ID, AVG(l.VALUENUM) AS AVG_LACTATE_24H FROM first_icu f JOIN LABEVENTS l ON l.HADM_ID = f.HADM_ID AND l.SUBJECT_ID = f.SUBJECT_ID JOIN D_LABITEMS dl ON dl.ITEMID = l.ITEMID WHERE f.RN = 1 AND l.VALUENUM IS NOT NULL AND dl.LABEL = 'Lactate' AND l.CHARTTIME >= f.INTIME AND l.CHARTTIME < f.INTIME + NUMTODSINTERVAL(24, 'HOUR') GROUP BY f.HADM_ID ) SELECT CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 'Deceased' ELSE 'Survived' END AS MORTALITY_STATUS, AVG(x.AVG_LACTATE_24H) AS AVG_LACTATE_24H FROM lactate_24h x JOIN ADMISSIONS a ON a.HADM_ID = x.HADM_ID GROUP BY CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 'Deceased' ELSE 'Survived' END ORDER BY MORTALITY_STATUS"}
{"question": "For ICU stays, compute ICU-timed mortality rate by first careunit", "sql": "SELECT i.FIRST_CAREUNIT, ROUND(100 * COUNT(DISTINCT CASE WHEN a.DEATHTIME IS NOT NULL AND i.INTIME IS NOT NULL AND i.OUTTIME IS NOT NULL AND a.DEATHTIME BETWEEN i.INTIME AND i.OUTTIME THEN a.HADM_ID END) / NULLIF(COUNT(DISTINCT a.HADM_ID), 0), 2) AS ICU_MORTALITY_RATE_PCT FROM ICUSTAYS i JOIN ADMISSIONS a ON a.HADM_ID = i.HADM_ID AND a.SUBJECT_ID = i.SUBJECT_ID WHERE i.FIRST_CAREUNIT IS NOT NULL GROUP BY i.FIRST_CAREUNIT ORDER BY ICU_MORTALITY_RATE_PCT DESC"}
{"question": "Hospital mortality rate by admission type", "sql": "SELECT a.ADMISSION_TYPE, ROUND(100 * AVG(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END), 2) AS HOSPITAL_MORTALITY_RATE_PCT FROM ADMISSIONS a WHERE a.ADMISSION_TYPE IS NOT NULL GROUP BY a.ADMISSION_TYPE ORDER BY HOSPITAL_MORTALITY_RATE_PCT DESC"}
{"question": "Top 20 current services by distinct admissions", "sql": "SELECT * FROM ( SELECT s.CURR_SERVICE, COUNT(DISTINCT s.HADM_ID) AS HADM_CNT FROM SERVICES s WHERE s.CURR_SERVICE IS NOT NULL GROUP BY s.CURR_SERVICE ORDER BY HADM_CNT DESC ) WHERE ROWNUM <= 20"}
{"question": "Average ICU length of stay by first careunit", "sql": "SELECT i.FIRST_CAREUNIT, AVG(CAST(i.OUTTIME AS DATE) - CAST(i.INTIME AS DATE)) AS AVG_ICU_LOS_DAYS FROM ICUSTAYS i WHERE i.INTIME IS NOT NULL AND i.OUTTIME IS NOT NULL AND i.FIRST_CAREUNIT IS NOT NULL GROUP BY i.FIRST_CAREUNIT ORDER BY AVG_ICU_LOS_DAYS DESC"}
{"question": "Monthly trend of emergency admissions", "sql": "SELECT TRUNC(a.ADMITTIME, 'MM') AS ADMIT_MONTH, COUNT(*) AS HADM_CNT FROM ADMISSIONS a WHERE a.ADMISSION_TYPE = 'EMERGENCY' GROUP BY TRUNC(a.ADMITTIME, 'MM') ORDER BY ADMIT_MONTH"}
{"question": "Top 20 diagnosis titles by admission count with ICD version-aware join", "sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(DISTINCT dx.HADM_ID) AS HADM_CNT FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY HADM_CNT DESC ) WHERE ROWNUM <= 20"}
