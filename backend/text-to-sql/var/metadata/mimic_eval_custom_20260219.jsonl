{"question": "ICU 투입 이벤트 총량 상위 10 stay를 보여줘", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 담당 진료과가 내과인 경우만 포함해줘.", "sql": "SELECT a.hadm_id, a.subject_id, s.transfertime, s.curr_service FROM ADMISSIONS a JOIN SERVICES s ON s.hadm_id = a.hadm_id WHERE s.curr_service = 'MED'", "meta": {"lang": "ko", "complexity": "simple", "join_count": 1, "sql_score": 2, "source": "sql_examples.jsonl"}}
{"question": "Top 10 diagnosis titles", "sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "POE 샘플 100건을 보여줘", "sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE POE_ID IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "입원 중 미다졸람 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%midazolam%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 input event items by total amount", "sql": "SELECT * FROM ( SELECT d.LABEL, SUM(e.AMOUNT) AS total_amount FROM INPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.AMOUNT IS NOT NULL GROUP BY d.LABEL ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 심장외과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'CARDS'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "POE order types by count", "sql": "SELECT * FROM ( SELECT ORDER_TYPE, COUNT(*) AS cnt FROM POE WHERE ORDER_TYPE IS NOT NULL GROUP BY ORDER_TYPE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 세프트리악손 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%ceftriaxone%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 charted item labels by frequency", "sql": "SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원(ADMISSIONS) 샘플 100건 보여줘", "sql": "SELECT SUBJECT_ID, HADM_ID FROM ADMISSIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "입원 기간 동안 norepinephrine 총 투여량(amount)을 입원별로 합산해줘.", "sql": "WITH norepi_item AS ( SELECT itemid FROM D_ITEMS WHERE LOWER(label) LIKE '%norepinephrine%' ), stays AS ( SELECT hadm_id, stay_id FROM ICUSTAYS ) SELECT s.hadm_id, SUM(ie.amount) AS norepi_total_amount FROM stays s JOIN INPUTEVENTS ie ON ie.stay_id = s.stay_id JOIN norepi_item ni ON ni.itemid = ie.itemid GROUP BY s.hadm_id", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "loop diuretics(예: furosemide) 사용량 사분위수(Q1-Q4)에 따른 AKI 진단 비율을 비교해줘.", "sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "ko", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "ICU stays by first careunit", "sql": "SELECT * FROM ( SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "퇴원할 때 환자가 어디로 갔는지(퇴원 장소/퇴원 형태)별로 입원 건수를 세고, 많은 순으로 20개 보여줘", "sql": "SELECT a.discharge_location, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.discharge_location ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 기간 전체에서 승압제(노르에피네프린/에피네프린/바소프레신)를 약물 종류별로 각각 총 투여량을 계산해줘.", "sql": "WITH vp_items AS ( SELECT itemid, CASE WHEN LOWER(label) LIKE '%norepinephrine%' THEN 'norepinephrine' WHEN LOWER(label) LIKE '%epinephrine%' THEN 'epinephrine' WHEN LOWER(label) LIKE '%vasopressin%' THEN 'vasopressin' END AS drug FROM D_ITEMS WHERE LOWER(label) LIKE '%norepinephrine%' OR LOWER(label) LIKE '%epinephrine%' OR LOWER(label) LIKE '%vasopressin%' ), stays AS ( SELECT hadm_id, stay_id FROM ICUSTAYS ) SELECT s.hadm_id, v.drug, SUM(ie.amount) AS total_amount FROM stays s JOIN INPUTEVENTS ie ON ie.stay_id = s.stay_id JOIN vp_items v ON v.itemid = ie.itemid GROUP BY s.hadm_id, v.drug", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 8, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 외과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'SURG'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 바소프레신 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%vasopressin%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 반코마이신 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%vancomycin%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "신생아/소아는 제외하고, 성인만 남겨줘.", "sql": "SELECT a.hadm_id, a.subject_id, p.anchor_age FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE p.anchor_age >= 18", "meta": {"lang": "ko", "complexity": "simple", "join_count": 1, "sql_score": 2, "source": "sql_examples.jsonl"}}
{"question": "ICU 첫 병동별 평균 LOS를 보여줘", "sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "Service transition counts", "sql": "SELECT * FROM ( SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "폐암(C34로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'C34%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 헤파린 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%heparin%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원한 환자중에서 언어별로 입원 건수를 세고, 많은 순으로 상위 20개를 보여줘", "sql": "SELECT a.language, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.language ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "같은 입원안에서 중환자실에 두 번 이상 들어간 경우(재입실, 두 번째 stay 이상)인지 플래그로 표시해줘.", "sql": "WITH cnt AS ( SELECT hadm_id, COUNT(*) AS icu_stay_cnt FROM ICUSTAYS GROUP BY hadm_id ) SELECT hadm_id, CASE WHEN icu_stay_cnt >= 2 THEN 1 ELSE 0 END AS icu_readmit_same_hadm_flag FROM cnt", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 4, "source": "sql_examples.jsonl"}}
{"question": "환자(PATIENTS) 샘플 100건 보여줘", "sql": "SELECT SUBJECT_ID, GENDER FROM PATIENTS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "Top 10 microbiology specimen types by count", "sql": "SELECT * FROM ( SELECT SPEC_TYPE_DESC, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE SPEC_TYPE_DESC IS NOT NULL GROUP BY SPEC_TYPE_DESC ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "간경변(K74로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'K74%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Average dose given by administration type", "sql": "SELECT * FROM ( SELECT ADMINISTRATION_TYPE, AVG(DOSE_GIVEN) AS avg_dose FROM EMAR_DETAIL WHERE DOSE_GIVEN IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY avg_dose DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "이뇨제 사용량 사분위수(Q1-Q4)별 AKI 비율을 비교해줘.", "sql": "WITH diuretic_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%spironolactone%' OR LOWER(p.drug) LIKE '%hydrochlorothiazide%' OR LOWER(p.drug) LIKE '%diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM diuretic_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "ko", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "입원 경로 기반으로 응급실에서 들어온 입원만 뽑아줘", "sql": "SELECT hadm_id, subject_id, admittime, admission_location FROM ADMISSIONS WHERE LOWER(admission_location) LIKE '%emergency%'", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "입원 중 프로포폴 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%propofol%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "중환자실 입원 기간별 재실시간을 계산해줘.", "sql": "SELECT stay_id, hadm_id, intime, outtime, (outtime - intime) AS icu_los_interval FROM ICUSTAYS", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "Admissions by insurance type", "sql": "SELECT * FROM ( SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원별 재원일수를 계산해줘.", "sql": "SELECT hadm_id, subject_id, admittime, dischtime, (dischtime - admittime) AS los_interval FROM ADMISSIONS", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "처방 기록에서 항생제 리스트 테이블 만들어줘. drug는 대문자로 통일해줘.", "sql": "WITH abx_flag AS ( SELECT DISTINCT drug, route, CASE WHEN LOWER(drug) LIKE '%vancomycin%' THEN 1 WHEN LOWER(drug) LIKE '%zosyn%' THEN 1 WHEN LOWER(drug) LIKE '%ceftriaxone%' THEN 1 ELSE 0 END AS is_antibiotic FROM prescriptions WHERE drug_type NOT IN ('BASE') AND route NOT IN ('OU','OS','OD','AU','AS','AD','TP') AND LOWER(route) NOT LIKE '%ear%' AND LOWER(route) NOT LIKE '%eye%') SELECT p.subject_id, p.hadm_id, i.stay_id, p.drug AS antibiotic, p.route, p.starttime, p.stoptime FROM prescriptions p JOIN abx_flag f ON p.drug = f.drug AND p.route = f.route LEFT JOIN icustays i ON p.hadm_id = i.hadm_id AND p.starttime >= i.intime AND p.starttime < i.outtime WHERE f.is_antibiotic = 1", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "Top 10 output event items by total value", "sql": "SELECT * FROM ( SELECT d.LABEL, SUM(e.VALUE) AS total_value FROM OUTPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.VALUE IS NOT NULL GROUP BY d.LABEL ORDER BY total_value DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "Lab item counts by category and fluid", "sql": "SELECT * FROM ( SELECT CATEGORY, FLUID, COUNT(*) AS cnt FROM D_LABITEMS WHERE CATEGORY IS NOT NULL GROUP BY CATEGORY, FLUID ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "폐렴(J18으로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'J18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
