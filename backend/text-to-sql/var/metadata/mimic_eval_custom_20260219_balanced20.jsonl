{"question": "각 입원에 대해 30일 내 재입원 여부를 다시 한 번(분석용 라벨로) 만들어줘.", "sql": "SELECT a1.hadm_id, a1.subject_id, CASE WHEN EXISTS ( SELECT 1 FROM ADMISSIONS a2 WHERE a2.subject_id = a1.subject_id AND a2.admittime BETWEEN a1.dischtime AND a1.dischtime + 30 AND a2.hadm_id <> a1.hadm_id ) THEN 1 ELSE 0 END AS readmit_30d_flag FROM ADMISSIONS a1", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 에피네프린 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%epinephrine%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "중환자실에 들어간 성인 환자들에 대해, 해당 입원과 ICU 입실 기록 목록을 뽑아줘.", "sql": "SELECT a.subject_id, a.hadm_id, i.stay_id, p.anchor_age, a.admittime, a.dischtime, i.intime, i.outtime FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id JOIN ICUSTAYS i ON i.hadm_id = a.hadm_id WHERE p.anchor_age >= 18", "meta": {"lang": "ko", "complexity": "medium", "join_count": 2, "sql_score": 4, "source": "sql_examples.jsonl"}}
{"question": "한 입원 안에 중환자실 입원기록이 여러 개면, 그중 첫 번째 중환자실 입원기록만 남겨줘.", "sql": "WITH ranked AS ( SELECT hadm_id, stay_id, intime, outtime, ROW_NUMBER() OVER (PARTITION BY hadm_id ORDER BY intime) AS rn FROM ICUSTAYS ) SELECT hadm_id, stay_id, intime, outtime FROM ranked WHERE rn = 1", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 2, "source": "sql_examples.jsonl"}}
{"question": "중환자실 입원중에 CRRT(지속적 신대체요법/투석) 관련 처치 이벤트가 한 번이라도 있었는지 확인해서 표시해줘.", "sql": "WITH crrt_items AS ( SELECT itemid FROM D_ITEMS WHERE LOWER(label) LIKE '%crrt%' OR LOWER(label) LIKE '%dialysis%' ) SELECT pe.stay_id, MIN(pe.starttime) AS first_crrt_time FROM PROCEDUREEVENTS pe JOIN crrt_items ci ON ci.itemid = pe.itemid GROUP BY pe.stay_id", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "각 입원에 대해 퇴원 후 30일 안에 다시 입원했는지(30일 재입원) 표시해줘.", "sql": "SELECT a1.hadm_id, a1.subject_id, CASE WHEN EXISTS ( SELECT 1 FROM ADMISSIONS a2 WHERE a2.subject_id = a1.subject_id AND a2.admittime BETWEEN a1.dischtime AND a1.dischtime + 30 AND a2.hadm_id <> a1.hadm_id ) THEN 1 ELSE 0 END AS readmit_30d_flag FROM ADMISSIONS a1", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "최종 코호트에서 성별(남/여) 분포를 집계해줘", "sql": "SELECT p.gender, COUNT(DISTINCT a.hadm_id) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY p.gender", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 어떤 진료과가 가장 많이 진료했는지 상위 20개를 보여줘.", "sql": "SELECT s.curr_service, COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id GROUP BY s.curr_service ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "서비스 전환 상위 10개를 보여줘", "sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "병원에 7일 이상 입원했던 케이스만 포함해줘", "sql": "SELECT hadm_id, subject_id, admittime, dischtime FROM ADMISSIONS WHERE dischtime >= admittime + 7", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "검사 항목 상위 10개를 보여줘", "sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중 모르핀 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%morphine%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 유형(응급/예약/기타)별로 입원 건수를 집계해서, 많은 순으로 20개만 보여줘.", "sql": "SELECT a.admission_type, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.admission_type ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "COPD(만성폐쇄성폐질환, J44로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'J44%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 환자 중에 결혼 상태(marital_status)별로 입원 건수가 얼마나 되는지 많은 순으로 알려줘.", "sql": "SELECT a.marital_status, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.marital_status ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "병원에서 어떤 약이 가장 많이 처방(오더)되는지 상위 30개를 보여줘.", "sql": "SELECT p.drug, COUNT(*) AS rx_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id GROUP BY p.drug ORDER BY rx_cnt DESC FETCH FIRST 30 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "나이대(10세 단위)별로 입원 중 사망한 비율(병원 사망률)을 알려줘.", "sql": "SELECT CASE WHEN p.anchor_age IS NULL THEN 'UNKNOWN' ELSE TO_CHAR(FLOOR(p.anchor_age / 10) * 10) || '-' || TO_CHAR(FLOOR(p.anchor_age / 10) * 10 + 9) END AS age_band, COUNT(*) AS hadm_cnt, AVG(a.hospital_expire_flag) AS hosp_mortality_rate FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY CASE WHEN p.anchor_age IS NULL THEN 'UNKNOWN' ELSE TO_CHAR(FLOOR(p.anchor_age / 10) * 10) || '-' || TO_CHAR(FLOOR(p.anchor_age / 10) * 10 + 9) END ORDER BY age_band", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 4, "source": "sql_examples.jsonl"}}
{"question": "퇴원 형태가 어떻게 분포하는지 집계해줘.", "sql": "SELECT discharge_location, COUNT(*) AS hadm_cnt FROM ADMISSIONS GROUP BY discharge_location ORDER BY hadm_cnt DESC", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "보험 종류별로 입원 환자 수가 어떻게 되는지 알려줘. 많은 순으로 20개만 보여줘.", "sql": "SELECT a.insurance, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.insurance ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "연령대(10세 단위)별 입원 건수를 집계해줘.", "sql": "SELECT CASE WHEN p.anchor_age IS NULL THEN 'UNKNOWN' ELSE TO_CHAR(FLOOR(p.anchor_age / 10) * 10) || '-' || TO_CHAR(FLOOR(p.anchor_age / 10) * 10 + 9) END AS age_band, COUNT(DISTINCT a.hadm_id) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY CASE WHEN p.anchor_age IS NULL THEN 'UNKNOWN' ELSE TO_CHAR(FLOOR(p.anchor_age / 10) * 10) || '-' || TO_CHAR(FLOOR(p.anchor_age / 10) * 10 + 9) END ORDER BY hadm_cnt DESC", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 4, "source": "sql_examples.jsonl"}}
