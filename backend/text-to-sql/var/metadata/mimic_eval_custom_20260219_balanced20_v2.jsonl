{"question": "Top 10 diagnosis titles", "sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "Admissions by insurance type", "sql": "SELECT * FROM ( SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "각 입원에 대해 퇴원 후 30일 안에 다시 입원했는지(30일 재입원) 표시해줘.", "sql": "SELECT a1.hadm_id, a1.subject_id, CASE WHEN EXISTS ( SELECT 1 FROM ADMISSIONS a2 WHERE a2.subject_id = a1.subject_id AND a2.admittime BETWEEN a1.dischtime AND a1.dischtime + 30 AND a2.hadm_id <> a1.hadm_id ) THEN 1 ELSE 0 END AS readmit_30d_flag FROM ADMISSIONS a1", "meta": {"lang": "ko", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "병원에서 어떤 약이 가장 많이 처방(오더)되는지 상위 30개를 보여줘.", "sql": "SELECT p.drug, COUNT(*) AS rx_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id GROUP BY p.drug ORDER BY rx_cnt DESC FETCH FIRST 30 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 stays by total output value", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원별 재원일수를 계산해줘.", "sql": "SELECT hadm_id, subject_id, admittime, dischtime, (dischtime - admittime) AS los_interval FROM ADMISSIONS", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "Lab item counts by category and fluid", "sql": "SELECT * FROM ( SELECT CATEGORY, FLUID, COUNT(*) AS cnt FROM D_LABITEMS WHERE CATEGORY IS NOT NULL GROUP BY CATEGORY, FLUID ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "혈액투석 catheter 삽입 건수를 연도별로 보여줘.", "sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "ICU 첫 병동별 평균 LOS를 보여줘", "sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "입원 중 병동 이동이 총 몇 번 있었는지 입원별로 계산해줘.", "sql": "SELECT hadm_id, COUNT(*) AS transfer_cnt FROM TRANSFERS GROUP BY hadm_id", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "Top 10 input event items by total amount", "sql": "SELECT * FROM ( SELECT d.LABEL, SUM(e.AMOUNT) AS total_amount FROM INPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.AMOUNT IS NOT NULL GROUP BY d.LABEL ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 산부인과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'GYN'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "만성 신부전(N18로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'N18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Medication administrations with dose given", "sql": "SELECT e.MEDICATION, d.DOSE_GIVEN, d.DOSE_GIVEN_UNIT FROM EMAR e JOIN EMAR_DETAIL d ON e.SUBJECT_ID = d.SUBJECT_ID AND e.EMAR_ID = d.EMAR_ID AND e.EMAR_SEQ = d.EMAR_SEQ WHERE e.MEDICATION IS NOT NULL AND d.DOSE_GIVEN IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "en", "complexity": "simple", "join_count": 1, "sql_score": 2, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 외과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'SURG'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "EMAR 샘플 100건을 보여줘", "sql": "SELECT SUBJECT_ID, HADM_ID FROM EMAR WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "Compare AKI diagnosis rate by quartile (Q1-Q4) of loop diuretics usage, such as furosemide.", "sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "en", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "퇴원할 때 환자가 어디로 갔는지(퇴원 장소/퇴원 형태)별로 입원 건수를 세고, 많은 순으로 20개 보여줘", "sql": "SELECT a.discharge_location, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.discharge_location ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 기간 동안 norepinephrine 총 투여량(amount)을 입원별로 합산해줘.", "sql": "WITH norepi_item AS ( SELECT itemid FROM D_ITEMS WHERE LOWER(label) LIKE '%norepinephrine%' ), stays AS ( SELECT hadm_id, stay_id FROM ICUSTAYS ) SELECT s.hadm_id, SUM(ie.amount) AS norepi_total_amount FROM stays s JOIN INPUTEVENTS ie ON ie.stay_id = s.stay_id JOIN norepi_item ni ON ni.itemid = ie.itemid GROUP BY s.hadm_id", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "진단 코드가 어떤 체계(버전)로 기록됐는지(예: ICD-9/ICD-10) 비중을 알려줘.", "sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
