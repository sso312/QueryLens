{"question": "Compare AKI diagnosis rate by quartile (Q1-Q4) of loop diuretics usage, such as furosemide.", "sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "en", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "ICU 첫 병동별 건수를 보여줘", "sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "Top 10 stays by total output value", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Count medication administrations by medication name", "sql": "SELECT * FROM ( SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 procedure titles", "sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
