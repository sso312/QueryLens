{"question": "성인 환자만 대상으로 해서, 환자마다 첫 번째 입원 기록만 남겨서 코호트를 만들어줘.", "sql": "WITH first_admit AS ( SELECT subject_id, MIN(admittime) AS first_admittime FROM ADMISSIONS GROUP BY subject_id ) SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, p.anchor_age FROM ADMISSIONS a JOIN first_admit f ON f.subject_id = a.subject_id AND f.first_admittime = a.admittime JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE p.anchor_age >= 18", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "Top 10 stays by total input amount", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 푸로세미드 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%furosemide%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "혈액투석 catheter 삽입 건수를 연도별로 보여줘.", "sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "만성 신부전(N18로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'N18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
