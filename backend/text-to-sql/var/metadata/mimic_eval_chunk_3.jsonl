{"question": "Count diagnoses by ICD version", "sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC"}
{"question": "Top 10 diagnosis codes by count", "sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Top 10 diagnosis titles by count", "sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Count procedures by ICD version", "sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC"}
{"question": "Top 10 procedure codes by count", "sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Top 10 procedure titles by count", "sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10"}
{"question": "Average number of diagnoses per admission", "sql": "SELECT AVG(diag_cnt) AS avg_diag FROM (SELECT HADM_ID, COUNT(*) AS diag_cnt FROM DIAGNOSES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE diag_cnt IS NOT NULL"}
{"question": "Average number of procedures per admission", "sql": "SELECT AVG(proc_cnt) AS avg_proc FROM (SELECT HADM_ID, COUNT(*) AS proc_cnt FROM PROCEDURES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE proc_cnt IS NOT NULL"}
{"question": "Count admissions with any diagnosis code", "sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN DIAGNOSES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL"}
{"question": "Count admissions with any procedure code", "sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN PROCEDURES_ICD p ON a.SUBJECT_ID = p.SUBJECT_ID AND a.HADM_ID = p.HADM_ID WHERE p.ICD_CODE IS NOT NULL"}
{"question": "Count admissions by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Average anchor age by admission type", "sql": "SELECT a.ADMISSION_TYPE, AVG(p.ANCHOR_AGE) AS avg_age FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE a.ADMISSION_TYPE IS NOT NULL AND p.ANCHOR_AGE IS NOT NULL GROUP BY a.ADMISSION_TYPE"}
{"question": "Count ICU stays by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM ICUSTAYS i JOIN PATIENTS p ON i.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count lab events by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM LABEVENTS l JOIN PATIENTS p ON l.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count chart events by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN PATIENTS p ON c.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count prescriptions by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM PRESCRIPTIONS r JOIN PATIENTS p ON r.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count procedures by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN PATIENTS p ON pr.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count diagnoses by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN PATIENTS p ON dx.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count transfers by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM TRANSFERS t JOIN PATIENTS p ON t.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
{"question": "Count services by gender", "sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM SERVICES s JOIN PATIENTS p ON s.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC"}
