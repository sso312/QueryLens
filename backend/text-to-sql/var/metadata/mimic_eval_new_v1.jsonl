{"question": "Transfer counts by care unit", "sql": "SELECT * FROM ( SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원별로 병원 내 사망 여부를 뽑아줘.", "sql": "SELECT hadm_id, subject_id, hospital_expire_flag FROM ADMISSIONS", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "진단 코드가 어떤 체계(버전)로 기록됐는지(예: ICD-9/ICD-10) 비중을 알려줘.", "sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 처방(prescriptions)에서 특정 항생제(예: piperacillin-tazobactam)가 몇 번 주문됐는지 입원별로 세어줘.", "sql": "SELECT hadm_id, COUNT(*) AS rx_order_cnt FROM PRESCRIPTIONS WHERE LOWER(drug) LIKE '%piperacillin%tazobactam%' GROUP BY hadm_id", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "Show yearly counts of hemodialysis catheter insertion events.", "sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "meta": {"lang": "en", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "입원 중 노르에피네프린 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%norepinephrine%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 내과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'MED'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "푸로세미드 사용량 사분위수(Q1-Q4)별 병원 사망률을 비교해줘.", "sql": "WITH drug_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND LOWER(p.drug) LIKE '%furosemide%' GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM drug_rx ), adm AS ( SELECT hadm_id, hospital_expire_flag FROM ADMISSIONS WHERE hadm_id IS NOT NULL ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) AS n_death_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS hospital_mortality_rate_pct FROM dose_q q JOIN adm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "ko", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "Compare AKI diagnosis rate by quartile (Q1-Q4) of loop diuretics usage, such as furosemide.", "sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "meta": {"lang": "en", "complexity": "hard", "join_count": 1, "sql_score": 6, "source": "sql_examples.jsonl"}}
{"question": "ICU 첫 병동별 건수를 보여줘", "sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "Top 10 stays by total output value", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Count medication administrations by medication name", "sql": "SELECT * FROM ( SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 procedure titles", "sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 이비인후과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'ENT'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중에 신경과를 거친 입원이 총 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'NEURO'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "환자가 어디에서/어떤 경로로 입원했는지(입원 경로)별로 입원 건수를 세고, 많은 순으로 20개 보여줘", "sql": "SELECT a.admission_location, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.admission_location ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "Top 10 lab test labels by frequency", "sql": "SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 1, "sql_score": 5, "source": "sql_examples.jsonl"}}
{"question": "입원 중 병동 이동이 총 몇 번 있었는지 입원별로 계산해줘.", "sql": "SELECT hadm_id, COUNT(*) AS transfer_cnt FROM TRANSFERS GROUP BY hadm_id", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 1, "source": "sql_examples.jsonl"}}
{"question": "특정 진단코드가 있는 입원만 골라서 코호트를 만들고 싶어(예: I50% 심부전).", "sql": "SELECT DISTINCT d.hadm_id, d.subject_id, d.icd_code, d.icd_version FROM DIAGNOSES_ICD d WHERE d.icd_code LIKE 'I50%'", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "Medication administrations with dose given", "sql": "SELECT e.MEDICATION, d.DOSE_GIVEN, d.DOSE_GIVEN_UNIT FROM EMAR e JOIN EMAR_DETAIL d ON e.SUBJECT_ID = d.SUBJECT_ID AND e.EMAR_ID = d.EMAR_ID AND e.EMAR_SEQ = d.EMAR_SEQ WHERE e.MEDICATION IS NOT NULL AND d.DOSE_GIVEN IS NOT NULL AND ROWNUM <= 100", "meta": {"lang": "en", "complexity": "simple", "join_count": 1, "sql_score": 2, "source": "sql_examples.jsonl"}}
{"question": "입원 중 사망한 환자는 사망 시점(deathtime)도 같이 포함해서 뽑아줘.", "sql": "SELECT hadm_id, subject_id, hospital_expire_flag, deathtime FROM ADMISSIONS WHERE hospital_expire_flag = 1", "meta": {"lang": "ko", "complexity": "simple", "join_count": 0, "sql_score": 0, "source": "sql_examples.jsonl"}}
{"question": "입원 유형(응급/예약/긴급 등)별로 병원 사망률이 어떻게 다른지 알려줘.", "sql": "SELECT a.admission_type, COUNT(*) AS hadm_cnt, AVG(a.hospital_expire_flag) AS hosp_mortality_rate FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.admission_type ORDER BY hosp_mortality_rate DESC FETCH FIRST 20 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "중환자실 입원 기간동안 norepinephrine이 언제부터 언제까지 어떤 속도로 들어갔는지(시작/종료/속도) 타임라인 형태로 보여줘.", "sql": "WITH norepi_item AS ( SELECT itemid FROM D_ITEMS WHERE LOWER(label) LIKE '%norepinephrine%' ) SELECT ie.stay_id, ie.starttime, ie.endtime, ie.rate, ie.rateuom FROM INPUTEVENTS ie JOIN norepi_item ni ON ni.itemid = ie.itemid WHERE ie.rate IS NOT NULL ORDER BY ie.stay_id, ie.starttime", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 4, "source": "sql_examples.jsonl"}}
{"question": "성인 환자만 대상으로 해서, 환자마다 첫 번째 입원 기록만 남겨서 코호트를 만들어줘.", "sql": "WITH first_admit AS ( SELECT subject_id, MIN(admittime) AS first_admittime FROM ADMISSIONS GROUP BY subject_id ) SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, p.anchor_age FROM ADMISSIONS a JOIN first_admit f ON f.subject_id = a.subject_id AND f.first_admittime = a.admittime JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE p.anchor_age >= 18", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "Top 10 stays by total input amount", "sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "meta": {"lang": "en", "complexity": "medium", "join_count": 0, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "입원 중 푸로세미드 처방이 있었던 입원이 몇 건인지 알려줘.", "sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%furosemide%'", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
{"question": "혈액투석 catheter 삽입 건수를 연도별로 보여줘.", "sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "meta": {"lang": "ko", "complexity": "hard", "join_count": 2, "sql_score": 7, "source": "sql_examples.jsonl"}}
{"question": "만성 신부전(N18로 시작) 진단이 있는 입원이 월별로 얼마나 있었는지 알려줘.", "sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'N18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "meta": {"lang": "ko", "complexity": "medium", "join_count": 1, "sql_score": 3, "source": "sql_examples.jsonl"}}
