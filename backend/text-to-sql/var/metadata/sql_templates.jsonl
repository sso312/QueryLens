{"name": "template_hospital_los_days", "sql": "SELECT a.HADM_ID, a.SUBJECT_ID, CAST(a.DISCHTIME AS DATE) - CAST(a.ADMITTIME AS DATE) AS HOSPITAL_LOS_DAYS FROM ADMISSIONS a WHERE a.ADMITTIME IS NOT NULL AND a.DISCHTIME IS NOT NULL AND ROWNUM <= 2000"}
{"name": "template_readmission_30d_flag", "sql": "SELECT a1.HADM_ID, a1.SUBJECT_ID, CASE WHEN EXISTS ( SELECT 1 FROM ADMISSIONS a2 WHERE a2.SUBJECT_ID = a1.SUBJECT_ID AND a2.ADMITTIME BETWEEN a1.DISCHTIME AND a1.DISCHTIME + 30 AND a2.HADM_ID <> a1.HADM_ID ) THEN 1 ELSE 0 END AS READMIT_30D_FLAG FROM ADMISSIONS a1 WHERE a1.DISCHTIME IS NOT NULL AND ROWNUM <= 5000"}
{"name": "template_in_hospital_mortality_flag", "sql": "SELECT a.HADM_ID, a.SUBJECT_ID, a.HOSPITAL_EXPIRE_FLAG FROM ADMISSIONS a WHERE a.HADM_ID IS NOT NULL AND ROWNUM <= 5000"}
{"name": "template_in_hospital_mortality_rate", "sql": "SELECT ROUND(100 * AVG(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END), 2) AS MORTALITY_RATE_PCT FROM ADMISSIONS a WHERE a.HADM_ID IS NOT NULL"}
{"name": "template_icu_los_days", "sql": "SELECT i.STAY_ID, i.HADM_ID, i.SUBJECT_ID, CAST(i.OUTTIME AS DATE) - CAST(i.INTIME AS DATE) AS ICU_LOS_DAYS FROM ICUSTAYS i WHERE i.INTIME IS NOT NULL AND i.OUTTIME IS NOT NULL AND ROWNUM <= 5000"}
{"name": "template_icu_mortality_rate_deathtime", "sql": "SELECT ROUND(100 * COUNT(DISTINCT CASE WHEN a.DEATHTIME IS NOT NULL AND i.INTIME IS NOT NULL AND i.OUTTIME IS NOT NULL AND a.DEATHTIME BETWEEN i.INTIME AND i.OUTTIME THEN a.HADM_ID END) / NULLIF(COUNT(DISTINCT a.HADM_ID), 0), 2) AS ICU_MORTALITY_RATE_PCT FROM ADMISSIONS a JOIN ICUSTAYS i ON i.HADM_ID = a.HADM_ID AND i.SUBJECT_ID = a.SUBJECT_ID WHERE i.HADM_ID IS NOT NULL"}
{"name": "template_icu_readmit_same_hadm_flag", "sql": "WITH cnt AS ( SELECT i.HADM_ID, COUNT(*) AS ICU_STAY_CNT FROM ICUSTAYS i WHERE i.HADM_ID IS NOT NULL GROUP BY i.HADM_ID ) SELECT c.HADM_ID, CASE WHEN c.ICU_STAY_CNT >= 2 THEN 1 ELSE 0 END AS ICU_READMIT_SAME_HADM_FLAG FROM cnt c WHERE c.HADM_ID IS NOT NULL"}
{"name": "template_transfer_count_per_admission", "sql": "SELECT t.HADM_ID, COUNT(*) AS TRANSFER_CNT FROM TRANSFERS t WHERE t.HADM_ID IS NOT NULL GROUP BY t.HADM_ID ORDER BY TRANSFER_CNT DESC"}
{"name": "template_discharge_location_distribution", "sql": "SELECT a.DISCHARGE_LOCATION, COUNT(*) AS HADM_CNT FROM ADMISSIONS a WHERE a.DISCHARGE_LOCATION IS NOT NULL GROUP BY a.DISCHARGE_LOCATION ORDER BY HADM_CNT DESC"}
