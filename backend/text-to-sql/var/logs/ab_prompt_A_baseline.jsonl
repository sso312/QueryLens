{"idx": 1, "question": "Count patients by gender", "expected_sql": "SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY cnt DESC", "generated_sql": "SELECT GENDER, COUNT(SUBJECT_ID) AS patient_count FROM PATIENTS WHERE SUBJECT_ID IS NOT NULL GROUP BY GENDER", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}, "status": "mismatch"}
{"idx": 2, "question": "Average anchor age by gender", "expected_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "generated_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "expected_error": null, "generated_error": null, "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}, "status": "match"}
{"idx": 3, "question": "Count patients by anchor year group", "expected_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "generated_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(SUBJECT_ID) AS patient_count FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY patient_count DESC", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 5, "generated_row_count": 5}, "status": "mismatch"}
{"idx": 4, "question": "Count admissions by admission type", "expected_sql": "SELECT ADMISSION_TYPE, COUNT(*) AS cnt FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY cnt DESC", "generated_sql": "SELECT ADMISSION_TYPE, COUNT(HADM_ID) AS ADMISSION_COUNT FROM ADMISSIONS WHERE 1=1 GROUP BY ADMISSION_TYPE", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 9, "generated_row_count": 9}, "status": "mismatch"}
{"idx": 5, "question": "Count admissions by insurance", "expected_sql": "SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC", "generated_sql": "SELECT INSURANCE, COUNT(HADM_ID) AS admission_count FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY admission_count DESC", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 5, "generated_row_count": 5}, "status": "mismatch"}
{"idx": 6, "question": "Count admissions by race", "expected_sql": "SELECT RACE, COUNT(*) AS cnt FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY cnt DESC", "generated_sql": "SELECT RACE, COUNT(HADM_ID) AS ADMISSION_COUNT FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 33, "generated_row_count": 33}, "status": "mismatch"}
{"idx": 7, "question": "Count admissions by marital status", "expected_sql": "SELECT MARITAL_STATUS, COUNT(*) AS cnt FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY cnt DESC", "generated_sql": "SELECT a.MARITAL_STATUS, COUNT(a.HADM_ID) AS ADMISSION_COUNT FROM ADMISSIONS a WHERE a.MARITAL_STATUS IS NOT NULL GROUP BY a.MARITAL_STATUS ORDER BY ADMISSION_COUNT DESC", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}, "status": "mismatch"}
{"idx": 8, "question": "Count admissions with hospital expire flag", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1", "generated_sql": "SELECT COUNT(a.HADM_ID) AS admission_count FROM ADMISSIONS a WHERE a.HOSPITAL_EXPIRE_FLAG = 1", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}, "status": "mismatch"}
{"idx": 9, "question": "Count admissions with ED registration time", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS admission_count FROM ADMISSIONS A WHERE A.EDREGTIME IS NOT NULL AND A.ADMITTIME >= :start_date AND A.ADMITTIME < :end_date", "expected_error": null, "generated_error": "ORA-01008: value for bind variable placeholder :START_DATE (position 1) was not provided\nHelp: https://docs.oracle.com/error-help/db/ora-01008/", "status": "exec_error"}
{"idx": 10, "question": "Average admission length of stay in days", "expected_sql": "SELECT AVG(DISCHTIME - ADMITTIME) AS avg_los_days FROM ADMISSIONS WHERE DISCHTIME IS NOT NULL AND ADMITTIME IS NOT NULL", "generated_sql": "SELECT AVG(CAST(a.DISCHTIME AS DATE) - CAST(a.ADMITTIME AS DATE)) AS avg_los_days FROM ADMISSIONS a WHERE a.ADMITTIME IS NOT NULL AND a.DISCHTIME IS NOT NULL", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": null, "status": "exec_error"}
{"idx": 11, "question": "Count ICU stays by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS STAY_COUNT FROM ICUSTAYS WHERE ROWNUM <= 100 GROUP BY FIRST_CAREUNIT", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 16, "generated_row_count": 8}, "status": "mismatch"}
{"idx": 12, "question": "Average ICU LOS by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "generated_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "expected_error": null, "generated_error": null, "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 16, "generated_row_count": 16}, "status": "match"}
{"idx": 13, "question": "Count ICU stays by last careunit", "expected_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS ICU_STAY_COUNT FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY ICU_STAY_COUNT DESC", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 16, "generated_row_count": 16}, "status": "mismatch"}
{"idx": 14, "question": "Count ICU stays with LOS >= 1 day", "expected_sql": "SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE LOS >= 1", "generated_sql": "SELECT COUNT(*) AS icu_stay_count FROM ICUSTAYS WHERE LOS >= 1", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}, "status": "mismatch"}
{"idx": 15, "question": "Count transfers by careunit", "expected_sql": "SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT CAREUNIT, COUNT(*) AS TRANSFER_COUNT FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT", "expected_error": null, "generated_error": null, "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 46, "generated_row_count": 46}, "status": "mismatch"}
