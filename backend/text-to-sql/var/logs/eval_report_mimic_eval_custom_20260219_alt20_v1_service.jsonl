{"idx": 1, "question": "ì…ì› í™˜ì ì¤‘ì— ê²°í˜¼ ìƒíƒœ(marital_status)ë³„ë¡œ ì…ì› ê±´ìˆ˜ê°€ ì–¼ë§ˆë‚˜ ë˜ëŠ”ì§€ ë§ì€ ìˆœìœ¼ë¡œ ì•Œë ¤ì¤˜.", "status": "match", "generated_sql": "SELECT a.marital_status, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.marital_status ORDER BY CNT DESC", "expected_sql": "SELECT a.marital_status, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.marital_status ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 5, "generated_row_count": 5}}
{"idx": 2, "question": "ë³´í—˜ ì¢…ë¥˜ë³„ë¡œ ì…ì› í™˜ì ìˆ˜ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì•Œë ¤ì¤˜. ë§ì€ ìˆœìœ¼ë¡œ 20ê°œë§Œ ë³´ì—¬ì¤˜.", "status": "match", "generated_sql": "SELECT a.insurance, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.insurance ORDER BY CNT DESC", "expected_sql": "SELECT a.insurance, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.insurance ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 6, "generated_row_count": 6}}
{"idx": 3, "question": "Top 10 stays by total input amount", "status": "match", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC )) WHERE ROWNUM <= 10", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 4, "question": "ì‹œìˆ  ìƒìœ„ 10ê°œë¥¼ ë³´ì—¬ì¤˜", "status": "match", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "expected_sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 5, "question": "ì²˜ë°©(PRESCRIPTIONS) ìƒ˜í”Œ 100ê±´ì„ ë³´ì—¬ì¤˜", "status": "mismatch", "generated_sql": "SELECT SUBJECT_ID, HADM_ID, DRUG, STARTTIME, STOPTIME FROM PRESCRIPTIONS WHERE ROWNUM <= 100", "expected_sql": "SELECT SUBJECT_ID, HADM_ID FROM PRESCRIPTIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 100, "generated_row_count": 100}}
{"idx": 6, "question": "Top 10 lab test labels by frequency", "status": "expected_exec_error", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/"}
{"idx": 7, "question": "ì§„ë‹¨ ì½”ë“œê°€ ì–´ë–¤ ì²´ê³„(ë²„ì „)ë¡œ ê¸°ë¡ëëŠ”ì§€(ì˜ˆ: ICD-9/ICD-10) ë¹„ì¤‘ì„ ì•Œë ¤ì¤˜.", "status": "mismatch", "generated_sql": "SELECT p.icd_version, COUNT(*) AS CNT FROM PROCEDURES_ICD p GROUP BY p.icd_version ORDER BY CNT DESC", "expected_sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 8, "question": "Top 10 chart event labels by count", "status": "expected_exec_error", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/"}
{"idx": 9, "question": "ê·ì¢…(organism) ìƒìœ„ 10ê°œë¥¼ ë³´ì—¬ì¤˜", "status": "no_generated_sql", "generated_sql": ""}
{"idx": 10, "question": "ê¸´ê¸‰ ì…ì›í•œ í™˜ì ìˆ˜ê°€ ì›”ë³„ë¡œ ì–´ë–»ê²Œ ë³€í–ˆëŠ”ì§€ ì•Œë ¤ì¤˜.", "status": "mismatch", "generated_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS CNT FROM ADMISSIONS a WHERE a.admission_type = 'URGENT' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month", "expected_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE a.admission_type = 'URGENT' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 120, "generated_row_count": 1164}}
{"idx": 11, "question": "ì…ì› ì¤‘ ì–´ë–¤ ì§„ë£Œê³¼ê°€ ê°€ì¥ ë§ì´ ì§„ë£Œí–ˆëŠ”ì§€ ìƒìœ„ 20ê°œë¥¼ ë³´ì—¬ì¤˜.", "status": "mismatch", "generated_sql": "SELECT * FROM (SELECT s.curr_service, COUNT(*) AS CNT FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id GROUP BY s.curr_service ORDER BY CNT DESC) WHERE ROWNUM <= 20", "expected_sql": "SELECT s.curr_service, COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id GROUP BY s.curr_service ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 19, "generated_row_count": 19}}
{"idx": 12, "question": "ì‘ê¸‰ìœ¼ë¡œ ì…ì›í•œ í™˜ì ìˆ˜ê°€ ì›”ë³„ë¡œ ì–´ë–»ê²Œ ë³€í–ˆëŠ”ì§€ ì•Œë ¤ì¤˜.", "status": "match", "generated_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS CNT FROM ADMISSIONS a WHERE a.admission_type = 'EMERGENCY' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month", "expected_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE a.admission_type = 'EMERGENCY' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 0, "generated_row_count": 0}}
{"idx": 13, "question": "ICU stays by first careunit", "status": "mismatch", "generated_sql": "SELECT CAREUNIT AS FIRST_CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE EVENTTYPE = 'admit' AND CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC", "expected_sql": "SELECT * FROM ( SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "compare": {"same_cols": true, "same_rows": false, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 45}}
{"idx": 14, "question": "ê²€ì‚¬ í{"idx": 15, "question": "Top 10 microbiology tests by count", "status": "match", "generated_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 16, "question": "ì¸ì¢…/ë¯¼ì¡±ë³„ë¡œ ì…ì› í™˜ì ìˆ˜ë¥¼ ì„¸ì–´ì„œ, ë§ì€ ìˆœìœ¼ë¡œ 30ê°œë§Œ ë³´ì—¬ì¤˜.", "status": "mismatch", "generated_sql": "SELECT a.race, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.race ORDER BY CNT DESC", "expected_sql": "SELECT a.race, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.race ORDER BY hadm_cnt DESC FETCH FIRST 30 ROWS ONLY", "compare": {"same_cols": false, "same_rows": false, {"idx": 16, "question": "ì¸ì¢…/ë¯¼ì¡±ë³„ë¡œ ì…ì› í™˜ì ìˆ˜ë¥¼ ì„¸ì–´ì„œ, ë§ì€ ìˆœìœ¼ë¡œ 30ê°œë§Œ ë³´ì—¬ì¤˜.", "status": "mismatch", "generated_sql": "SELECT a.race, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.race ORDER BY CNT DESC", "expected_sql": "SELECT a.race, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.race ORDER BY hadm_cnt DESC FETCH FIRST 30 ROWS ONLY", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 30, "generated_row_count": 33}}
{"idx": 17, "question": "Top 10 output event items by total value", "status": "mismatch", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT ITEMID, SUM(VALUE) AS total_value FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY ITEMID ORDER BY total_value DESC )) WHERE ROWNUM <= 10", "expected_sql": "SELECT * FROM ( SELECT d.LABEL, SUM(e.VALUE) AS total_value FROM OUTPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.VALUE IS NOT NULL GROUP BY d.LABEL ORDER BY total_value DESC ) WHERE ROWNUM <= 10", "compare": {"same_cols": false, "same_rows": false, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 18, "question": "POE ìƒ˜í”Œ 100ê±´ì„ ë³´ì—¬ì¤˜", "status": "match", "generated_sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE ROWNUM <= 100", "expected_sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE POE_ID IS NOT NULL AND ROWNUM <= 100", "compare": {"same_cols": true, "same_rows": true, "subset_rows": false, "expected_row_count": 100, "generated_row_count": 100}}
{"idx": 19, "question": "Top 10 charted item labels by frequency", "status": "expected_exec_error", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/"}
{"idx": 20, "question": "Average dose given by administration type", "status": "expected_exec_error", "generated_sql": "SELECT ADMINISTRATION_TYPE, AVG(CAST(DOSE_GIVEN AS NUMBER)) AS avg_dose FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL AND DOSE_GIVEN IS NOT NULL GROUP BY ADMINISTRATION_TYPE", "error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/"}
