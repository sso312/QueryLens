{"idx": 1, "question": "Compare AKI diagnosis rate by quartile (Q1-Q4) of loop diuretics usage, such as furosemide.", "expected_sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "generated_sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}}
{"idx": 2, "question": "ICU \uccab \ubcd1\ub3d9\ubcc4 \uac74\uc218\ub97c \ubcf4\uc5ec\uc918", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 16, "generated_row_count": 16}}
{"idx": 3, "question": "Top 10 stays by total output value", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 4, "question": "Count medication administrations by medication name", "expected_sql": "SELECT * FROM ( SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM ( SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "status": "exec_error"}
{"idx": 5, "question": "Top 10 procedure titles", "expected_sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
