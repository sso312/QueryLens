idx,question,status,expected_sql,generated_sql,expected_error,generated_error,same_cols,same_rows,expected_row_count,generated_row_count
1,Count patients by gender,match,"SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY cnt DESC","SELECT GENDER, COUNT(SUBJECT_ID) AS CNT FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY CNT DESC",,,True,True,2,2
2,Average anchor age by gender,match,"SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER","SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE ANCHOR_AGE IS NOT NULL AND GENDER IS NOT NULL GROUP BY GENDER",,,True,True,2,2
3,Count patients by anchor year group,match,"SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC","SELECT ANCHOR_YEAR_GROUP, COUNT(SUBJECT_ID) AS CNT FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY CNT DESC",,,True,True,5,5
4,Count admissions by admission type,match,"SELECT ADMISSION_TYPE, COUNT(*) AS cnt FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY cnt DESC","SELECT ADMISSION_TYPE, COUNT(*) AS CNT FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY CNT DESC",,,True,True,9,9
5,Count admissions by insurance,match,"SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC","SELECT INSURANCE, COUNT(*) AS CNT FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY CNT DESC",,,True,True,5,5
6,Count admissions by race,match,"SELECT RACE, COUNT(*) AS cnt FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY cnt DESC","SELECT RACE, COUNT(*) AS CNT FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY CNT DESC",,,True,True,33,33
7,Count admissions by marital status,match,"SELECT MARITAL_STATUS, COUNT(*) AS cnt FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY cnt DESC","SELECT MARITAL_STATUS, COUNT(*) AS CNT FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY CNT DESC",,,True,True,4,4
8,Count admissions with hospital expire flag,match,SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1,SELECT COUNT(*) AS CNT FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1,,,True,True,1,1
9,Count admissions with ED registration time,match,SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL,SELECT COUNT(*) AS CNT FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL,,,True,True,1,1
10,Average admission length of stay in days,expected_exec_error,SELECT AVG(DISCHTIME - ADMITTIME) AS avg_los_days FROM ADMISSIONS WHERE DISCHTIME IS NOT NULL AND ADMITTIME IS NOT NULL,SELECT AVG((CAST(DISCHTIME AS DATE) - CAST(ADMITTIME AS DATE)) * 24) AS avg_los_days FROM ADMISSIONS,"ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND
Help: https://docs.oracle.com/error-help/db/ora-00932/",,,,,
11,Count ICU stays by first careunit,match,"SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC","SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC",,,True,True,16,16
12,Average ICU LOS by first careunit,match,"SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT","SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT",,,True,True,16,16
13,Count ICU stays by last careunit,match,"SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC","SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC",,,True,True,16,16
14,Count ICU stays with LOS >= 1 day,match,SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE LOS >= 1,SELECT COUNT(*) AS CNT FROM ICUSTAYS WHERE LOS >= 1,,,True,True,1,1
15,Count transfers by careunit,match,"SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC","SELECT CAREUNIT, COUNT(*) AS CNT FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY CNT DESC",,,True,True,46,46
16,Count transfers by event type,match,"SELECT EVENTTYPE, COUNT(*) AS cnt FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY cnt DESC","SELECT EVENTTYPE, COUNT(*) AS CNT FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY CNT DESC",,,True,True,4,4
17,Average transfer duration in days,expected_exec_error,SELECT AVG(OUTTIME - INTIME) AS avg_transfer_days FROM TRANSFERS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL,SELECT AVG((CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) * 24) / 24 AS avg_transfer_duration_days FROM TRANSFERS WHERE INTIME IS NOT NULL AND OUTTIME IS NOT NULL,"ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND
Help: https://docs.oracle.com/error-help/db/ora-00932/",,,,,
18,Count services by current service,match,"SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC","SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC",,,True,True,21,21
19,Top 10 service transitions by count,match,"SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
20,Count admissions with an ICU stay,mismatch,SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL,SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE A.HADM_ID IS NOT NULL,,,True,False,1,1
