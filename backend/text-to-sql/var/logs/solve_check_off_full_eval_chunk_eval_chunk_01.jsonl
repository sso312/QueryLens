{"idx": 1, "question": "\uc785\uc6d0 \uc911 \ub178\ub974\uc5d0\ud53c\ub124\ud504\ub9b0 \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%norepinephrine%'", "generated_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%norepinephrine%'", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 2, "question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 3, "question": "\uc785\uc6d0 \uc911\uc5d0 \ub0b4\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'MED'", "generated_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'MED'", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 4, "question": "\ud478\ub85c\uc138\ubbf8\ub4dc \uc0ac\uc6a9\ub7c9 \uc0ac\ubd84\uc704\uc218(Q1-Q4)\ubcc4 \ubcd1\uc6d0 \uc0ac\ub9dd\ub960\uc744 \ube44\uad50\ud574\uc918.", "expected_sql": "WITH drug_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND LOWER(p.drug) LIKE '%furosemide%' GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM drug_rx ), adm AS ( SELECT hadm_id, hospital_expire_flag FROM ADMISSIONS WHERE hadm_id IS NOT NULL ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) AS n_death_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS hospital_mortality_rate_pct FROM dose_q q JOIN adm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "generated_sql": "WITH drug_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND LOWER(p.drug) LIKE '%furosemide%' GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM drug_rx ), adm AS ( SELECT hadm_id, hospital_expire_flag FROM ADMISSIONS WHERE hadm_id IS NOT NULL ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) AS n_death_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS hospital_mortality_rate_pct FROM dose_q q JOIN adm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}}
{"idx": 5, "question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
