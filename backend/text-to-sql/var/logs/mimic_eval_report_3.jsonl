{"idx": 1, "question": "Count diagnoses by ICD version", "expected_sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC", "generated_sql_initial": "SELECT d.ICD_VERSION, COUNT(*) AS CNT FROM DIAGNOSES_ICD d WHERE d.ICD_VERSION IS NOT NULL GROUP BY d.ICD_VERSION ORDER BY CNT DESC", "generated_sql": "SELECT d.ICD_VERSION, COUNT(*) AS CNT FROM DIAGNOSES_ICD d WHERE d.ICD_VERSION IS NOT NULL GROUP BY d.ICD_VERSION ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 2, "question": "Top 10 diagnosis codes by count", "expected_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD GROUP BY ICD_CODE ORDER BY cnt DESC ) WHERE ICD_CODE IS NOT NULL) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD GROUP BY ICD_CODE ORDER BY cnt DESC ) WHERE ICD_CODE IS NOT NULL) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 3, "question": "Top 10 diagnosis titles by count", "expected_sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 4, "question": "Count procedures by ICD version", "expected_sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC", "generated_sql_initial": "SELECT p.icd_version, COUNT(*) AS CNT FROM PROCEDURES_ICD p WHERE p.icd_version IS NOT NULL GROUP BY p.icd_version ORDER BY CNT DESC", "generated_sql": "SELECT p.icd_version, COUNT(*) AS CNT FROM PROCEDURES_ICD p WHERE p.icd_version IS NOT NULL GROUP BY p.icd_version ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 5, "question": "Top 10 procedure codes by count", "expected_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT pr.ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr GROUP BY pr.ICD_CODE ORDER BY cnt DESC ) WHERE pr.ICD_CODE IS NOT NULL) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT pr.ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr WHERE pr.ICD_CODE IS NOT NULL GROUP BY pr.ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 6, "question": "Top 10 procedure titles by count", "expected_sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 7, "question": "Average number of diagnoses per admission", "expected_sql": "SELECT AVG(diag_cnt) AS avg_diag FROM (SELECT HADM_ID, COUNT(*) AS diag_cnt FROM DIAGNOSES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE diag_cnt IS NOT NULL", "generated_sql_initial": "SELECT AVG(CNT) AS avg_diagnoses_per_admission FROM (SELECT HADM_ID, COUNT(*) AS diagnosis_count FROM DIAGNOSES_ICD GROUP BY HADM_ID)", "generated_sql": "SELECT AVG(CNT) AS avg_diagnoses_per_admission FROM (SELECT HADM_ID, COUNT(*) AS diagnosis_count FROM DIAGNOSES_ICD GROUP BY HADM_ID)", "expected_error": null, "generated_error": "ORA-00904: \"CNT\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "exec_error"}
{"idx": 8, "question": "Average number of procedures per admission", "expected_sql": "SELECT AVG(proc_cnt) AS avg_proc FROM (SELECT HADM_ID, COUNT(*) AS proc_cnt FROM PROCEDURES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE proc_cnt IS NOT NULL", "generated_sql_initial": "SELECT AVG(CNT) AS avg_procedures_per_admission FROM ( SELECT HADM_ID, COUNT(*) AS procedure_count FROM PROCEDURES_ICD GROUP BY HADM_ID )", "generated_sql": "SELECT AVG(CNT) AS avg_procedures_per_admission FROM ( SELECT HADM_ID, COUNT(*) AS procedure_count FROM PROCEDUREEVENTS GROUP BY HADM_ID )", "expected_error": null, "generated_error": "ORA-00904: \"CNT\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "exec_error"}
{"idx": 9, "question": "Count admissions with any diagnosis code", "expected_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN DIAGNOSES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL", "generated_sql_initial": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM DIAGNOSES_ICD d WHERE d.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM DIAGNOSES_ICD d WHERE d.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 10, "question": "Count admissions with any procedure code", "expected_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN PROCEDURES_ICD p ON a.SUBJECT_ID = p.SUBJECT_ID AND a.HADM_ID = p.HADM_ID WHERE p.ICD_CODE IS NOT NULL", "generated_sql_initial": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM PROCEDURES_ICD p WHERE p.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM PROCEDURES_ICD p WHERE p.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
