{"idx": 1, "question": "Transfer counts by care unit", "expected_sql": "SELECT * FROM ( SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM ( SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 2, "question": "\uc785\uc6d0\ubcc4\ub85c \ubcd1\uc6d0 \ub0b4 \uc0ac\ub9dd \uc5ec\ubd80\ub97c \ubf51\uc544\uc918.", "expected_sql": "SELECT hadm_id, subject_id, hospital_expire_flag FROM ADMISSIONS", "generated_sql": "SELECT hadm_id, subject_id, hospital_expire_flag FROM ADMISSIONS", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 3, "question": "\uc9c4\ub2e8 \ucf54\ub4dc\uac00 \uc5b4\ub5a4 \uccb4\uacc4(\ubc84\uc804)\ub85c \uae30\ub85d\ub410\ub294\uc9c0(\uc608: ICD-9/ICD-10) \ube44\uc911\uc744 \uc54c\ub824\uc918.", "expected_sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "generated_sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 4, "question": "\uc785\uc6d0 \uc911 \ucc98\ubc29(prescriptions)\uc5d0\uc11c \ud2b9\uc815 \ud56d\uc0dd\uc81c(\uc608: piperacillin-tazobactam)\uac00 \uba87 \ubc88 \uc8fc\ubb38\ub410\ub294\uc9c0 \uc785\uc6d0\ubcc4\ub85c \uc138\uc5b4\uc918.", "expected_sql": "SELECT hadm_id, COUNT(*) AS rx_order_cnt FROM PRESCRIPTIONS WHERE LOWER(drug) LIKE '%piperacillin%tazobactam%' GROUP BY hadm_id", "generated_sql": "SELECT hadm_id, COUNT(*) AS rx_order_cnt FROM PRESCRIPTIONS WHERE LOWER(drug) LIKE '%piperacillin%tazobactam%' GROUP BY hadm_id", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 5, "question": "Show yearly counts of hemodialysis catheter insertion events.", "expected_sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "generated_sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 40, "generated_row_count": 40}}
