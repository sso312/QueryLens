{"idx": 1, "question": "Transfer counts by care unit", "expected_sql": "SELECT * FROM ( SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT CAREUNIT, COUNT(*) AS CNT FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 10, "generated_row_count": 46}}
{"idx": 2, "question": "\uc785\uc6d0\ubcc4\ub85c \ubcd1\uc6d0 \ub0b4 \uc0ac\ub9dd \uc5ec\ubd80\ub97c \ubf51\uc544\uc918.", "expected_sql": "SELECT hadm_id, subject_id, hospital_expire_flag FROM ADMISSIONS", "generated_sql": "SELECT HADM_ID, HOSPITAL_EXPIRE_FLAG FROM ADMISSIONS", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 3, "question": "\uc9c4\ub2e8 \ucf54\ub4dc\uac00 \uc5b4\ub5a4 \uccb4\uacc4(\ubc84\uc804)\ub85c \uae30\ub85d\ub410\ub294\uc9c0(\uc608: ICD-9/ICD-10) \ube44\uc911\uc744 \uc54c\ub824\uc918.", "expected_sql": "SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY", "generated_sql": "SELECT ICD_VERSION, COUNT(DISTINCT HADM_ID) / (SELECT COUNT(DISTINCT HADM_ID) FROM DIAGNOSES_ICD) AS proportion FROM DIAGNOSES_ICD GROUP BY ICD_VERSION", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 4, "question": "\uc785\uc6d0 \uc911 \ucc98\ubc29(prescriptions)\uc5d0\uc11c \ud2b9\uc815 \ud56d\uc0dd\uc81c(\uc608: piperacillin-tazobactam)\uac00 \uba87 \ubc88 \uc8fc\ubb38\ub410\ub294\uc9c0 \uc785\uc6d0\ubcc4\ub85c \uc138\uc5b4\uc918.", "expected_sql": "SELECT hadm_id, COUNT(*) AS rx_order_cnt FROM PRESCRIPTIONS WHERE LOWER(drug) LIKE '%piperacillin%tazobactam%' GROUP BY hadm_id", "generated_sql": "SELECT a.HADM_ID, COUNT(*) AS CNT FROM admissions a JOIN prescriptions p ON a.HADM_ID = p.HADM_ID WHERE p.drug = 'piperacillin-tazobactam' GROUP BY a.HADM_ID", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 0}}
{"idx": 5, "question": "Show yearly counts of hemodialysis catheter insertion events.", "expected_sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "generated_sql": "SELECT EXTRACT(YEAR FROM pe.STARTTIME) AS year, COUNT(*) AS CNT FROM PROCEDUREEVENTS pe JOIN D_ITEMS di ON pe.ITEMID = di.ITEMID WHERE UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATHETER%' GROUP BY EXTRACT(YEAR FROM pe.STARTTIME) ORDER BY year", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 40, "generated_row_count": 41}}
{"idx": 6, "question": "\uc785\uc6d0 \uc911 \ub178\ub974\uc5d0\ud53c\ub124\ud504\ub9b0 \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%norepinephrine%'", "generated_sql": "SELECT COUNT(DISTINCT HADM_ID) AS CNT FROM PRESCRIPTIONS WHERE DRUG LIKE '%norepinephrine%'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 7, "question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT STDDEV(COUNT(DISTINCT pi.ICD_CODE)) AS sd_distinct_ecg_telemetry_codes FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID JOIN PROCEDURES_ICD pi ON a.HADM_ID = pi.HADM_ID WHERE p.GENDER = 'M' AND p.ANCHOR_AGE BETWEEN 81 AND 91 AND (pi.ICD_CODE LIKE '89%' OR pi.ICD_CODE LIKE '93%') GROUP BY a.SUBJECT_ID", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 8, "question": "\uc785\uc6d0 \uc911\uc5d0 \ub0b4\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'MED'", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS CNT FROM ADMISSIONS A JOIN ICUSTAYS I ON A.SUBJECT_ID = I.SUBJECT_ID AND A.HADM_ID = I.HADM_ID WHERE I.FIRST_CAREUNIT = 'Medicine' OR I.LAST_CAREUNIT = 'Medicine'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 9, "question": "\ud478\ub85c\uc138\ubbf8\ub4dc \uc0ac\uc6a9\ub7c9 \uc0ac\ubd84\uc704\uc218(Q1-Q4)\ubcc4 \ubcd1\uc6d0 \uc0ac\ub9dd\ub960\uc744 \ube44\uad50\ud574\uc918.", "expected_sql": "WITH drug_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND LOWER(p.drug) LIKE '%furosemide%' GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM drug_rx ), adm AS ( SELECT hadm_id, hospital_expire_flag FROM ADMISSIONS WHERE hadm_id IS NOT NULL ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) AS n_death_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS hospital_mortality_rate_pct FROM dose_q q JOIN adm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "generated_sql": "SELECT usage_quartile, SUM(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) / COUNT(*) AS mortality_rate FROM (SELECT a.HADM_ID, NTILE(4) OVER (ORDER BY SUM(CASE WHEN e.medication = 'furosemide' THEN ed.product_amount_given ELSE 0 END) DESC) AS usage_quartile FROM admissions a JOIN EMAR e ON a.HADM_ID = e.HADM_ID JOIN EMAR_DETAIL ed ON e.emar_id = ed.emar_id AND e.emar_seq = ed.emar_seq GROUP BY a.HADM_ID) usage JOIN admissions a ON usage.HADM_ID = a.HADM_ID GROUP BY usage_quartile", "expected_error": null, "generated_error": "ORA-00932: inconsistent datatypes: expected CHAR got NUMBER\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "status": "exec_error"}
{"idx": 10, "question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT STDDEV(num_cabg_procedures) AS stddev_cabg_per_patient FROM (SELECT SUBJECT_ID, COUNT(DISTINCT ICD_CODE) AS CNT FROM PROCEDURES_ICD JOIN PATIENTS ON PROCEDURES_ICD.SUBJECT_ID = PATIENTS.SUBJECT_ID WHERE PATIENTS.GENDER = 'F' AND PATIENTS.ANCHOR_AGE BETWEEN 41 AND 51 AND ((PROCEDURES_ICD.ICD_CODE LIKE '021%' AND PROCEDURES_ICD.ICD_VERSION = 10) OR (PROCEDURES_ICD.ICD_CODE LIKE '3610%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3611%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3612%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3613%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3614%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3615%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3616%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3617%' AND PROCEDURES_ICD.ICD_VERSION = 9) OR (PROCEDURES_ICD.ICD_CODE LIKE '3619%' AND PROCEDURES_ICD.ICD_VERSION = 9)) GROUP BY SUBJECT_ID)", "expected_error": null, "generated_error": "ORA-00918: column ambiguously defined\nHelp: https://docs.oracle.com/error-help/db/ora-00918/", "status": "exec_error"}
{"idx": 11, "question": "Compare AKI diagnosis rate by quartile (Q1-Q4) of loop diuretics usage, such as furosemide.", "expected_sql": "WITH loop_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS loop_dose FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND (LOWER(p.drug) LIKE '%furosemide%' OR LOWER(p.drug) LIKE '%bumetanide%' OR LOWER(p.drug) LIKE '%torsemide%' OR LOWER(p.drug) LIKE '%ethacrynic%' OR LOWER(p.drug) LIKE '%loop diuretic%') GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, loop_dose, NTILE(4) OVER (ORDER BY loop_dose) AS qtile FROM loop_rx ), aki_hadm AS ( SELECT DISTINCT d.hadm_id FROM DIAGNOSES_ICD d WHERE (d.icd_version = 10 AND d.icd_code LIKE 'N17%') OR (d.icd_version = 9 AND d.icd_code LIKE '584%') ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) AS n_aki_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hadm_id IS NOT NULL THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS aki_diagnosis_rate_pct FROM dose_q q LEFT JOIN aki_hadm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "generated_sql": "SELECT loop_diuretics_usage_quartile, COUNT(CASE WHEN aki_diagnosis = 1 THEN 1 END) / NULLIF(COUNT(DISTINCT a.HADM_ID), 0) AS aki_diagnosis_rate FROM ( SELECT a.HADM_ID, NTILE(4) OVER (ORDER BY SUM(p.DOSES_PER_24_HRS) DESC) AS loop_diuretics_usage_quartile, MAX(CASE WHEN d.ICD_CODE LIKE 'N17%' AND d.ICD_VERSION = 10 OR d.ICD_CODE LIKE '584%' AND d.ICD_VERSION = 9 THEN 1 ELSE 0 END) AS aki_diagnosis FROM ADMISSIONS a JOIN PRESCRIPTIONS p ON a.HADM_ID = p.HADM_ID LEFT JOIN DIAGNOSES_ICD d ON a.HADM_ID = d.HADM_ID WHERE p.DRUG LIKE '%furosemide%' GROUP BY a.HADM_ID ) GROUP BY loop_diuretics_usage_quartile", "expected_error": null, "generated_error": "ORA-00904: \"A\".\"HADM_ID\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 12, "question": "ICU \uccab \ubcd1\ub3d9\ubcc4 \uac74\uc218\ub97c \ubcf4\uc5ec\uc918", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT FIRST_CAREUNIT, COUNT(DISTINCT HADM_ID) AS CNT FROM ICUSTAYS GROUP BY FIRST_CAREUNIT", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 16, "generated_row_count": 16}}
{"idx": 13, "question": "Top 10 stays by total output value", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(VALUE) AS total_output FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY STAY_ID ORDER BY total_output DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT oe.STAY_ID, SUM(oe.VALUE) AS total_output_value FROM OUTPUTEVENTS oe JOIN D_ITEMS di ON oe.ITEMID = di.ITEMID WHERE di.CATEGORY = 'Output' GROUP BY oe.STAY_ID ORDER BY total_output_value DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 14, "question": "Count medication administrations by medication name", "expected_sql": "SELECT * FROM ( SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT MEDICATION, COUNT(*) AS CNT FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "status": "exec_error"}
{"idx": 15, "question": "Top 10 procedure titles", "expected_sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT LONG_TITLE, COUNT(*) AS CNT FROM PROCEDURES_ICD JOIN D_ICD_PROCEDURES ON PROCEDURES_ICD.ICD_CODE = D_ICD_PROCEDURES.ICD_CODE AND PROCEDURES_ICD.ICD_VERSION = D_ICD_PROCEDURES.ICD_VERSION GROUP BY LONG_TITLE ORDER BY CNT DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 16, "question": "\uc785\uc6d0 \uc911\uc5d0 \uc774\ube44\uc778\ud6c4\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'ENT'", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS CNT FROM ADMISSIONS A JOIN TRANSFERS T ON A.HADM_ID = T.HADM_ID WHERE T.CAREUNIT = 'ENT'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 17, "question": "\uc785\uc6d0 \uc911\uc5d0 \uc2e0\uacbd\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'NEURO'", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS CNT FROM ADMISSIONS A JOIN ICUSTAYS I ON A.SUBJECT_ID = I.SUBJECT_ID AND A.HADM_ID = I.HADM_ID WHERE I.FIRST_CAREUNIT = 'Neurology' OR I.LAST_CAREUNIT = 'Neurology'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 18, "question": "\ud658\uc790\uac00 \uc5b4\ub514\uc5d0\uc11c/\uc5b4\ub5a4 \uacbd\ub85c\ub85c \uc785\uc6d0\ud588\ub294\uc9c0(\uc785\uc6d0 \uacbd\ub85c)\ubcc4\ub85c \uc785\uc6d0 \uac74\uc218\ub97c \uc138\uace0, \ub9ce\uc740 \uc21c\uc73c\ub85c 20\uac1c \ubcf4\uc5ec\uc918", "expected_sql": "SELECT a.admission_location, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.admission_location ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY", "generated_sql": "SELECT * FROM (SELECT ADMISSION_LOCATION, COUNT(*) AS CNT FROM ADMISSIONS GROUP BY ADMISSION_LOCATION ORDER BY CNT DESC) WHERE ROWNUM <= 20", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 11, "generated_row_count": 11}}
{"idx": 19, "question": "Top 10 lab test labels by frequency", "expected_sql": "SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS CNT FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY CNT DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "status": "exec_error"}
{"idx": 20, "question": "\uc785\uc6d0 \uc911 \ubcd1\ub3d9 \uc774\ub3d9\uc774 \ucd1d \uba87 \ubc88 \uc788\uc5c8\ub294\uc9c0 \uc785\uc6d0\ubcc4\ub85c \uacc4\uc0b0\ud574\uc918.", "expected_sql": "SELECT hadm_id, COUNT(*) AS transfer_cnt FROM TRANSFERS GROUP BY hadm_id", "generated_sql": "SELECT A.HADM_ID, COUNT(T.TRANSFER_ID) AS CNT FROM ADMISSIONS A JOIN TRANSFERS T ON A.HADM_ID = T.HADM_ID WHERE T.EVENTTYPE = 'TRANSFERS' GROUP BY A.HADM_ID", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 0}}
{"idx": 21, "question": "\ud2b9\uc815 \uc9c4\ub2e8\ucf54\ub4dc\uac00 \uc788\ub294 \uc785\uc6d0\ub9cc \uace8\ub77c\uc11c \ucf54\ud638\ud2b8\ub97c \ub9cc\ub4e4\uace0 \uc2f6\uc5b4(\uc608: I50% \uc2ec\ubd80\uc804).", "expected_sql": "SELECT DISTINCT d.hadm_id, d.subject_id, d.icd_code, d.icd_version FROM DIAGNOSES_ICD d WHERE d.icd_code LIKE 'I50%'", "generated_sql": "SELECT DISTINCT HADM_ID FROM DIAGNOSES_ICD WHERE ICD_CODE LIKE 'I50%' AND ICD_VERSION = 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 22, "question": "Medication administrations with dose given", "expected_sql": "SELECT e.MEDICATION, d.DOSE_GIVEN, d.DOSE_GIVEN_UNIT FROM EMAR e JOIN EMAR_DETAIL d ON e.SUBJECT_ID = d.SUBJECT_ID AND e.EMAR_ID = d.EMAR_ID AND e.EMAR_SEQ = d.EMAR_SEQ WHERE e.MEDICATION IS NOT NULL AND d.DOSE_GIVEN IS NOT NULL AND ROWNUM <= 100", "generated_sql": "SELECT e.SUBJECT_ID, e.HADM_ID, e.CHARTTIME, ed.DOSE_GIVEN, ed.DOSE_GIVEN_UNIT FROM EMAR e JOIN EMAR_DETAIL ed ON e.EMAR_ID = ed.EMAR_ID AND e.EMAR_SEQ = ed.EMAR_SEQ WHERE ed.DOSE_GIVEN IS NOT NULL", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 23, "question": "\uc785\uc6d0 \uc911 \uc0ac\ub9dd\ud55c \ud658\uc790\ub294 \uc0ac\ub9dd \uc2dc\uc810(deathtime)\ub3c4 \uac19\uc774 \ud3ec\ud568\ud574\uc11c \ubf51\uc544\uc918.", "expected_sql": "SELECT hadm_id, subject_id, hospital_expire_flag, deathtime FROM ADMISSIONS WHERE hospital_expire_flag = 1", "generated_sql": "SELECT SUBJECT_ID, HADM_ID, DEATHTIME FROM ADMISSIONS WHERE DISCHARGE_LOCATION = 'DIED'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 24, "question": "\uc785\uc6d0 \uc720\ud615(\uc751\uae09/\uc608\uc57d/\uae34\uae09 \ub4f1)\ubcc4\ub85c \ubcd1\uc6d0 \uc0ac\ub9dd\ub960\uc774 \uc5b4\ub5bb\uac8c \ub2e4\ub978\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT a.admission_type, COUNT(*) AS hadm_cnt, AVG(a.hospital_expire_flag) AS hosp_mortality_rate FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.admission_type ORDER BY hosp_mortality_rate DESC FETCH FIRST 20 ROWS ONLY", "generated_sql": "SELECT ADMISSION_TYPE, AVG(HOSPITAL_EXPIRE_FLAG) AS mortality_rate FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG IS NOT NULL GROUP BY ADMISSION_TYPE", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 9, "generated_row_count": 9}}
{"idx": 25, "question": "\uc911\ud658\uc790\uc2e4 \uc785\uc6d0 \uae30\uac04\ub3d9\uc548 norepinephrine\uc774 \uc5b8\uc81c\ubd80\ud130 \uc5b8\uc81c\uae4c\uc9c0 \uc5b4\ub5a4 \uc18d\ub3c4\ub85c \ub4e4\uc5b4\uac14\ub294\uc9c0(\uc2dc\uc791/\uc885\ub8cc/\uc18d\ub3c4) \ud0c0\uc784\ub77c\uc778 \ud615\ud0dc\ub85c \ubcf4\uc5ec\uc918.", "expected_sql": "WITH norepi_item AS ( SELECT itemid FROM D_ITEMS WHERE LOWER(label) LIKE '%norepinephrine%' ) SELECT ie.stay_id, ie.starttime, ie.endtime, ie.rate, ie.rateuom FROM INPUTEVENTS ie JOIN norepi_item ni ON ni.itemid = ie.itemid WHERE ie.rate IS NOT NULL ORDER BY ie.stay_id, ie.starttime", "generated_sql": "SELECT ie.STARTTIME, ie.ENDTIME, ie.RATE FROM INGREDIENTEVENTS ie JOIN D_ITEMS di ON ie.ITEMID = di.ITEMID WHERE di.LABEL = 'norepinephrine'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 0}}
{"idx": 26, "question": "\uc131\uc778 \ud658\uc790\ub9cc \ub300\uc0c1\uc73c\ub85c \ud574\uc11c, \ud658\uc790\ub9c8\ub2e4 \uccab \ubc88\uc9f8 \uc785\uc6d0 \uae30\ub85d\ub9cc \ub0a8\uaca8\uc11c \ucf54\ud638\ud2b8\ub97c \ub9cc\ub4e4\uc5b4\uc918.", "expected_sql": "WITH first_admit AS ( SELECT subject_id, MIN(admittime) AS first_admittime FROM ADMISSIONS GROUP BY subject_id ) SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, p.anchor_age FROM ADMISSIONS a JOIN first_admit f ON f.subject_id = a.subject_id AND f.first_admittime = a.admittime JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE p.anchor_age >= 18", "generated_sql": "SELECT * FROM ADMISSIONS a WHERE a.ADMITTIME = (SELECT MIN(a2.ADMITTIME) FROM ADMISSIONS a2 WHERE a2.SUBJECT_ID = a.SUBJECT_ID) AND EXISTS (SELECT 1 FROM PATIENTS p WHERE p.SUBJECT_ID = a.SUBJECT_ID AND p.ANCHOR_AGE >= 18)", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 27, "question": "Top 10 stays by total input amount", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT STAY_ID, SUM(AMOUNT) AS TOTAL_INPUT_AMOUNT FROM INPUTEVENTS GROUP BY STAY_ID ORDER BY TOTAL_INPUT_AMOUNT DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 28, "question": "\uc785\uc6d0 \uc911 \ud478\ub85c\uc138\ubbf8\ub4dc \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%furosemide%'", "generated_sql": "SELECT COUNT(DISTINCT HADM_ID) AS CNT FROM PRESCRIPTIONS WHERE DRUG = 'furosemide'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 29, "question": "\ud608\uc561\ud22c\uc11d catheter \uc0bd\uc785 \uac74\uc218\ub97c \uc5f0\ub3c4\ubcc4\ub85c \ubcf4\uc5ec\uc918.", "expected_sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "generated_sql": "SELECT EXTRACT(YEAR FROM pe.STARTTIME) AS year, COUNT(*) AS CNT FROM PROCEDUREEVENTS pe JOIN D_ITEMS di ON pe.ITEMID = di.ITEMID WHERE UPPER(di.LABEL) LIKE '%CATHETER%' AND di.CATEGORY = 'Dialysis' GROUP BY EXTRACT(YEAR FROM pe.STARTTIME) ORDER BY year", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 40, "generated_row_count": 0}}
{"idx": 30, "question": "\ub9cc\uc131 \uc2e0\ubd80\uc804(N18\ub85c \uc2dc\uc791) \uc9c4\ub2e8\uc774 \uc788\ub294 \uc785\uc6d0\uc774 \uc6d4\ubcc4\ub85c \uc5bc\ub9c8\ub098 \uc788\uc5c8\ub294\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'N18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "generated_sql": "SELECT TO_CHAR(ADMITTIME, 'YYYY-MM') AS admission_month, COUNT(DISTINCT HADM_ID) AS CNT FROM ADMISSIONS WHERE EXISTS (SELECT 1 FROM DIAGNOSES_ICD WHERE ADMISSIONS.HADM_ID = DIAGNOSES_ICD.HADM_ID AND ((ICD_CODE LIKE 'N18%' AND ICD_VERSION = 10) OR (ICD_CODE LIKE '585%' AND ICD_VERSION = 9))) GROUP BY TO_CHAR(ADMITTIME, 'YYYY-MM') ORDER BY admission_month", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 120, "generated_row_count": 1242}}
