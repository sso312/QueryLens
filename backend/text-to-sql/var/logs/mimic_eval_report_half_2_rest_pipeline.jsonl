{"idx": 1, "question": "Average transfer duration in days", "expected_sql": "SELECT AVG(OUTTIME - INTIME) AS avg_transfer_days FROM TRANSFERS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL", "generated_sql_initial": "SELECT AVG((CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) * 24) / 24 AS avg_transfer_duration_days FROM TRANSFERS WHERE INTIME IS NOT NULL AND OUTTIME IS NOT NULL", "generated_sql": "SELECT AVG((CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) * 24) / 24 AS avg_transfer_duration_days FROM TRANSFERS WHERE INTIME IS NOT NULL AND OUTTIME IS NOT NULL", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "expected_exec_error"}
{"idx": 2, "question": "Count services by current service", "expected_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql_initial": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 21, "generated_row_count": 21}}
{"idx": 3, "question": "Top 10 service transitions by count", "expected_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 4, "question": "Count admissions with an ICU stay", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "generated_sql_initial": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM ICUSTAYS i WHERE i.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS CNT FROM ADMISSIONS a WHERE EXISTS (SELECT 1 FROM ICUSTAYS i WHERE i.HADM_ID = a.HADM_ID) AND A.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "alias_equivalent": false, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 5, "question": "Count chart events by warning flag", "expected_sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql_initial": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql": "SELECT WARNING, COUNT(*) AS cnt FROM (SELECT DISTINCT SUBJECT_ID, HADM_ID, WARNING FROM CHARTEVENTS WHERE ROWNUM <= 5000 AND WARNING IS NOT NULL) GROUP BY WARNING ORDER BY cnt DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 6, "question": "Top 10 chart event ITEMID by count", "expected_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ITEMID, cnt FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC)) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "'utf-8' codec can't decode byte 0xf1 in position 147: unexpected end of data", "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 7, "question": "Top 10 chart event labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, cnt FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID JOIN D_LABITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC)) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00904: \"D\".\"LABEL\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 8, "question": "Count lab events by flag", "expected_sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql_initial": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql": "SELECT FLAG, COUNT(*) AS cnt FROM (SELECT FLAG FROM LABEVENTS WHERE ROWNUM <= 5000 AND FLAG IS NOT NULL) GROUP BY FLAG ORDER BY cnt DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 9, "question": "Top 10 lab item labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, cnt FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC)) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00904: \"D\".\"LABEL\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 10, "question": "Count lab events by priority", "expected_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql_initial": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM (SELECT PRIORITY FROM LABEVENTS WHERE ROWNUM <= 5000 AND PRIORITY IS NOT NULL) GROUP BY PRIORITY ORDER BY cnt DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 11, "question": "Average lab numeric value by ITEMID", "expected_sql": "SELECT ITEMID, AVG(VALUENUM) AS avg_value FROM LABEVENTS WHERE ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID", "generated_sql_initial": "SELECT ITEMID, AVG(VALUENUM) AS average_value FROM LABEVENTS WHERE ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(VALUENUM) AS average_value FROM (SELECT DISTINCT ITEMID, VALUENUM FROM LABEVENTS WHERE ROWNUM <= 5000 AND ITEMID IS NOT NULL AND VALUENUM IS NOT NULL) GROUP BY ITEMID", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 12, "question": "Top 10 microbiology tests by count", "expected_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 13, "question": "Top 10 organisms by count", "expected_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 14, "question": "Top 10 antibiotics by count", "expected_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
