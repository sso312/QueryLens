idx,question,status,expected_sql,generated_sql,expected_error,generated_error,same_cols,same_rows,expected_row_count,generated_row_count
1,Count prescriptions by drug type,match,"SELECT DRUG_TYPE, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG_TYPE IS NOT NULL GROUP BY DRUG_TYPE ORDER BY cnt DESC","SELECT DRUG_TYPE, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG_TYPE IS NOT NULL GROUP BY DRUG_TYPE ORDER BY CNT DESC",,,True,True,3,3
2,Top 10 drugs by count,match,"SELECT * FROM (SELECT DRUG, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG IS NOT NULL GROUP BY DRUG ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT DRUG, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG IS NOT NULL GROUP BY DRUG ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
3,Count prescriptions by formulation,match,"SELECT FORM_RX, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE FORM_RX IS NOT NULL GROUP BY FORM_RX ORDER BY cnt DESC","SELECT FORM_RX, COUNT(*) AS CNT FROM PRESCRIPTIONS WHERE FORM_RX IS NOT NULL GROUP BY FORM_RX ORDER BY CNT DESC",,,True,True,63,63
4,Average doses per 24 hours by drug type,mismatch,"SELECT DRUG_TYPE, AVG(DOSES_PER_24_HRS) AS avg_doses FROM PRESCRIPTIONS WHERE DRUG_TYPE IS NOT NULL AND DOSES_PER_24_HRS IS NOT NULL GROUP BY DRUG_TYPE","SELECT p.DRUG_TYPE, AVG(p.DOSES_PER_24_HRS) AS avg_doses_per_24_hrs FROM PRESCRIPTIONS p WHERE p.DRUG_TYPE IS NOT NULL GROUP BY p.DRUG_TYPE",,,False,True,3,3
5,Top 10 medications in EMAR by count,exec_error,"SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE ROWNUM <= 5000 AND MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
6,Count EMAR detail by administration type,exec_error,"SELECT ADMINISTRATION_TYPE, COUNT(*) AS cnt FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY cnt DESC","SELECT ADMINISTRATION_TYPE, COUNT(*) AS CNT FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY CNT DESC","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
7,Top 10 EMAR event texts by count,exec_error,"SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM EMAR WHERE EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM EMAR WHERE ROWNUM <= 5000 AND EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
8,Top 10 input events by ITEMID,match,"SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM INPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ITEMID, COUNT(*) AS CNT FROM INPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY CNT DESC) WHERE ROWNUM <= 10",,,True,True,10,10
9,Average input amount by ITEMID,mismatch,"SELECT ITEMID, AVG(AMOUNT) AS avg_amount FROM INPUTEVENTS WHERE ITEMID IS NOT NULL AND AMOUNT IS NOT NULL GROUP BY ITEMID","SELECT AVG(amount) AS avg_input_amount, itemid FROM INPUTEVENTS WHERE itemid IS NOT NULL AND amount IS NOT NULL GROUP BY itemid",,,False,False,327,327
10,Average output value by ITEMID,mismatch,"SELECT ITEMID, AVG(VALUE) AS avg_value FROM OUTPUTEVENTS WHERE ITEMID IS NOT NULL AND VALUE IS NOT NULL GROUP BY ITEMID","SELECT ITEMID, AVG(VALUE) AS average_output_value FROM OUTPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID",,,False,True,71,71
11,Count diagnoses by ICD version,match,"SELECT ICD_VERSION, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC","SELECT ICD_VERSION, COUNT(*) AS CNT FROM DIAGNOSES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY CNT DESC",,,True,True,2,2
12,Top 10 diagnosis codes by count,match,"SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
13,Top 10 diagnosis titles by count,match,"SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD icd JOIN D_ICD_DIAGNOSES d ON icd.ICD_CODE = d.ICD_CODE AND icd.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
14,Count procedures by ICD version,match,"SELECT ICD_VERSION, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC","SELECT ICD_VERSION, COUNT(*) AS CNT FROM PROCEDURES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY CNT DESC",,,True,True,2,2
15,Top 10 procedure codes by count,match,"SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
16,Top 10 procedure titles by count,exec_error,"SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD p JOIN D_ICD_PROCEDURES d ON p.ICD_CODE = d.ICD_CODE AND p.ICD_VERSION = d.ICD_VERSION JOIN D_ICD_PROCEDURES d ON p.ITEMID = d.ICD_CODE WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10",,"ORA-00904: ""P"".""ITEMID"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
17,Average number of diagnoses per admission,exec_error,"SELECT AVG(diag_cnt) AS avg_diag FROM (SELECT HADM_ID, COUNT(*) AS diag_cnt FROM DIAGNOSES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE diag_cnt IS NOT NULL","SELECT NVL(AVG(num_diagnoses), 0) AS avg_diagnoses_per_admission FROM ( SELECT di.HADM_ID, COUNT(*) AS CNT FROM DIAGNOSES_ICD di WHERE di.HADM_ID IS NOT NULL GROUP BY di.HADM_ID ) diagnosis_counts",,"ORA-00904: ""NUM_DIAGNOSES"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
18,Average number of procedures per admission,exec_error,"SELECT AVG(proc_cnt) AS avg_proc FROM (SELECT HADM_ID, COUNT(*) AS proc_cnt FROM PROCEDURES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE proc_cnt IS NOT NULL","SELECT AVG(CNT) AS average_procedures_per_admission FROM (SELECT a.HADM_ID, COUNT(*) AS CNT FROM PROCEDURES_ICD a JOIN LABEVENTS l ON a.HADM_ID = l.HADM_ID GROUP BY a.HADM_ID) hadm_procedures WHERE ROWNUM <= 5000 AND 1=1;",,"DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
19,Count admissions with any diagnosis code,match,SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN DIAGNOSES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL,SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN DIAGNOSES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL,,,True,True,1,1
20,Count admissions with any procedure code,match,SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN PROCEDURES_ICD p ON a.SUBJECT_ID = p.SUBJECT_ID AND a.HADM_ID = p.HADM_ID WHERE p.ICD_CODE IS NOT NULL,SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN PROCEDURES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL,,,True,True,1,1
21,Count admissions by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT p.GENDER, COUNT(*) AS CNT FROM ADMISSIONS  JOIN PATIENTS p ON ADMISSIONS.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY CNT DESC",,,True,True,2,2
22,Average anchor age by admission type,match,"SELECT a.ADMISSION_TYPE, AVG(p.ANCHOR_AGE) AS avg_age FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE a.ADMISSION_TYPE IS NOT NULL AND p.ANCHOR_AGE IS NOT NULL GROUP BY a.ADMISSION_TYPE","SELECT AD.ADMISSION_TYPE, AVG(P.ANCHOR_AGE) AS AVG_AGE FROM ADMISSIONS AD JOIN PATIENTS P ON AD.SUBJECT_ID = P.SUBJECT_ID WHERE AD.ADMISSION_TYPE IS NOT NULL GROUP BY AD.ADMISSION_TYPE",,,True,True,9,9
23,Count ICU stays by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM ICUSTAYS i JOIN PATIENTS p ON i.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT P.GENDER, COUNT(*) AS CNT FROM ICUSTAYS I JOIN PATIENTS P ON I.SUBJECT_ID = P.SUBJECT_ID WHERE P.GENDER IS NOT NULL GROUP BY P.GENDER ORDER BY CNT DESC",,,True,True,2,2
24,Count lab events by gender,exec_error,"SELECT p.GENDER, COUNT(*) AS cnt FROM LABEVENTS l JOIN PATIENTS p ON l.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS p JOIN LABEVENTS l ON p.SUBJECT_ID = l.SUBJECT_ID WHERE ROWNUM <= 5000 AND p.GENDER IS NOT NULL GROUP BY GENDER ORDER BY CNT DESC","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
25,Count chart events by gender,exec_error,"SELECT p.GENDER, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN PATIENTS p ON c.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT GENDER, COUNT(*) AS CNT FROM CHARTEVENTS INNER JOIN PATIENTS ON CHARTEVENTS.SUBJECT_ID = PATIENTS.SUBJECT_ID WHERE ROWNUM <= 5000 AND GENDER IS NOT NULL GROUP BY GENDER ORDER BY CNT DESC","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
26,Count prescriptions by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM PRESCRIPTIONS r JOIN PATIENTS p ON r.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT PATIENTS.GENDER, COUNT(PRESCRIPTIONS.SUBJECT_ID) AS CNT FROM PRESCRIPTIONS JOIN PATIENTS ON PRESCRIPTIONS.SUBJECT_ID = PATIENTS.SUBJECT_ID WHERE PATIENTS.GENDER IS NOT NULL GROUP BY PATIENTS.GENDER ORDER BY CNT DESC",,,True,True,2,2
27,Count procedures by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN PATIENTS p ON pr.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT p.GENDER, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN PATIENTS p ON pr.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC",,,True,True,2,2
28,Count diagnoses by gender,mismatch,"SELECT p.GENDER, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN PATIENTS p ON dx.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT GENDER, COUNT(d.ICD_CODE) AS CNT FROM PROCEDURES_ICD JOIN PATIENTS ON PROCEDURES_ICD.SUBJECT_ID = PATIENTS.SUBJECT_ID  JOIN DIAGNOSES_ICD d ON PROCEDURES_ICD.SUBJECT_ID = d.SUBJECT_ID WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY CNT DESC",,,True,False,2,2
29,Count transfers by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM TRANSFERS t JOIN PATIENTS p ON t.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT P.GENDER, COUNT(T.TRANSFER_ID) AS CNT FROM TRANSFERS T JOIN PATIENTS P ON T.SUBJECT_ID = P.SUBJECT_ID WHERE P.GENDER IS NOT NULL GROUP BY P.GENDER ORDER BY CNT DESC",,,True,True,2,2
30,Count services by gender,match,"SELECT p.GENDER, COUNT(*) AS cnt FROM SERVICES s JOIN PATIENTS p ON s.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC","SELECT PAT.GENDER, COUNT(*) AS CNT FROM SERVICES SER JOIN PATIENTS PAT ON SER.SUBJECT_ID = PAT.SUBJECT_ID WHERE PAT.GENDER IS NOT NULL GROUP BY PAT.GENDER ORDER BY CNT DESC",,,True,True,2,2
