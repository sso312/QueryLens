{"idx": 1, "question": "ICU \ud22c\uc785 \uc774\ubca4\ud2b8 \ucd1d\ub7c9 \uc0c1\uc704 10 stay\ub97c \ubcf4\uc5ec\uc918", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC )) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC )) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 2, "question": "\uc785\uc6d0 \uc911 \ub2f4\ub2f9 \uc9c4\ub8cc\uacfc\uac00 \ub0b4\uacfc\uc778 \uacbd\uc6b0\ub9cc \ud3ec\ud568\ud574\uc918.", "expected_sql": "SELECT a.hadm_id, a.subject_id, s.transfertime, s.curr_service FROM ADMISSIONS a JOIN SERVICES s ON s.hadm_id = a.hadm_id WHERE s.curr_service = 'MED'", "generated_sql_initial": "SELECT a.hadm_id, a.subject_id, s.transfertime, s.curr_service FROM ADMISSIONS a JOIN SERVICES s ON s.hadm_id = a.hadm_id WHERE s.curr_service = 'MED'", "generated_sql": "SELECT a.hadm_id, a.subject_id, s.transfertime, s.curr_service FROM ADMISSIONS a JOIN SERVICES s ON s.hadm_id = a.hadm_id WHERE s.curr_service = 'MED'", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 136832, "generated_row_count": 136832}}
{"idx": 3, "question": "Top 10 diagnosis titles", "expected_sql": "SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 4, "question": "POE \uc0d8\ud50c 100\uac74\uc744 \ubcf4\uc5ec\uc918", "expected_sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE POE_ID IS NOT NULL AND ROWNUM <= 100", "generated_sql_initial": "SELECT POE_ID, POE_SEQ FROM POE WHERE ROWNUM <= 100", "generated_sql": "SELECT POE_ID, POE_SEQ FROM POE WHERE ROWNUM <= 100", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 100, "generated_row_count": 100}}
{"idx": 5, "question": "\uc785\uc6d0 \uc911 \ubbf8\ub2e4\uc878\ub78c \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%midazolam%'", "generated_sql_initial": "SELECT COUNT(DISTINCT p.hadm_id) AS CNT FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%midazolam%' AND P.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS CNT FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%midazolam%' AND P.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 6, "question": "Top 10 input event items by total amount", "expected_sql": "SELECT * FROM ( SELECT d.LABEL, SUM(e.AMOUNT) AS total_amount FROM INPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.AMOUNT IS NOT NULL GROUP BY d.LABEL ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT * FROM ( SELECT d.LABEL, SUM(e.AMOUNT) AS total_amount FROM INPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.AMOUNT IS NOT NULL GROUP BY d.LABEL ORDER BY total_amount DESC )) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT * FROM ( SELECT d.LABEL, SUM(e.AMOUNT) AS total_amount FROM INPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.AMOUNT IS NOT NULL GROUP BY d.LABEL ORDER BY total_amount DESC )) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 7, "question": "\uc785\uc6d0 \uc911\uc5d0 \uc2ec\uc7a5\uc678\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'CARDS'", "generated_sql_initial": "SELECT COUNT(DISTINCT s.hadm_id) AS CNT FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'CSURG' AND S.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS CNT FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'CSURG' AND S.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "alias_equivalent": false, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 8, "question": "POE order types by count", "expected_sql": "SELECT * FROM ( SELECT ORDER_TYPE, COUNT(*) AS cnt FROM POE WHERE ORDER_TYPE IS NOT NULL GROUP BY ORDER_TYPE ORDER BY cnt DESC ) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT ORDER_TYPE, COUNT(*) AS CNT FROM POE WHERE ORDER_TYPE IS NOT NULL GROUP BY ORDER_TYPE ORDER BY CNT DESC", "generated_sql": "SELECT ORDER_TYPE, COUNT(*) AS CNT FROM (SELECT ORDER_TYPE FROM POE WHERE ORDER_TYPE IS NOT NULL) GROUP BY ORDER_TYPE ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "expected_exec_error"}
{"idx": 9, "question": "\uc785\uc6d0 \uc911 \uc138\ud504\ud2b8\ub9ac\uc545\uc190 \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%ceftriaxone%'", "generated_sql_initial": "SELECT COUNT(DISTINCT p.hadm_id) AS CNT FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%ceftriaxone%' AND P.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS CNT FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%ceftriaxone%' AND P.HADM_ID IS NOT NULL", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
