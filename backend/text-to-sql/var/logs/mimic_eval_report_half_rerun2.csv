idx,question,status,expected_sql,generated_sql,expected_error,generated_error,same_cols,same_rows,expected_row_count,generated_row_count
1,Count patients by gender,mismatch,"SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY cnt DESC","SELECT gender, COUNT(*) AS patient_count FROM patients WHERE 1=1 GROUP BY gender",,,False,True,2,2
2,Average anchor age by gender,mismatch,"SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER","SELECT gender, AVG(ANCHOR_AGE) AS average_age FROM PATIENTS WHERE ANCHOR_AGE IS NOT NULL GROUP BY gender",,,False,True,2,2
3,Count patients by anchor year group,exec_error,"SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC","SELECT anchor_year_group, COUNT(SUBJECT_ID) AS patient_count FROM patients GROUP BY anchor_year_group HAVING WHERE 1=1",,"ORA-00936: missing expression
Help: https://docs.oracle.com/error-help/db/ora-00936/",,,,
4,Count admissions by admission type,exec_error,"SELECT ADMISSION_TYPE, COUNT(*) AS cnt FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY cnt DESC","SELECT ADMISSION_TYPE, COUNT(*) AS admission_count FROM admissions WHERE admitted_date > SYSDATE - INTERVAL '1' YEAR GROUP BY ADMISSION_TYPE",,"ORA-00904: ""ADMITTED_DATE"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
5,Count admissions by insurance,mismatch,"SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC","SELECT INSURANCE, COUNT(*) AS admission_count FROM admissions GROUP BY INSURANCE",,,False,False,5,6
6,Count admissions by race,mismatch,"SELECT RACE, COUNT(*) AS cnt FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY cnt DESC","SELECT race, COUNT(*) AS admission_count FROM admissions WHERE 1=1 GROUP BY race",,,False,False,33,33
7,Count admissions by marital status,mismatch,"SELECT MARITAL_STATUS, COUNT(*) AS cnt FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY cnt DESC","SELECT marital_status, COUNT(*) AS admissions_count FROM Admissions WHERE 1=1 GROUP BY marital_status",,,False,False,4,5
8,Count admissions with hospital expire flag,match,SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1,SELECT COUNT(*) FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1,,,True,True,1,1
9,Count admissions with ED registration time,mismatch,SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL,SELECT COUNT(*) AS admission_count FROM admissions WHERE EDREGTIME IS NOT NULL,,,False,True,1,1
10,Average admission length of stay in days,exec_error,SELECT AVG(DISCHTIME - ADMITTIME) AS avg_los_days FROM ADMISSIONS WHERE DISCHTIME IS NOT NULL AND ADMITTIME IS NOT NULL,SELECT AVG(CAST(ADMISSIONS.DISCHTIME AS DATE) - CAST(ADMISSIONS.ADMITTIME AS DATE)) AS AVG_STAY FROM ADMISSIONS WHERE 1=1,"ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND
Help: https://docs.oracle.com/error-help/db/ora-00932/",,,,,
11,Count ICU stays by first careunit,mismatch,"SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC","SELECT first_careunit, COUNT(*) AS icu_stay_count FROM icustays WHERE 1=1 GROUP BY first_careunit",,,False,False,17,17
12,Average ICU LOS by first careunit,mismatch,"SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT","SELECT first_careunit, AVG(los) AS average_icu_los FROM icustays WHERE los IS NOT NULL GROUP BY first_careunit",,,False,True,17,17
13,Count ICU stays by last careunit,mismatch,"SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC","SELECT last_careunit, COUNT(*) AS icu_stay_count FROM icustays WHERE last_careunit IS NOT NULL GROUP BY last_careunit",,,False,False,17,17
14,Count ICU stays with LOS >= 1 day,mismatch,SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE LOS >= 1,SELECT COUNT(*) AS icu_stays_count FROM ICUSTAYS WHERE los >= 1,,,False,True,1,1
15,Count transfers by careunit,mismatch,"SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC","SELECT careunit, COUNT(*) AS transfer_count FROM transfers WHERE 1=1 GROUP BY careunit",,,False,False,46,46
16,Count transfers by event type,mismatch,"SELECT EVENTTYPE, COUNT(*) AS cnt FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY cnt DESC","SELECT EVENTTYPE, COUNT(*) AS transfer_count FROM transfers GROUP BY EVENTTYPE",,,False,False,4,4
17,Average transfer duration in days,exec_error,SELECT AVG(OUTTIME - INTIME) AS avg_transfer_days FROM TRANSFERS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL,SELECT AVG(CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) AS average_transfer_duration_in_days FROM transfers WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL,"ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND
Help: https://docs.oracle.com/error-help/db/ora-00932/",,,,,
18,Count services by current service,mismatch,"SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC","SELECT CURR_SERVICE, COUNT(*) AS service_count FROM services GROUP BY CURR_SERVICE",,,False,False,21,21
19,Top 10 service transitions by count,mismatch,"SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT CURR_SERVICE, COUNT(*) AS transition_count FROM SERVICES WHERE 1=1 GROUP BY CURR_SERVICE ORDER BY transition_count DESC) WHERE ROWNUM <= 10",,,False,False,10,10
20,Count admissions with an ICU stay,exec_error,SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL,SELECT COUNT(*) FROM admissions WHERE ICUSTAYS IS NOT NULL,,"ORA-00904: ""ICUSTAYS"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
21,Count chart events by warning flag,exec_error,"SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC","SELECT WARNING, COUNT(*) AS event_count FROM CHARTEVENTS WHERE ROWNUM <= 5000 AND 1=1 GROUP BY WARNING","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
22,Top 10 chart event ITEMID by count,exec_error,"SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ITEMID, COUNT(*) AS event_count FROM CHARTEVENTS WHERE 1=1 GROUP BY ITEMID ORDER BY event_count DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
23,Top 10 chart event labels by count,exec_error,"SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LABEL, COUNT(*) as count FROM CHARTEVENTS JOIN D_ITEMS d ON CHARTEVENTS.ITEMID = d.ITEMID GROUP BY d.LABEL ORDER BY count DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
24,Count lab events by flag,exec_error,"SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC","SELECT lab_flag, COUNT(*) AS event_count FROM LABEVENTS WHERE ROWNUM <= 5000 AND 1=1 GROUP BY lab_flag","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","ORA-00904: ""LAB_FLAG"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
25,Top 10 lab item labels by count,exec_error,"SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LABEL, COUNT(*) AS label_count FROM LABEVENTS JOIN D_LABITEMS d ON LABEVENTS.ITEMID = d.ITEMID GROUP BY d.LABEL ORDER BY label_count DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
26,Count lab events by priority,exec_error,"SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC","SELECT priority, COUNT(*) AS event_count FROM LABEVENTS WHERE ROWNUM <= 5000 AND priority IS NOT NULL GROUP BY priority","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
27,Average lab numeric value by ITEMID,exec_error,"SELECT ITEMID, AVG(VALUENUM) AS avg_value FROM LABEVENTS WHERE ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID","SELECT ITEMID, AVG(VALUENUM) AS AVG_VALUENUM FROM LABEVENTS WHERE ROWNUM <= 5000 AND VALUENUM IS NOT NULL GROUP BY ITEMID","DPY-4024: call timeout of 15000 ms exceeded
DPI-1067: call timeout of 15000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,,
28,Top 10 microbiology tests by count,mismatch,"SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT TEST_NAME, COUNT(*) as test_count FROM MICROBIOLOGYEVENTS GROUP BY TEST_NAME ORDER BY test_count DESC) WHERE ROWNUM <= 10",,,False,True,10,10
29,Top 10 organisms by count,mismatch,"SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS organism_count FROM MICROBIOLOGYEVENTS GROUP BY ORG_NAME ORDER BY organism_count DESC) WHERE ROWNUM <= 10",,,False,False,10,10
30,Top 10 antibiotics by count,mismatch,"SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT AB_NAME, COUNT(*) as count FROM MICROBIOLOGYEVENTS GROUP BY AB_NAME ORDER BY count DESC) WHERE ROWNUM <= 10",,,False,False,10,10
