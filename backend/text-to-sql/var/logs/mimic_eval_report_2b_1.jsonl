{"idx": 1, "question": "Top 10 medications in EMAR by count", "expected_sql": "SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM (SELECT * FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE AND ROWNUM <= 1000) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00936: missing expression\nHelp: https://docs.oracle.com/error-help/db/ora-00936/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "exec_error"}
{"idx": 2, "question": "Count EMAR detail by administration type", "expected_sql": "SELECT ADMINISTRATION_TYPE, COUNT(*) AS cnt FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY cnt DESC", "generated_sql_initial": "SELECT ADMINISTRATION_TYPE, COUNT(*) AS count FROM EMAR_DETAIL GROUP BY ADMINISTRATION_TYPE", "generated_sql": "SELECT ADMINISTRATION_TYPE, COUNT(*) AS CNT FROM (SELECT * FROM EMAR_DETAIL WHERE ROWNUM <= 1000) WHERE ADMINISTRATION_TYPE IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 1, "status": "exec_error"}
{"idx": 3, "question": "Top 10 EMAR event texts by count", "expected_sql": "SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM EMAR WHERE EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM EMAR WHERE EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM (SELECT * FROM EMAR WHERE EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE AND ROWNUM <= 1000) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 30000 ms exceeded\nDPI-1067: call timeout of 30000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00936: missing expression\nHelp: https://docs.oracle.com/error-help/db/ora-00936/", "execution_mode": "pipeline", "repair_attempts": 1, "status": "exec_error"}
{"idx": 4, "question": "Top 10 input events by ITEMID", "expected_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM INPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS event_count FROM INPUTEVENTS GROUP BY ITEMID ORDER BY event_count DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS CNT FROM INPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY CNT DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 5, "question": "Average input amount by ITEMID", "expected_sql": "SELECT ITEMID, AVG(AMOUNT) AS avg_amount FROM INPUTEVENTS WHERE ITEMID IS NOT NULL AND AMOUNT IS NOT NULL GROUP BY ITEMID", "generated_sql_initial": "SELECT ITEMID, AVG(AMOUNT) AS average_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(AMOUNT) AS avg_amount FROM INPUTEVENTS WHERE ITEMID IS NOT NULL AND AMOUNT IS NOT NULL GROUP BY ITEMID", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 311, "generated_row_count": 311}}
{"idx": 6, "question": "Average output value by ITEMID", "expected_sql": "SELECT ITEMID, AVG(VALUE) AS avg_value FROM OUTPUTEVENTS WHERE ITEMID IS NOT NULL AND VALUE IS NOT NULL GROUP BY ITEMID", "generated_sql_initial": "SELECT ITEMID, AVG(VALUE) AS average_value FROM OUTPUTEVENTS WHERE VALUE IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(VALUE) AS avg_value FROM OUTPUTEVENTS WHERE ITEMID IS NOT NULL AND VALUE IS NOT NULL GROUP BY ITEMID", "expected_error": null, "generated_error": null, "execution_mode": "pipeline", "repair_attempts": 0, "status": "match", "compare": {"same_cols": true, "same_rows": true, "alias_equivalent": true, "subset_rows": false, "expected_row_count": 70, "generated_row_count": 70}}
