{"idx": 1, "question": "Count patients by gender", "expected_sql": "SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY cnt DESC", "generated_sql": "SELECT gender, COUNT(*) AS count FROM patients WHERE 1=1 GROUP BY gender", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 2, "question": "Average anchor age by gender", "expected_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "generated_sql": "SELECT gender, AVG(ANCHOR_AGE) AS average_age FROM PATIENTS WHERE ANCHOR_AGE IS NOT NULL GROUP BY gender", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 3, "question": "Count patients by anchor year group", "expected_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "generated_sql": "SELECT anchor_year, COUNT(*) AS patient_count FROM patients GROUP BY anchor_year", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5, "generated_row_count": 99}}
{"idx": 4, "question": "Count admissions by admission type", "expected_sql": "SELECT ADMISSION_TYPE, COUNT(*) AS cnt FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY cnt DESC", "generated_sql": "SELECT ADMISSION_TYPE, COUNT(*) AS admission_count FROM admissions WHERE 1=1 GROUP BY ADMISSION_TYPE", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 9, "generated_row_count": 9}}
{"idx": 5, "question": "Count admissions by insurance", "expected_sql": "SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC", "generated_sql": "SELECT INSURANCE, COUNT(*) as admissions_count FROM admissions WHERE 1=1 GROUP BY INSURANCE", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5, "generated_row_count": 6}}
{"idx": 6, "question": "Count admissions by race", "expected_sql": "SELECT RACE, COUNT(*) AS cnt FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY cnt DESC", "generated_sql": "SELECT race, COUNT(*) AS admission_count FROM admissions WHERE 1=1 GROUP BY race", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 33, "generated_row_count": 33}}
{"idx": 7, "question": "Count admissions by marital status", "expected_sql": "SELECT MARITAL_STATUS, COUNT(*) AS cnt FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY cnt DESC", "generated_sql": "SELECT marital_status, COUNT(*) AS admission_count FROM admissions WHERE 1=1 GROUP BY marital_status", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 4, "generated_row_count": 5}}
{"idx": 8, "question": "Count admissions with hospital expire flag", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1", "generated_sql": "SELECT COUNT(*) AS admission_count FROM admissions WHERE hospital_expire_flag IS NOT NULL", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 9, "question": "Count admissions with ED registration time", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL", "generated_sql": "SELECT COUNT(*) AS admission_count FROM admissions WHERE EDREGTIME IS NOT NULL", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 10, "question": "Average admission length of stay in days", "expected_sql": "SELECT AVG(DISCHTIME - ADMITTIME) AS avg_los_days FROM ADMISSIONS WHERE DISCHTIME IS NOT NULL AND ADMITTIME IS NOT NULL", "generated_sql": "SELECT AVG(CAST(DISCHTIME AS DATE) - CAST(ADMITTIME AS DATE)) AS AVG_LENGTH_OF_STAY FROM ADMISSIONS WHERE 1=1", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": null, "status": "exec_error"}
{"idx": 11, "question": "Count ICU stays by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT first_careunit, COUNT(*) AS icu_stay_count FROM icustay_table WHERE 1=1 GROUP BY first_careunit", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 12, "question": "Average ICU LOS by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "generated_sql": "SELECT first_careunit, AVG(LOS) AS average_icu_los FROM icu_patients WHERE 1=1 GROUP BY first_careunit", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 13, "question": "Count ICU stays by last careunit", "expected_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT d.last_careunit, COUNT(*) AS icu_stay_count FROM icustays d WHERE 1=1 GROUP BY d.last_careunit", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 17, "generated_row_count": 17}}
{"idx": 14, "question": "Count ICU stays with LOS >= 1 day", "expected_sql": "SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE LOS >= 1", "generated_sql": "SELECT COUNT(*) FROM icustays WHERE los >= 1", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 15, "question": "Count transfers by careunit", "expected_sql": "SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT careunit, COUNT(*) AS transfer_count FROM transfers WHERE 1=1 GROUP BY careunit", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 46, "generated_row_count": 46}}
{"idx": 16, "question": "Count transfers by event type", "expected_sql": "SELECT EVENTTYPE, COUNT(*) AS cnt FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY cnt DESC", "generated_sql": "SELECT EVENTTYPE, COUNT(*) AS transfer_count FROM transfers WHERE 1=1 GROUP BY EVENTTYPE", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}}
{"idx": 17, "question": "Average transfer duration in days", "expected_sql": "SELECT AVG(OUTTIME - INTIME) AS avg_transfer_days FROM TRANSFERS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL", "generated_sql": "SELECT AVG(duration) AS average_duration_days FROM transfers WHERE 1=1", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": "ORA-00904: \"DURATION\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 18, "question": "Count services by current service", "expected_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql": "SELECT CURR_SERVICE, COUNT(*) AS service_count FROM services WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 21, "generated_row_count": 21}}
{"idx": 19, "question": "Top 10 service transitions by count", "expected_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT service_transition, COUNT(*) as transition_count FROM transitions WHERE 1=1 GROUP BY service_transition ORDER BY transition_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 20, "question": "Count admissions with an ICU stay", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(*) FROM Admissions WHERE ADMISSIONS.HADM_ID IN (SELECT HADM_ID FROM ICUSTAYS)", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 1, "question": "Count chart events by warning flag", "expected_sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql": "SELECT WARNING, COUNT(*) AS event_count FROM CHARTEVENTS WHERE ROWNUM <= 100000 AND 1=1 GROUP BY WARNING", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 2, "question": "Top 10 chart event ITEMID by count", "expected_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS item_count FROM CHARTEVENTS GROUP BY ITEMID ORDER BY item_count DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/ull>\u0001\u0001", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/ull>\u0001\u0001", "status": "exec_error"}
{"idx": 3, "question": "Top 10 chart event labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS count FROM CHARTEVENTS CHARTEVENTS JOIN D_ITEMS d ON CHARTEVENTS.ITEMID = d.ITEMID BY d.LABEL ORDER BY count DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00907: missing right parenthesis\nHelp: https://docs.oracle.com/error-help/db/ora-00907/", "status": "exec_error"}
{"idx": 4, "question": "Count lab events by flag", "expected_sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql": "SELECT flag, COUNT(*) AS event_count FROM LABEVENTS WHERE ROWNUM <= 100000 AND 1=1 GROUP BY flag", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 5, "question": "Top 10 lab item labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT LABEL, COUNT(*) AS label_count FROM lab GROUP BY LABEL ORDER BY label_count DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 6, "question": "Count lab events by priority", "expected_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql": "SELECT priority, COUNT(*) AS event_count FROM LABEVENTS WHERE ROWNUM <= 100000 GROUP BY priority", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 7, "question": "Average lab numeric value by ITEMID", "expected_sql": "SELECT ITEMID, AVG(VALUENUM) AS avg_value FROM LABEVENTS WHERE ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(VALUE) AS average_value FROM LAB_RESULTS WHERE 1=1 GROUP BY ITEMID", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 8, "question": "Top 10 microbiology tests by count", "expected_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT test_name, COUNT(*) AS test_count FROM MICROBIOLOGYEVENTS GROUP BY test_name ORDER BY test_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 9, "question": "Top 10 organisms by count", "expected_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) as organism_count FROM organism_table GROUP BY ORG_NAME ORDER BY organism_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 10, "question": "Top 10 antibiotics by count", "expected_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS usage_count FROM prescriptions WHERE 1=1 GROUP BY AB_NAME ORDER BY usage_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00904: \"AB_NAME\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 11, "question": "Count prescriptions by drug type", "expected_sql": "SELECT DRUG_TYPE, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG_TYPE IS NOT NULL GROUP BY DRUG_TYPE ORDER BY cnt DESC", "generated_sql": "SELECT drug_type, COUNT(*) AS prescription_count FROM prescriptions WHERE ROWNUM <= 100000 AND 1=1 GROUP BY drug_type", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 3, "generated_row_count": 3}}
{"idx": 12, "question": "Top 10 drugs by count", "expected_sql": "SELECT * FROM (SELECT DRUG, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE DRUG IS NOT NULL GROUP BY DRUG ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT DRUG, COUNT(*) AS drug_count FROM prescriptions GROUP BY DRUG ORDER BY drug_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 13, "question": "Count prescriptions by formulation", "expected_sql": "SELECT FORM_RX, COUNT(*) AS cnt FROM PRESCRIPTIONS WHERE FORM_RX IS NOT NULL GROUP BY FORM_RX ORDER BY cnt DESC", "generated_sql": "SELECT FORM_RX, COUNT(*) AS prescription_count FROM prescriptions WHERE ROWNUM <= 100000 GROUP BY FORM_RX", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 63, "generated_row_count": 17}}
{"idx": 14, "question": "Average doses per 24 hours by drug type", "expected_sql": "SELECT DRUG_TYPE, AVG(DOSES_PER_24_HRS) AS avg_doses FROM PRESCRIPTIONS WHERE DRUG_TYPE IS NOT NULL AND DOSES_PER_24_HRS IS NOT NULL GROUP BY DRUG_TYPE", "generated_sql": "SELECT drug_type, AVG(doses_per_day) AS average_doses_per_24_hours FROM medication_data WHERE 1=1 GROUP BY drug_type", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 1, "question": "Top 10 medications in EMAR by count", "expected_sql": "SELECT * FROM (SELECT MEDICATION, COUNT(*) AS cnt FROM EMAR WHERE MEDICATION IS NOT NULL GROUP BY MEDICATION ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT MEDICATION, COUNT(*) AS medication_count FROM EMAR GROUP BY MEDICATION ORDER BY medication_count DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "status": "exec_error"}
{"idx": 2, "question": "Count EMAR detail by administration type", "expected_sql": "SELECT ADMINISTRATION_TYPE, COUNT(*) AS cnt FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY cnt DESC", "generated_sql": "SELECT administration_type, COUNT(*) AS emar_detail_count FROM EMAR_DETAIL WHERE 1=1 GROUP BY administration_type", "expected_error": "'utf-8' codec can't decode byte 0xb1 in position 147: invalid start byte", "generated_error": "'utf-8' codec can't decode byte 0xb1 in position 147: invalid start byte", "status": "exec_error"}
{"idx": 3, "question": "Top 10 EMAR event texts by count", "expected_sql": "SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS cnt FROM EMAR WHERE EVENT_TXT IS NOT NULL GROUP BY EVENT_TXT ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT EVENT_TXT, COUNT(*) AS event_count FROM emar_events GROUP BY EVENT_TXT ORDER BY event_count DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 4, "question": "Top 10 input events by ITEMID", "expected_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM INPUTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS EVENT_COUNT FROM input_events GROUP BY ITEMID ORDER BY EVENT_COUNT DESC) WHERE ROWNUM <= 10", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 5, "question": "Average input amount by ITEMID", "expected_sql": "SELECT ITEMID, AVG(AMOUNT) AS avg_amount FROM INPUTEVENTS WHERE ITEMID IS NOT NULL AND AMOUNT IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(AMOUNT) AS AVG_AMOUNT FROM INPUTS GROUP BY ITEMID", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 6, "question": "Average output value by ITEMID", "expected_sql": "SELECT ITEMID, AVG(VALUE) AS avg_value FROM OUTPUTEVENTS WHERE ITEMID IS NOT NULL AND VALUE IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(OUTPUT_VALUE) AS AVERAGE_OUTPUT_VALUE FROM production_data WHERE 1=1 GROUP BY ITEMID", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 1, "question": "Count diagnoses by ICD version", "expected_sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC", "generated_sql": "SELECT icd_version, COUNT(*) AS diagnosis_count FROM diagnosis_table WHERE 1=1 GROUP BY icd_version", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 2, "question": "Top 10 diagnosis codes by count", "expected_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM DIAGNOSES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS diagnosis_count FROM DIAGNOSES_ICD GROUP BY ICD_CODE ORDER BY diagnosis_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 3, "question": "Top 10 diagnosis titles by count", "expected_sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN D_ICD_DIAGNOSES d ON dx.ICD_CODE = d.ICD_CODE AND dx.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT LONG_TITLE, COUNT(*) as count FROM diagnosis GROUP BY LONG_TITLE ORDER BY count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 4, "question": "Count procedures by ICD version", "expected_sql": "SELECT ICD_VERSION, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_VERSION IS NOT NULL GROUP BY ICD_VERSION ORDER BY cnt DESC", "generated_sql": "SELECT icd_version, COUNT(*) AS procedure_count FROM PROCEDURES_ICD GROUP BY icd_version", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 5, "question": "Top 10 procedure codes by count", "expected_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS cnt FROM PROCEDURES_ICD WHERE ICD_CODE IS NOT NULL GROUP BY ICD_CODE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ICD_CODE, COUNT(*) AS code_count FROM medical_procedures GROUP BY ICD_CODE ORDER BY code_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 6, "question": "Top 10 procedure titles by count", "expected_sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LONG_TITLE, COUNT(*) AS procedure_count FROM PROCEDURES_ICD PROCEDURES_ICD JOIN D_ICD_PROCEDURES d ON PROCEDURES_ICD.ICD_CODE = d.ICD_CODE AND PROCEDURES_ICD.ICD_VERSION = d.ICD_VERSION BY d.LONG_TITLE ORDER BY procedure_count DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": "ORA-00907: missing right parenthesis\nHelp: https://docs.oracle.com/error-help/db/ora-00907/", "status": "exec_error"}
{"idx": 7, "question": "Average number of diagnoses per admission", "expected_sql": "SELECT AVG(diag_cnt) AS avg_diag FROM (SELECT HADM_ID, COUNT(*) AS diag_cnt FROM DIAGNOSES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE diag_cnt IS NOT NULL", "generated_sql": "SELECT AVG(diagnosis_count) AS avg_diagnoses_per_admission FROM (SELECT HADM_ID, COUNT(ICD_CODE) AS diagnosis_count FROM DIAGNOSES_ICD GROUP BY HADM_ID)", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 8, "question": "Average number of procedures per admission", "expected_sql": "SELECT AVG(proc_cnt) AS avg_proc FROM (SELECT HADM_ID, COUNT(*) AS proc_cnt FROM PROCEDURES_ICD WHERE HADM_ID IS NOT NULL GROUP BY HADM_ID) WHERE proc_cnt IS NOT NULL", "generated_sql": "SELECT AVG(procedure_count) AS avg_procedures_per_admission FROM (SELECT HADM_ID, COUNT(ICD_CODE) AS procedure_count FROM PROCEDURES_ICD GROUP BY HADM_ID) WHERE 1=1", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 9, "question": "Count admissions with any diagnosis code", "expected_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN DIAGNOSES_ICD d ON a.SUBJECT_ID = d.SUBJECT_ID AND a.HADM_ID = d.HADM_ID WHERE d.ICD_CODE IS NOT NULL", "generated_sql": "SELECT COUNT(*) FROM admissions  JOIN DIAGNOSES_ICD d ON admissions.SUBJECT_ID = d.SUBJECT_ID WHERE d.ICD_CODE IS NOT NULL", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 10, "question": "Count admissions with any procedure code", "expected_sql": "SELECT COUNT(DISTINCT a.HADM_ID) AS cnt FROM ADMISSIONS a JOIN PROCEDURES_ICD p ON a.SUBJECT_ID = p.SUBJECT_ID AND a.HADM_ID = p.HADM_ID WHERE p.ICD_CODE IS NOT NULL", "generated_sql": "SELECT COUNT(*) AS admission_count FROM admissions  JOIN PROCEDURES_ICD d ON admissions.SUBJECT_ID = d.SUBJECT_ID WHERE d.ICD_CODE IS NOT NULL", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 11, "question": "Count admissions by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS admission_count FROM admissions  JOIN PATIENTS p ON admissions.SUBJECT_ID = p.SUBJECT_ID WHERE 1=1 GROUP BY p.GENDER", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 12, "question": "Average anchor age by admission type", "expected_sql": "SELECT a.ADMISSION_TYPE, AVG(p.ANCHOR_AGE) AS avg_age FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE a.ADMISSION_TYPE IS NOT NULL AND p.ANCHOR_AGE IS NOT NULL GROUP BY a.ADMISSION_TYPE", "generated_sql": "SELECT ADMISSION_TYPE, AVG(ANCHOR_AGE) AS average_age FROM PATIENTS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE", "expected_error": null, "generated_error": "ORA-00904: \"ADMISSION_TYPE\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 13, "question": "Count ICU stays by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM ICUSTAYS i JOIN PATIENTS p ON i.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT gender, COUNT(*) as icu_stays_count FROM patients WHERE icu_admission_date IS NOT NULL GROUP BY gender", "expected_error": null, "generated_error": "ORA-00904: \"ICU_ADMISSION_DATE\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 14, "question": "Count lab events by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM LABEVENTS l JOIN PATIENTS p ON l.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT gender, COUNT(*) AS lab_event_count FROM LABEVENTS INNER JOIN patients ON LABEVENTS.SUBJECT_ID = patients.id WHERE ROWNUM <= 100000 AND 1=1 GROUP BY gender", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00904: \"PATIENTS\".\"ID\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 15, "question": "Count chart events by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN PATIENTS p ON c.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS event_count FROM CHARTEVENTS  JOIN PATIENTS p ON CHARTEVENTS.SUBJECT_ID = p.SUBJECT_ID WHERE ROWNUM <= 100000 AND p.GENDER IS NOT NULL GROUP BY p.GENDER", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 16, "question": "Count prescriptions by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM PRESCRIPTIONS r JOIN PATIENTS p ON r.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS prescription_count FROM prescriptions  JOIN PATIENTS p ON prescriptions.SUBJECT_ID = p.SUBJECT_ID WHERE ROWNUM <= 100000 AND 1=1 GROUP BY p.GENDER", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 17, "question": "Count procedures by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN PATIENTS p ON pr.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS procedure_count FROM PROCEDURES_ICD  JOIN PATIENTS p ON PROCEDURES_ICD.SUBJECT_ID = p.SUBJECT_ID GROUP BY p.GENDER", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 18, "question": "Count diagnoses by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM DIAGNOSES_ICD dx JOIN PATIENTS p ON dx.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS diagnosis_count FROM DIAGNOSES_ICD  JOIN PATIENTS p ON DIAGNOSES_ICD.SUBJECT_ID = p.SUBJECT_ID GROUP BY p.GENDER", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 19, "question": "Count transfers by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM TRANSFERS t JOIN PATIENTS p ON t.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT customer.gender, COUNT(transfer.id) AS transfer_count FROM transfer JOIN account ON transfer.from_account_id = account.id JOIN customer ON account.customer_id = customer.id WHERE 1=1 GROUP BY customer.gender", "expected_error": null, "generated_error": "ORA-00942: table or view does not exist\nHelp: https://docs.oracle.com/error-help/db/ora-00942/", "status": "exec_error"}
{"idx": 20, "question": "Count services by gender", "expected_sql": "SELECT p.GENDER, COUNT(*) AS cnt FROM SERVICES s JOIN PATIENTS p ON s.SUBJECT_ID = p.SUBJECT_ID WHERE p.GENDER IS NOT NULL GROUP BY p.GENDER ORDER BY cnt DESC", "generated_sql": "SELECT p.GENDER, COUNT(*) AS service_count FROM services  JOIN PATIENTS p ON services.SUBJECT_ID = p.SUBJECT_ID GROUP BY p.GENDER", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
