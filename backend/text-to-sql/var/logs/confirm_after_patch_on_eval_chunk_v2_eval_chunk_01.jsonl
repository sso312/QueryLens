{"idx": 1, "question": "\uc785\uc6d0 \uc911 \ub178\ub974\uc5d0\ud53c\ub124\ud504\ub9b0 \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%norepinephrine%'", "generated_sql": "SELECT COUNT(DISTINCT HADM_ID) AS CNT FROM PRESCRIPTIONS WHERE DRUG LIKE '%norepinephrine%'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 2, "question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT STDDEV(COUNT(DISTINCT picd.ICD_CODE)) AS stddev_distinct_ecg_codes FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID JOIN PROCEDURES_ICD picd ON a.HADM_ID = picd.HADM_ID JOIN D_ICD_PROCEDURES dip ON picd.ICD_CODE = dip.ICD_CODE AND picd.ICD_VERSION = dip.ICD_VERSION WHERE p.GENDER = 'M' AND p.ANCHOR_AGE BETWEEN 81 AND 91 AND dip.LONG_TITLE LIKE '%ECG%' GROUP BY a.SUBJECT_ID", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 3, "question": "\uc785\uc6d0 \uc911\uc5d0 \ub0b4\uacfc\ub97c \uac70\uce5c \uc785\uc6d0\uc774 \ucd1d \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE s.curr_service = 'MED'", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS CNT FROM ADMISSIONS A JOIN ICUSTAYS I ON A.SUBJECT_ID = I.SUBJECT_ID AND A.HADM_ID = I.HADM_ID WHERE I.FIRST_CAREUNIT = 'Medicine' OR I.LAST_CAREUNIT = 'Medicine'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 4, "question": "\ud478\ub85c\uc138\ubbf8\ub4dc \uc0ac\uc6a9\ub7c9 \uc0ac\ubd84\uc704\uc218(Q1-Q4)\ubcc4 \ubcd1\uc6d0 \uc0ac\ub9dd\ub960\uc744 \ube44\uad50\ud574\uc918.", "expected_sql": "WITH drug_rx AS ( SELECT p.hadm_id, SUM(NVL(p.doses_per_24_hrs, 0)) AS dose_amt FROM PRESCRIPTIONS p WHERE p.hadm_id IS NOT NULL AND LOWER(p.drug) LIKE '%furosemide%' GROUP BY p.hadm_id ), dose_q AS ( SELECT hadm_id, dose_amt, NTILE(4) OVER (ORDER BY dose_amt) AS qtile FROM drug_rx ), adm AS ( SELECT hadm_id, hospital_expire_flag FROM ADMISSIONS WHERE hadm_id IS NOT NULL ) SELECT 'Q' || q.qtile AS dose_quartile, COUNT(DISTINCT q.hadm_id) AS n_hadm, COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) AS n_death_hadm, ROUND(100 * COUNT(DISTINCT CASE WHEN a.hospital_expire_flag = 1 THEN q.hadm_id END) / NULLIF(COUNT(DISTINCT q.hadm_id), 0), 2) AS hospital_mortality_rate_pct FROM dose_q q JOIN adm a ON a.hadm_id = q.hadm_id GROUP BY q.qtile ORDER BY q.qtile", "generated_sql": "SELECT usage_quartile, SUM(CASE WHEN a.HOSPITAL_EXPIRE_FLAG = 1 THEN 1 ELSE 0 END) / COUNT(*) AS mortality_rate FROM (SELECT a.HADM_ID, NTILE(4) OVER (ORDER BY SUM(CAST(e.amount AS NUMBER)) DESC) AS usage_quartile FROM admissions a JOIN ingredientevents e ON a.HADM_ID = e.HADM_ID WHERE TO_CHAR(e.itemid) IN (SELECT TO_CHAR(itemid) FROM D_ITEMS WHERE LOWER(label) = 'furosemide') GROUP BY a.HADM_ID) usage JOIN admissions a ON usage.HADM_ID = a.HADM_ID GROUP BY usage_quartile ORDER BY usage_quartile", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 4, "generated_row_count": 0}}
{"idx": 5, "question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT STDDEV(CABG_COUNT) AS CABG_STDDEV FROM (SELECT COUNT(DISTINCT pi.ICD_CODE) AS CNT FROM PATIENTS p JOIN ADMISSIONS a ON p.SUBJECT_ID = a.SUBJECT_ID JOIN PROCEDURES_ICD pi ON a.HADM_ID = pi.HADM_ID WHERE p.GENDER = 'F' AND p.ANCHOR_AGE BETWEEN 41 AND 51 AND ((pi.ICD_CODE LIKE '021%' AND pi.ICD_VERSION = 10) OR (pi.ICD_CODE LIKE '3610%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3611%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3612%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3613%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3614%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3615%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3616%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3617%' AND pi.ICD_VERSION = 9) OR (pi.ICD_CODE LIKE '3619%' AND pi.ICD_VERSION = 9)) GROUP BY p.SUBJECT_ID)", "expected_error": null, "generated_error": "ORA-00904: \"CABG_COUNT\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
