{"idx": 1, "question": "\uc131\uc778 \ud658\uc790\ub9cc \ub300\uc0c1\uc73c\ub85c \ud574\uc11c, \ud658\uc790\ub9c8\ub2e4 \uccab \ubc88\uc9f8 \uc785\uc6d0 \uae30\ub85d\ub9cc \ub0a8\uaca8\uc11c \ucf54\ud638\ud2b8\ub97c \ub9cc\ub4e4\uc5b4\uc918.", "expected_sql": "WITH first_admit AS ( SELECT subject_id, MIN(admittime) AS first_admittime FROM ADMISSIONS GROUP BY subject_id ) SELECT a.subject_id, a.hadm_id, a.admittime, a.dischtime, p.anchor_age FROM ADMISSIONS a JOIN first_admit f ON f.subject_id = a.subject_id AND f.first_admittime = a.admittime JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE p.anchor_age >= 18", "generated_sql": "SELECT a.SUBJECT_ID, a.HADM_ID, a.ADMITTIME, a.DISCHTIME, a.ADMISSION_TYPE, a.ADMISSION_LOCATION, a.INSURANCE, a.LANGUAGE, a.MARITAL_STATUS, a.RACE FROM ADMISSIONS a JOIN PATIENTS p ON a.SUBJECT_ID = p.SUBJECT_ID WHERE p.ANCHOR_AGE >= 18 AND a.ADMITTIME = (SELECT MIN(adm.ADMITTIME) FROM ADMISSIONS adm WHERE adm.SUBJECT_ID = a.SUBJECT_ID)", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 5000, "generated_row_count": 5000}}
{"idx": 2, "question": "Top 10 stays by total input amount", "expected_sql": "SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT A.HADM_ID, SUM(I.AMOUNT) AS TOTAL_INPUT_AMOUNT FROM ADMISSIONS A JOIN INPUTEVENTS I ON A.HADM_ID = I.HADM_ID GROUP BY A.HADM_ID ORDER BY TOTAL_INPUT_AMOUNT DESC) WHERE ROWNUM <= 10", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 10, "generated_row_count": 10}}
{"idx": 3, "question": "\uc785\uc6d0 \uc911 \ud478\ub85c\uc138\ubbf8\ub4dc \ucc98\ubc29\uc774 \uc788\uc5c8\ub358 \uc785\uc6d0\uc774 \uba87 \uac74\uc778\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT COUNT(DISTINCT p.hadm_id) AS hadm_cnt FROM PRESCRIPTIONS p JOIN ADMISSIONS a ON a.hadm_id = p.hadm_id WHERE LOWER(p.drug) LIKE '%furosemide%'", "generated_sql": "SELECT COUNT(DISTINCT A.HADM_ID) AS CNT FROM ADMISSIONS A JOIN PRESCRIPTIONS P ON A.HADM_ID = P.HADM_ID WHERE P.DRUG LIKE 'furosemide%'", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 4, "question": "\ud608\uc561\ud22c\uc11d catheter \uc0bd\uc785 \uac74\uc218\ub97c \uc5f0\ub3c4\ubcc4\ub85c \ubcf4\uc5ec\uc918.", "expected_sql": "WITH hd_cath_events AS ( SELECT p.SUBJECT_ID, p.HADM_ID, p.STAY_ID, p.STARTTIME, p.ITEMID, di.LABEL FROM PROCEDUREEVENTS p JOIN D_ITEMS di ON p.ITEMID = di.ITEMID WHERE p.STARTTIME IS NOT NULL AND (((UPPER(di.LABEL) LIKE '%DIALYSIS%' AND UPPER(di.LABEL) LIKE '%CATH%') OR (UPPER(di.LABEL) LIKE '%HD%' AND UPPER(di.LABEL) LIKE '%CATH%') OR UPPER(di.LABEL) LIKE '%HEMODIALYSIS%') AND (UPPER(di.LABEL) LIKE '%INSERT%' OR UPPER(di.LABEL) LIKE '%PLAC%' OR UPPER(di.LABEL) LIKE '%INTRODUC%' OR UPPER(di.LABEL) LIKE '%NEW%' OR UPPER(di.LABEL) LIKE '%START%' OR UPPER(di.LABEL) LIKE '%CATHETER%') AND UPPER(di.LABEL) NOT LIKE '%PERITONEAL%' AND UPPER(di.LABEL) NOT LIKE '%AV FISTULA%' AND UPPER(di.LABEL) NOT LIKE '%GRAFT%') ), hd_cath_dedup AS ( SELECT DISTINCT SUBJECT_ID, HADM_ID, STAY_ID, ITEMID, STARTTIME FROM hd_cath_events ) SELECT EXTRACT(YEAR FROM a.ADMITTIME) AS ADMIT_YEAR, COUNT(*) AS N_HD_CATH_INSERT_EVENTS FROM hd_cath_dedup e JOIN ADMISSIONS a ON e.HADM_ID = a.HADM_ID GROUP BY EXTRACT(YEAR FROM a.ADMITTIME) ORDER BY ADMIT_YEAR", "generated_sql": "SELECT EXTRACT(YEAR FROM pe.STARTTIME) AS year, COUNT(*) AS CNT FROM PROCEDUREEVENTS pe JOIN D_ITEMS di ON pe.ITEMID = di.ITEMID WHERE di.CATEGORY = 'Dialysis' AND UPPER(di.LABEL) LIKE '%CATHETER%' GROUP BY EXTRACT(YEAR FROM pe.STARTTIME) ORDER BY year", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 40, "generated_row_count": 0}}
{"idx": 5, "question": "\ub9cc\uc131 \uc2e0\ubd80\uc804(N18\ub85c \uc2dc\uc791) \uc9c4\ub2e8\uc774 \uc788\ub294 \uc785\uc6d0\uc774 \uc6d4\ubcc4\ub85c \uc5bc\ub9c8\ub098 \uc788\uc5c8\ub294\uc9c0 \uc54c\ub824\uc918.", "expected_sql": "SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(DISTINCT d.hadm_id) AS hadm_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id WHERE d.icd_code LIKE 'N18%' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY", "generated_sql": "SELECT TO_CHAR(ADMITTIME, 'YYYY-MM') AS admission_month, COUNT(DISTINCT HADM_ID) AS CNT FROM ADMISSIONS WHERE EXISTS (SELECT 1 FROM DIAGNOSES_ICD WHERE ADMISSIONS.HADM_ID = DIAGNOSES_ICD.HADM_ID AND DIAGNOSES_ICD.ICD_CODE LIKE 'N18%' AND DIAGNOSES_ICD.ICD_VERSION = 10) GROUP BY TO_CHAR(ADMITTIME, 'YYYY-MM') ORDER BY admission_month", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 120, "generated_row_count": 1242}}
