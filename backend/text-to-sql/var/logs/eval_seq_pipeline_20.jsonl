{"idx": 1, "question": "Count admissions with an ICU stay", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "generated_sql_initial": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 2, "question": "Average ICU LOS by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "generated_sql_initial": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "generated_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 3, "question": "Count ICU stays by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql_initial": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 4, "question": "Count ICU stays by last careunit", "expected_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "generated_sql_initial": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 5, "question": "Count chart events by warning flag", "expected_sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql_initial": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 6, "question": "Top 10 chart event labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 7, "question": "Count lab events by flag", "expected_sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql_initial": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 8, "question": "Count lab events by priority", "expected_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql_initial": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 9, "question": "Top 10 lab item labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 10, "question": "Top 10 microbiology tests by count", "expected_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 11, "question": "Top 10 organisms by count", "expected_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 12, "question": "Top 10 antibiotics by count", "expected_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 13, "question": "Count services by current service", "expected_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql_initial": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 14, "question": "Top 10 service transitions by count", "expected_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql_initial": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 15, "question": "Average anchor age by gender", "expected_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "generated_sql_initial": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "generated_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 16, "question": "Count patients by anchor year group", "expected_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "generated_sql_initial": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "generated_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 17, "question": "For my 89-year-old male: among men 84-94, what's the maximum number of distinct echocardiography procedures per patient during hospitalization?", "expected_sql": "SELECT MAX(procedure_count) as max_echo_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 84 AND 94 AND ( (pr.icd_version = 10 AND pr.icd_code LIKE 'B24%') OR (pr.icd_version = 9 AND pr.icd_code = '8872') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql_initial": "SELECT MAX(procedure_count) as max_echo_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 84 AND 94 AND ( (pr.icd_version = 10 AND pr.icd_code LIKE 'B24%') OR (pr.icd_version = 9 AND pr.icd_code = '8872') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT MAX(procedure_count) as max_echo_procedures FROM ( SELECT p.SUBJECT_ID, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.SUBJECT_ID = pr.SUBJECT_ID WHERE p.gender = 'M' AND p.anchor_age BETWEEN 84 AND 94 AND ( (pr.icd_version = 10 AND pr.icd_code LIKE 'B24%') OR (pr.icd_version = 9 AND pr.icd_code = '8872') ) GROUP BY p.SUBJECT_ID ) patient_procedures;", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 18, "question": "I have an 85-year-old male. Among men 80-90, what's the maximum distinct mechanical circulatory support procedures per hospitalized patient?", "expected_sql": "SELECT MAX(procedure_count) AS max_mechanical_circulatory_support_count FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 80 AND 90 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '37.6%') OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A02%' OR pr.icd_code LIKE '02HL%' )) ) GROUP BY p.subject_id ) AS patient_procedure_counts;", "generated_sql_initial": "SELECT MAX(procedure_count) AS max_mechanical_circulatory_support_count FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 80 AND 90 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '37.6%') OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A02%' OR pr.icd_code LIKE '02HL%' )) ) GROUP BY p.subject_id ) AS patient_procedure_counts;", "generated_sql": "SELECT MAX(procedure_count) AS max_mechanical_circulatory_support_count FROM ( SELECT p.SUBJECT_ID, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS AS p JOIN PROCEDURES_ICD AS pr ON p.SUBJECT_ID = pr.SUBJECT_ID WHERE p.gender = 'M' AND p.anchor_age BETWEEN 80 AND 90 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '37.6%') OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '5A02%' OR pr.icd_code LIKE '02HL%' )) ) GROUP BY p.SUBJECT_ID ) AS patient_procedure_counts;", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 19, "question": "I have an 86-year-old man. Among males 81-91, what's the SD of distinct ECG/telemetry procedure codes per patient during hospitalization?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql_initial": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) AS procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT ROUND(STDDEV(procedure_count), 2) AS stddev_ecg_telemetry_procedures FROM ( SELECT p.SUBJECT_ID, COUNT(DISTINCT pr.icd_code) AS CNT FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.SUBJECT_ID = pr.SUBJECT_ID WHERE p.gender = 'M' AND p.anchor_age BETWEEN 81 AND 91 AND pr.icd_code IS NOT NULL AND pr.icd_version IS NOT NULL AND ( (pr.icd_version = 9 AND ( pr.icd_code = '89.52' OR pr.icd_code = '89.54' )) OR (pr.icd_version = 10 AND ( pr.icd_code LIKE '4A02%' OR pr.icd_code LIKE '4A12%' )) ) GROUP BY p.SUBJECT_ID ) patient_procedures;", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
{"idx": 20, "question": "I have a 46-year-old female. Among females 41-51, what is the standard deviation of distinct CABG procedures per patient?", "expected_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql_initial": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.subject_id, COUNT(DISTINCT pr.icd_code) as procedure_count FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.subject_id = pr.subject_id WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.subject_id ) patient_procedures;", "generated_sql": "SELECT ROUND(STDDEV(procedure_count), 2) as stddev_cabg_procedures FROM ( SELECT p.SUBJECT_ID, COUNT(DISTINCT pr.icd_code) as CNT FROM PATIENTS p JOIN PROCEDURES_ICD pr ON p.SUBJECT_ID = pr.SUBJECT_ID WHERE p.gender = 'F' AND p.anchor_age BETWEEN 41 AND 51 AND ( (pr.icd_version = 9 AND pr.icd_code LIKE '36.1%') OR (pr.icd_version = 10 AND pr.icd_code LIKE '021%') ) GROUP BY p.SUBJECT_ID ) patient_procedures;", "expected_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "generated_error": "ORA-12560: Database communication protocol error.\nHelp: https://docs.oracle.com/error-help/db/ora-12560/", "execution_mode": "pipeline", "repair_attempts": 0, "status": "exec_error"}
