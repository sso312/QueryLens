{"idx": 1, "question": "Count patients by gender", "expected_sql": "SELECT GENDER, COUNT(*) AS cnt FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY cnt DESC", "generated_sql": "SELECT GENDER, COUNT(*) AS CNT FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 2, "generated_row_count": 2}}
{"idx": 2, "question": "Average anchor age by gender", "expected_sql": "SELECT GENDER, AVG(ANCHOR_AGE) AS avg_age FROM PATIENTS WHERE GENDER IS NOT NULL AND ANCHOR_AGE IS NOT NULL GROUP BY GENDER", "generated_sql": "SELECT GENDER, AVG(ANCHOR_YEAR - BIRTH_YEAR) AS AVERAGE_AGE FROM PATIENTS WHERE GENDER IS NOT NULL GROUP BY GENDER", "expected_error": null, "generated_error": "ORA-00904: \"BIRTH_YEAR\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 3, "question": "Count patients by anchor year group", "expected_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS cnt FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY cnt DESC", "generated_sql": "SELECT ANCHOR_YEAR_GROUP, COUNT(*) AS CNT FROM PATIENTS WHERE ANCHOR_YEAR_GROUP IS NOT NULL GROUP BY ANCHOR_YEAR_GROUP ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 5, "generated_row_count": 5}}
{"idx": 4, "question": "Count admissions by admission type", "expected_sql": "SELECT ADMISSION_TYPE, COUNT(*) AS cnt FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY cnt DESC", "generated_sql": "SELECT ADMISSION_TYPE, COUNT(*) AS CNT FROM ADMISSIONS WHERE ADMISSION_TYPE IS NOT NULL GROUP BY ADMISSION_TYPE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 9, "generated_row_count": 9}}
{"idx": 5, "question": "Count admissions by insurance", "expected_sql": "SELECT INSURANCE, COUNT(*) AS cnt FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY cnt DESC", "generated_sql": "SELECT INSURANCE, COUNT(*) AS CNT FROM ADMISSIONS WHERE INSURANCE IS NOT NULL GROUP BY INSURANCE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 5, "generated_row_count": 5}}
{"idx": 6, "question": "Count admissions by race", "expected_sql": "SELECT RACE, COUNT(*) AS cnt FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY cnt DESC", "generated_sql": "SELECT RACE, COUNT(HADM_ID) AS CNT FROM ADMISSIONS WHERE RACE IS NOT NULL GROUP BY RACE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 33, "generated_row_count": 33}}
{"idx": 7, "question": "Count admissions by marital status", "expected_sql": "SELECT MARITAL_STATUS, COUNT(*) AS cnt FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY cnt DESC", "generated_sql": "SELECT MARITAL_STATUS, COUNT(*) AS CNT FROM ADMISSIONS WHERE MARITAL_STATUS IS NOT NULL GROUP BY MARITAL_STATUS ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}}
{"idx": 8, "question": "Count admissions with hospital expire flag", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1", "generated_sql": "SELECT COUNT(*) AS CNT FROM ADMISSIONS WHERE HOSPITAL_EXPIRE_FLAG = 1", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 9, "question": "Count admissions with ED registration time", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL", "generated_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS WHERE EDREGTIME IS NOT NULL", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 10, "question": "Average admission length of stay in days", "expected_sql": "SELECT AVG(DISCHTIME - ADMITTIME) AS avg_los_days FROM ADMISSIONS WHERE DISCHTIME IS NOT NULL AND ADMITTIME IS NOT NULL", "generated_sql": "SELECT AVG(CAST(DISCHTIME AS DATE) - CAST(ADMITTIME AS DATE)) AS average_los_days FROM ADMISSIONS WHERE ADMITTIME IS NOT NULL AND DISCHTIME IS NOT NULL", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": null, "status": "exec_error"}
{"idx": 11, "question": "Count ICU stays by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT FIRST_CAREUNIT, COUNT(*) AS CNT FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 17, "generated_row_count": 17}}
{"idx": 12, "question": "Average ICU LOS by first careunit", "expected_sql": "SELECT FIRST_CAREUNIT, AVG(LOS) AS avg_los FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL AND LOS IS NOT NULL GROUP BY FIRST_CAREUNIT", "generated_sql": "SELECT AVG((CAST(a.DISCHTIME AS DATE) - CAST(a.ADMITTIME AS DATE))) AS average_icu_los, b.ADMISSION_LOCATION AS first_careunit FROM ICUSTAYS a JOIN EMAR b ON a.HADM_ID = b.HADM_ID WHERE ROWNUM <= 5000 AND b.ADMISSION_LOCATION IS NOT NULL AND a.ADMITTIME IS NOT NULL AND a.DISCHTIME IS NOT NULL GROUP BY b.ADMISSION_LOCATION", "expected_error": null, "generated_error": "ORA-00904: \"B\".\"ADMISSION_LOCATION\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 13, "question": "Count ICU stays by last careunit", "expected_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT LAST_CAREUNIT, COUNT(*) AS CNT FROM ICUSTAYS WHERE LAST_CAREUNIT IS NOT NULL GROUP BY LAST_CAREUNIT ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 17, "generated_row_count": 17}}
{"idx": 14, "question": "Count ICU stays with LOS >= 1 day", "expected_sql": "SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE LOS >= 1", "generated_sql": "SELECT COUNT(*) AS cnt FROM ICUSTAYS WHERE (CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) >= 1", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 15, "question": "Count transfers by careunit", "expected_sql": "SELECT CAREUNIT, COUNT(*) AS cnt FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY cnt DESC", "generated_sql": "SELECT CAREUNIT, COUNT(*) AS CNT FROM TRANSFERS WHERE CAREUNIT IS NOT NULL GROUP BY CAREUNIT ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 46, "generated_row_count": 46}}
{"idx": 16, "question": "Count transfers by event type", "expected_sql": "SELECT EVENTTYPE, COUNT(*) AS cnt FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY cnt DESC", "generated_sql": "SELECT EVENTTYPE, COUNT(*) AS CNT FROM TRANSFERS WHERE EVENTTYPE IS NOT NULL GROUP BY EVENTTYPE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "match", "compare": {"same_cols": true, "same_rows": true, "expected_row_count": 4, "generated_row_count": 4}}
{"idx": 17, "question": "Average transfer duration in days", "expected_sql": "SELECT AVG(OUTTIME - INTIME) AS avg_transfer_days FROM TRANSFERS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL", "generated_sql": "SELECT AVG(CAST(OUTTIME AS DATE) - CAST(INTIME AS DATE)) AS avg_transfer_duration_days FROM ICUSTAYS WHERE OUTTIME IS NOT NULL AND INTIME IS NOT NULL", "expected_error": "ORA-00932: inconsistent datatypes: expected NUMBER got INTERVAL DAY TO SECOND\nHelp: https://docs.oracle.com/error-help/db/ora-00932/", "generated_error": null, "status": "exec_error"}
{"idx": 18, "question": "Count services by current service", "expected_sql": "SELECT CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY cnt DESC", "generated_sql": "SELECT COUNT(*) AS CNT, CURR_SERVICE FROM SERVICES WHERE CURR_SERVICE IS NOT NULL GROUP BY CURR_SERVICE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 21, "generated_row_count": 21}}
{"idx": 19, "question": "Top 10 service transitions by count", "expected_sql": "SELECT * FROM (SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS cnt FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT PREV_SERVICE, CURR_SERVICE, COUNT(*) AS CNT FROM SERVICES WHERE PREV_SERVICE IS NOT NULL AND CURR_SERVICE IS NOT NULL AND 1=1 GROUP BY PREV_SERVICE, CURR_SERVICE ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 10, "generated_row_count": 231}}
{"idx": 20, "question": "Count admissions with an ICU stay", "expected_sql": "SELECT COUNT(*) AS cnt FROM ADMISSIONS a JOIN ICUSTAYS i ON a.SUBJECT_ID = i.SUBJECT_ID AND a.HADM_ID = i.HADM_ID WHERE a.HADM_ID IS NOT NULL", "generated_sql": "SELECT COUNT(DISTINCT HADM_ID) AS CNT FROM ICUSTAYS WHERE 1=1", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 1, "generated_row_count": 1}}
{"idx": 21, "question": "Count chart events by warning flag", "expected_sql": "SELECT WARNING, COUNT(*) AS cnt FROM CHARTEVENTS WHERE WARNING IS NOT NULL GROUP BY WARNING ORDER BY cnt DESC", "generated_sql": "SELECT WARNING, COUNT(*) AS CNT FROM CHARTEVENTS WHERE ROWNUM <= 5000 AND WARNING IS NOT NULL GROUP BY WARNING ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 22, "question": "Top 10 chart event ITEMID by count", "expected_sql": "SELECT * FROM (SELECT ITEMID, COUNT(*) AS cnt FROM CHARTEVENTS WHERE ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT ITEMID, COUNT(*) AS CNT FROM CHARTEVENTS WHERE ROWNUM <= 5000 AND ITEMID IS NOT NULL GROUP BY ITEMID ORDER BY CNT(*) CNT", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00936: missing expression\nHelp: https://docs.oracle.com/error-help/db/ora-00936/", "status": "exec_error"}
{"idx": 23, "question": "Top 10 chart event labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT di.LABEL, COUNT(*) AS CNT FROM LABEVENTS oe JOIN D_ITEMS di ON oe.d.LABEL = di.d.LABEL  JOIN D_LABITEMS d ON oe.d.LABEL = d.d.LABEL WHERE ROWNUM <= 5000 AND di.LABEL IS NOT NULL AND oe.d.LABEL IS NOT NULL GROUP BY di.LABEL ORDER BY CNT DESC FETCH NEXT 10 ROWS ONLY", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00904: \"DI\".\"D\".\"LABEL\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
{"idx": 24, "question": "Count lab events by flag", "expected_sql": "SELECT FLAG, COUNT(*) AS cnt FROM LABEVENTS WHERE FLAG IS NOT NULL GROUP BY FLAG ORDER BY cnt DESC", "generated_sql": "SELECT FLAG, COUNT(*) AS CNT FROM LABEVENTS WHERE ROWNUM <= 5000 AND FLAG IS NOT NULL GROUP BY FLAG ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 25, "question": "Top 10 lab item labels by count", "expected_sql": "SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT VALUE AS d.LABEL, COUNT(*) AS count FROM LABEVENTS  JOIN D_LABITEMS d ON LABEVENTS.ITEMID = d.ITEMID WHERE ROWNUM <= 5000 AND VALUE IS NOT NULL GROUP BY VALUE ORDER BY CNT DESC", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": "ORA-00923: FROM keyword not found where expected\nHelp: https://docs.oracle.com/error-help/db/ora-00923/", "status": "exec_error"}
{"idx": 26, "question": "Count lab events by priority", "expected_sql": "SELECT PRIORITY, COUNT(*) AS cnt FROM LABEVENTS WHERE PRIORITY IS NOT NULL GROUP BY PRIORITY ORDER BY cnt DESC", "generated_sql": "SELECT PRIORITY, COUNT(*) AS CNT FROM LABEVENTS WHERE ROWNUM <= 5000 AND PRIORITY IS NOT NULL AND 1=1 GROUP BY PRIORITY ORDER BY CNT DESC", "expected_error": "'utf-8' codec can't decode byte 0xa7 in position 146: invalid start byte", "generated_error": null, "status": "exec_error"}
{"idx": 27, "question": "Average lab numeric value by ITEMID", "expected_sql": "SELECT ITEMID, AVG(VALUENUM) AS avg_value FROM LABEVENTS WHERE ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID", "generated_sql": "SELECT ITEMID, AVG(VALUENUM) AS average_value FROM LABEVENTS WHERE ROWNUM <= 5000 AND ITEMID IS NOT NULL AND VALUENUM IS NOT NULL GROUP BY ITEMID", "expected_error": "DPY-4024: call timeout of 15000 ms exceeded\nDPI-1067: call timeout of 15000 ms exceeded with ORA-03156\nORA-03156: OCI call timed out\nHelp: https://docs.oracle.com/error-help/db/ora-03156/", "generated_error": null, "status": "exec_error"}
{"idx": 28, "question": "Top 10 microbiology tests by count", "expected_sql": "SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT MICRO_SPECIMEN_ID, COUNT(*) AS CNT FROM MICROBIOLOGYEVENTS WHERE ROWNUM <= 5000 AND MICRO_SPECIMEN_ID IS NOT NULL GROUP BY MICRO_SPECIMEN_ID ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": false, "same_rows": false, "expected_row_count": 10, "generated_row_count": 2295}}
{"idx": 29, "question": "Top 10 organisms by count", "expected_sql": "SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT ORG_NAME, COUNT(*) AS CNT FROM MICROBIOLOGYEVENTS WHERE ROWNUM <= 5000 AND ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY CNT DESC", "expected_error": null, "generated_error": null, "status": "mismatch", "compare": {"same_cols": true, "same_rows": false, "expected_row_count": 10, "generated_row_count": 101}}
{"idx": 30, "question": "Top 10 antibiotics by count", "expected_sql": "SELECT * FROM (SELECT AB_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10", "generated_sql": "SELECT AB_NAME, COUNT(*) AS count FROM MICROBIOLOGYEVENTS WHERE ROWNUM <= 5000 AND AB_NAME IS NOT NULL GROUP BY AB_NAME ORDER BY CNT DESC", "expected_error": null, "generated_error": "ORA-00904: \"CNT\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/", "status": "exec_error"}
