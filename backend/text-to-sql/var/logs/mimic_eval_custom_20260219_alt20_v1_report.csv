idx,question,status,expected_sql,generated_sql,expected_error,generated_error,same_cols,same_rows,expected_row_count,generated_row_count
1,입원 환자 중에 결혼 상태(marital_status)별로 입원 건수가 얼마나 되는지 많은 순으로 알려줘.,match,"SELECT a.marital_status, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.marital_status ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY","SELECT a.marital_status, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.marital_status ORDER BY CNT DESC",,,True,True,5,5
2,보험 종류별로 입원 환자 수가 어떻게 되는지 알려줘. 많은 순으로 20개만 보여줘.,match,"SELECT a.insurance, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.insurance ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY","SELECT a.insurance, COUNT(*) AS CNT FROM ADMISSIONS a GROUP BY a.insurance ORDER BY CNT DESC",,,True,True,6,6
3,Top 10 stays by total input amount,match,"SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC ) WHERE ROWNUM <= 10","SELECT * FROM (SELECT * FROM ( SELECT STAY_ID, SUM(AMOUNT) AS total_amount FROM INPUTEVENTS WHERE AMOUNT IS NOT NULL GROUP BY STAY_ID ORDER BY total_amount DESC )) WHERE ROWNUM <= 10",,,True,True,10,10
4,시술 상위 10개를 보여줘,match,"SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC ) WHERE ROWNUM <= 10","SELECT * FROM (SELECT * FROM ( SELECT d.LONG_TITLE, COUNT(*) AS cnt FROM PROCEDURES_ICD pr JOIN D_ICD_PROCEDURES d ON pr.ICD_CODE = d.ICD_CODE AND pr.ICD_VERSION = d.ICD_VERSION WHERE d.LONG_TITLE IS NOT NULL GROUP BY d.LONG_TITLE ORDER BY cnt DESC )) WHERE ROWNUM <= 10",,,True,True,10,10
5,처방(PRESCRIPTIONS) 샘플 100건을 보여줘,mismatch,"SELECT SUBJECT_ID, HADM_ID FROM PRESCRIPTIONS WHERE SUBJECT_ID IS NOT NULL AND ROWNUM <= 100","SELECT SUBJECT_ID, HADM_ID, DRUG, STARTTIME, STOPTIME FROM PRESCRIPTIONS WHERE ROWNUM <= 100",,,False,False,100,100
6,Top 10 lab test labels by frequency,expected_exec_error,"SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE ROWNUM <= 10","SELECT * FROM (SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE d.LABEL IS NOT NULL) WHERE ROWNUM <= 10","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","ORA-00904: ""D"".""LABEL"": invalid identifier
Help: https://docs.oracle.com/error-help/db/ora-00904/",,,,
7,진단 코드가 어떤 체계(버전)로 기록됐는지(예: ICD-9/ICD-10) 비중을 알려줘.,mismatch,"SELECT d.icd_version, COUNT(*) AS dx_row_cnt FROM DIAGNOSES_ICD d JOIN ADMISSIONS a ON a.hadm_id = d.hadm_id GROUP BY d.icd_version ORDER BY dx_row_cnt DESC FETCH FIRST 10 ROWS ONLY","SELECT d.icd_version, COUNT(*) / (SELECT COUNT(*) FROM DIAGNOSES_ICD) AS proportion FROM DIAGNOSES_ICD d GROUP BY d.icd_version",,,False,False,2,2
8,Top 10 chart event labels by count,expected_exec_error,"SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
9,귐종(organism) 상위 10개를 보여줘,match,"SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT ORG_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE ORG_NAME IS NOT NULL GROUP BY ORG_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
10,긴급 입원한 환자 수가 월별로 어떻게 변했는지 알려줘.,mismatch,"SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE a.admission_type = 'URGENT' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY","SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS CNT FROM ADMISSIONS a WHERE a.admission_type = 'EMERGENCY' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month",,,False,False,120,0
11,입원 중 어떤 진료과가 가장 많이 진료했는지 상위 20개를 보여줘.,match,"SELECT s.curr_service, COUNT(DISTINCT s.hadm_id) AS hadm_cnt FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id GROUP BY s.curr_service ORDER BY hadm_cnt DESC FETCH FIRST 20 ROWS ONLY","SELECT * FROM (SELECT s.curr_service, COUNT(DISTINCT s.hadm_id) AS CNT FROM SERVICES s JOIN ADMISSIONS a ON a.hadm_id = s.hadm_id WHERE S.HADM_ID IS NOT NULL GROUP BY s.curr_service ORDER BY CNT DESC) WHERE ROWNUM <= 20",,,True,True,19,19
12,응급으로 입원한 환자 수가 월별로 어떻게 변했는지 알려줘.,match,"SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id WHERE a.admission_type = 'EMERGENCY' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month FETCH FIRST 120 ROWS ONLY","SELECT TRUNC(a.admittime, 'MM') AS admit_month, COUNT(*) AS CNT FROM ADMISSIONS a WHERE a.admission_type = 'EMERGENCY' GROUP BY TRUNC(a.admittime, 'MM') ORDER BY admit_month",,,True,True,0,0
13,ICU stays by first careunit,match,"SELECT * FROM ( SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC ) WHERE ROWNUM <= 10","SELECT FIRST_CAREUNIT, COUNT(*) AS cnt FROM ICUSTAYS WHERE FIRST_CAREUNIT IS NOT NULL GROUP BY FIRST_CAREUNIT ORDER BY cnt DESC",,,True,False,10,16
14,검사 항목 상위 10개를 보여줘,expected_exec_error,"SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT d.LABEL, COUNT(*) AS cnt FROM LABEVENTS l JOIN D_LABITEMS d ON l.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC) WHERE ROWNUM <= 10","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
15,Top 10 microbiology tests by count,match,"SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10","SELECT * FROM (SELECT TEST_NAME, COUNT(*) AS cnt FROM MICROBIOLOGYEVENTS WHERE TEST_NAME IS NOT NULL GROUP BY TEST_NAME ORDER BY cnt DESC) WHERE ROWNUM <= 10",,,True,True,10,10
16,"인종/민족별로 입원 환자 수를 세어서, 많은 순으로 30개만 보여줘.",mismatch,"SELECT a.race, COUNT(*) AS hadm_cnt FROM ADMISSIONS a JOIN PATIENTS p ON p.subject_id = a.subject_id GROUP BY a.race ORDER BY hadm_cnt DESC FETCH FIRST 30 ROWS ONLY","SELECT a.race, COUNT(DISTINCT a.hadm_id) AS CNT FROM ADMISSIONS a WHERE A.HADM_ID IS NOT NULL GROUP BY a.race ORDER BY CNT DESC",,,False,False,30,33
17,Top 10 output event items by total value,match,"SELECT * FROM ( SELECT d.LABEL, SUM(e.VALUE) AS total_value FROM OUTPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.VALUE IS NOT NULL GROUP BY d.LABEL ORDER BY total_value DESC ) WHERE ROWNUM <= 10","SELECT * FROM (SELECT * FROM ( SELECT d.LABEL, SUM(e.VALUE) AS total_value FROM OUTPUTEVENTS e JOIN D_ITEMS d ON e.ITEMID = d.ITEMID WHERE e.VALUE IS NOT NULL GROUP BY d.LABEL ORDER BY total_value DESC )) WHERE ROWNUM <= 10",,,True,True,10,10
18,POE 샘플 100건을 보여줘,match,"SELECT POE_ID, POE_SEQ FROM POE WHERE POE_ID IS NOT NULL AND ROWNUM <= 100","SELECT POE_ID, POE_SEQ FROM POE WHERE ROWNUM <= 100",,,True,True,100,100
19,Top 10 charted item labels by frequency,expected_exec_error,"SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC ) WHERE ROWNUM <= 10","SELECT * FROM (SELECT * FROM ( SELECT d.LABEL, COUNT(*) AS cnt FROM CHARTEVENTS c JOIN D_ITEMS d ON c.ITEMID = d.ITEMID WHERE d.LABEL IS NOT NULL GROUP BY d.LABEL ORDER BY cnt DESC )) WHERE ROWNUM <= 10","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
20,Average dose given by administration type,expected_exec_error,"SELECT * FROM ( SELECT ADMINISTRATION_TYPE, AVG(DOSE_GIVEN) AS avg_dose FROM EMAR_DETAIL WHERE DOSE_GIVEN IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY avg_dose DESC ) WHERE ROWNUM <= 10","SELECT ADMINISTRATION_TYPE, AVG(TO_NUMBER(DOSE_GIVEN)) AS avg_dose FROM EMAR_DETAIL WHERE ADMINISTRATION_TYPE IS NOT NULL AND DOSE_GIVEN IS NOT NULL GROUP BY ADMINISTRATION_TYPE ORDER BY avg_dose DESC","ORA-01722: invalid number
Help: https://docs.oracle.com/error-help/db/ora-01722/","DPY-4024: call timeout of 10000 ms exceeded
DPI-1067: call timeout of 10000 ms exceeded with ORA-03156
ORA-03156: OCI call timed out
Help: https://docs.oracle.com/error-help/db/ora-03156/",,,,
